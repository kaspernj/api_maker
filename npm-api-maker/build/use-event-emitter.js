import useEnvSense from "env-sense/build/use-env-sense.js";
import { useEffect, useLayoutEffect, useMemo } from "react";
/**
 * @param {object} events
 * @param {string} event
 * @param {function} onCalled
 * @return {void}
 */
export default function ApiMakerUseEventEmitter(events, event, onCalled) {
    const { isServer } = useEnvSense();
    const useWorkingEffect = isServer ? useEffect : useLayoutEffect;
    // useMemo to instantly connect
    useMemo(() => {
        if (events) {
            events.addListener(event, onCalled);
        }
    }, [events, event, onCalled]);
    // useLayoutEffect to disconnect when unmounted or changed
    useWorkingEffect(() => {
        if (events) {
            return () => {
                events.removeListener(event, onCalled);
            };
        }
    }, [events, event, onCalled]);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlLWV2ZW50LWVtaXR0ZXIuanMiLCJzb3VyY2VSb290IjoiL3NyYy8iLCJzb3VyY2VzIjpbInVzZS1ldmVudC1lbWl0dGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sV0FBVyxNQUFNLGtDQUFrQyxDQUFBO0FBQzFELE9BQU8sRUFBQyxTQUFTLEVBQUUsZUFBZSxFQUFFLE9BQU8sRUFBQyxNQUFNLE9BQU8sQ0FBQTtBQUV6RDs7Ozs7R0FLRztBQUNILE1BQU0sQ0FBQyxPQUFPLFVBQVUsdUJBQXVCLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxRQUFRO0lBQ3JFLE1BQU0sRUFBQyxRQUFRLEVBQUMsR0FBRyxXQUFXLEVBQUUsQ0FBQTtJQUNoQyxNQUFNLGdCQUFnQixHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUE7SUFFL0QsK0JBQStCO0lBQy9CLE9BQU8sQ0FBQyxHQUFHLEVBQUU7UUFDWCxJQUFJLE1BQU0sRUFBRSxDQUFDO1lBQ1gsTUFBTSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUE7UUFDckMsQ0FBQztJQUNILENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQTtJQUU3QiwwREFBMEQ7SUFDMUQsZ0JBQWdCLENBQUMsR0FBRyxFQUFFO1FBQ3BCLElBQUksTUFBTSxFQUFFLENBQUM7WUFDWCxPQUFPLEdBQUcsRUFBRTtnQkFDVixNQUFNLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQTtZQUN4QyxDQUFDLENBQUE7UUFDSCxDQUFDO0lBQ0gsQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFBO0FBQy9CLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdXNlRW52U2Vuc2UgZnJvbSBcImVudi1zZW5zZS9idWlsZC91c2UtZW52LXNlbnNlLmpzXCJcbmltcG9ydCB7dXNlRWZmZWN0LCB1c2VMYXlvdXRFZmZlY3QsIHVzZU1lbW99IGZyb20gXCJyZWFjdFwiXG5cbi8qKlxuICogQHBhcmFtIHtvYmplY3R9IGV2ZW50c1xuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBvbkNhbGxlZFxuICogQHJldHVybiB7dm9pZH1cbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQXBpTWFrZXJVc2VFdmVudEVtaXR0ZXIoZXZlbnRzLCBldmVudCwgb25DYWxsZWQpIHtcbiAgY29uc3Qge2lzU2VydmVyfSA9IHVzZUVudlNlbnNlKClcbiAgY29uc3QgdXNlV29ya2luZ0VmZmVjdCA9IGlzU2VydmVyID8gdXNlRWZmZWN0IDogdXNlTGF5b3V0RWZmZWN0XG5cbiAgLy8gdXNlTWVtbyB0byBpbnN0YW50bHkgY29ubmVjdFxuICB1c2VNZW1vKCgpID0+IHtcbiAgICBpZiAoZXZlbnRzKSB7XG4gICAgICBldmVudHMuYWRkTGlzdGVuZXIoZXZlbnQsIG9uQ2FsbGVkKVxuICAgIH1cbiAgfSwgW2V2ZW50cywgZXZlbnQsIG9uQ2FsbGVkXSlcblxuICAvLyB1c2VMYXlvdXRFZmZlY3QgdG8gZGlzY29ubmVjdCB3aGVuIHVubW91bnRlZCBvciBjaGFuZ2VkXG4gIHVzZVdvcmtpbmdFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChldmVudHMpIHtcbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGV2ZW50cy5yZW1vdmVMaXN0ZW5lcihldmVudCwgb25DYWxsZWQpXG4gICAgICB9XG4gICAgfVxuICB9LCBbZXZlbnRzLCBldmVudCwgb25DYWxsZWRdKVxufVxuIl19