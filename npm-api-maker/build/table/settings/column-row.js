import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import React, { useEffect, useRef } from "react";
import BaseComponent from "../../base-component";
import columnIdentifier from "../column-identifier.js";
import memo from "set-state-compare/build/memo.js";
import PropTypes from "prop-types";
import propTypesExact from "prop-types-exact";
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import Text from "../../utils/text";
import { View } from "react-native";
export default memo(shapeComponent(class ColumnRow extends BaseComponent {
    static propTypes = propTypesExact({
        column: PropTypes.object.isRequired,
        table: PropTypes.object.isRequired,
        tableSettingColumn: PropTypes.object.isRequired
    });
    setup() {
        this.checked = this.p.tableSettingColumn.visible();
        this.checkboxRef = useRef();
        useEffect(() => {
            this.updateCheckboxChecked();
        }, [this.checked]);
    }
    render() {
        const { column, table, tableSettingColumn } = this.p;
        const checkboxProps = {};
        if (tableSettingColumn.visible() === true) {
            checkboxProps.checked = "checked";
        }
        else if (tableSettingColumn.visible() === null) {
            checkboxProps.indeterminate = "indeterminate";
        }
        return (_jsx(View, { dataSet: this.cache("rootViewDataSet", { component: "api-maker--table--settings--column-row" }), style: this.cache("rootViewStyle", { justifyContent: "center" }), children: _jsxs("label", { style: { whiteSpace: "nowrap" }, children: [_jsx("input", { className: "api-maker--table--setings--column-checkbox", "data-identifier": columnIdentifier(column), onChange: this.onCheckboxChange, ref: this.checkboxRef, type: "checkbox", ...checkboxProps }), _jsx(Text, { children: table.headerLabelForColumn(column) })] }) }));
    }
    onCheckboxChange = () => {
        const { checked } = this;
        if (checked === true) {
            this.checked = null;
        }
        else if (checked === null) {
            this.checked = false;
        }
        else {
            this.checked = true;
        }
        this.updateCheckboxChecked();
        this.updateTableSettingColumn();
    };
    updateCheckboxChecked() {
        const { checked } = this.tt;
        if (checked === true) {
            this.checkboxRef.current.checked = true;
            this.checkboxRef.current.indeterminate = undefined;
        }
        else if (checked === null) {
            this.checkboxRef.current.checked = undefined;
            this.checkboxRef.current.indeterminate = true;
        }
        else {
            this.checkboxRef.current.checked = undefined;
            this.checkboxRef.current.indeterminate = undefined;
        }
    }
    async updateTableSettingColumn() {
        const { table, tableSettingColumn } = this.p;
        await tableSettingColumn.update({ visible: this.checked });
        table.events.emit("columnVisibilityUpdated", { tableSettingColumn });
    }
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29sdW1uLXJvdy5qcyIsInNvdXJjZVJvb3QiOiIvc3JjLyIsInNvdXJjZXMiOlsidGFibGUvc2V0dGluZ3MvY29sdW1uLXJvdy5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sS0FBSyxFQUFFLEVBQUMsU0FBUyxFQUFFLE1BQU0sRUFBQyxNQUFNLE9BQU8sQ0FBQTtBQUM5QyxPQUFPLGFBQWEsTUFBTSxzQkFBc0IsQ0FBQTtBQUNoRCxPQUFPLGdCQUFnQixNQUFNLHlCQUF5QixDQUFBO0FBQ3RELE9BQU8sSUFBSSxNQUFNLGlDQUFpQyxDQUFBO0FBQ2xELE9BQU8sU0FBUyxNQUFNLFlBQVksQ0FBQTtBQUNsQyxPQUFPLGNBQWMsTUFBTSxrQkFBa0IsQ0FBQTtBQUM3QyxPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0sNENBQTRDLENBQUE7QUFDekUsT0FBTyxJQUFJLE1BQU0sa0JBQWtCLENBQUE7QUFDbkMsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLGNBQWMsQ0FBQTtBQUVqQyxlQUFlLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxTQUFVLFNBQVEsYUFBYTtJQUN0RSxNQUFNLENBQUMsU0FBUyxHQUFHLGNBQWMsQ0FBQztRQUNoQyxNQUFNLEVBQUUsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVO1FBQ25DLEtBQUssRUFBRSxTQUFTLENBQUMsTUFBTSxDQUFDLFVBQVU7UUFDbEMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVO0tBQ2hELENBQUMsQ0FBQTtJQUVGLEtBQUs7UUFDSCxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsa0JBQWtCLENBQUMsT0FBTyxFQUFFLENBQUE7UUFDbEQsSUFBSSxDQUFDLFdBQVcsR0FBRyxNQUFNLEVBQUUsQ0FBQTtRQUUzQixTQUFTLENBQUMsR0FBRyxFQUFFO1lBQ2IsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUE7UUFDOUIsQ0FBQyxFQUFFLENBQUMsSUFB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UUFFMUMsTUFBTSxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsRUFBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBQyxDQUFDLENBQUE7UUFFeEQsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMseUJBQXlCLEVBQUUsRUFBQyxrQkFBa0IsRUFBQyxDQUFDLENBQUE7SUFDcEUsQ0FBQztDQUNGLENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7dXNlRWZmZWN0LCB1c2VSZWZ9IGZyb20gXCJyZWFjdFwiXG5pbXBvcnQgQmFzZUNvbXBvbmVudCBmcm9tIFwiLi4vLi4vYmFzZS1jb21wb25lbnRcIlxuaW1wb3J0IGNvbHVtbklkZW50aWZpZXIgZnJvbSBcIi4uL2NvbHVtbi1pZGVudGlmaWVyLmpzXCJcbmltcG9ydCBtZW1vIGZyb20gXCJzZXQtc3RhdGUtY29tcGFyZS9idWlsZC9tZW1vLmpzXCJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSBcInByb3AtdHlwZXNcIlxuaW1wb3J0IHByb3BUeXBlc0V4YWN0IGZyb20gXCJwcm9wLXR5cGVzLWV4YWN0XCJcbmltcG9ydCB7c2hhcGVDb21wb25lbnR9IGZyb20gXCJzZXQtc3RhdGUtY29tcGFyZS9idWlsZC9zaGFwZS1jb21wb25lbnQuanNcIlxuaW1wb3J0IFRleHQgZnJvbSBcIi4uLy4uL3V0aWxzL3RleHRcIlxuaW1wb3J0IHtWaWV3fSBmcm9tIFwicmVhY3QtbmF0aXZlXCJcblxuZXhwb3J0IGRlZmF1bHQgbWVtbyhzaGFwZUNvbXBvbmVudChjbGFzcyBDb2x1bW5Sb3cgZXh0ZW5kcyBCYXNlQ29tcG9uZW50IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHByb3BUeXBlc0V4YWN0KHtcbiAgICBjb2x1bW46IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICB0YWJsZTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIHRhYmxlU2V0dGluZ0NvbHVtbjogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkXG4gIH0pXG5cbiAgc2V0dXAoKSB7XG4gICAgdGhpcy5jaGVja2VkID0gdGhpcy5wLnRhYmxlU2V0dGluZ0NvbHVtbi52aXNpYmxlKClcbiAgICB0aGlzLmNoZWNrYm94UmVmID0gdXNlUmVmKClcblxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICB0aGlzLnVwZGF0ZUNoZWNrYm94Q2hlY2tlZCgpXG4gICAgfSwgW3RoaXMuY2hlY2tlZF0pXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2NvbHVtbiwgdGFibGUsIHRhYmxlU2V0dGluZ0NvbHVtbn0gPSB0aGlzLnBcbiAgICBjb25zdCBjaGVja2JveFByb3BzID0ge31cblxuICAgIGlmICh0YWJsZVNldHRpbmdDb2x1bW4udmlzaWJsZSgpID09PSB0cnVlKSB7XG4gICAgICBjaGVja2JveFByb3BzLmNoZWNrZWQgPSBcImNoZWNrZWRcIlxuICAgIH0gZWxzZSBpZiAodGFibGVTZXR0aW5nQ29sdW1uLnZpc2libGUoKSA9PT0gbnVsbCkge1xuICAgICAgY2hlY2tib3hQcm9wcy5pbmRldGVybWluYXRlID0gXCJpbmRldGVybWluYXRlXCJcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFZpZXcgZGF0YVNldD17dGhpcy5jYWNoZShcInJvb3RWaWV3RGF0YVNldFwiLCB7Y29tcG9uZW50OiBcImFwaS1tYWtlci0tdGFibGUtLXNldHRpbmdzLS1jb2x1bW4tcm93XCJ9KX0gc3R5bGU9e3RoaXMuY2FjaGUoXCJyb290Vmlld1N0eWxlXCIsIHtqdXN0aWZ5Q29udGVudDogXCJjZW50ZXJcIn0pfT5cbiAgICAgICAgPGxhYmVsIHN0eWxlPXt7d2hpdGVTcGFjZTogXCJub3dyYXBcIn19PlxuICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiYXBpLW1ha2VyLS10YWJsZS0tc2V0aW5ncy0tY29sdW1uLWNoZWNrYm94XCJcbiAgICAgICAgICAgIGRhdGEtaWRlbnRpZmllcj17Y29sdW1uSWRlbnRpZmllcihjb2x1bW4pfVxuICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25DaGVja2JveENoYW5nZX1cbiAgICAgICAgICAgIHJlZj17dGhpcy5jaGVja2JveFJlZn1cbiAgICAgICAgICAgIHR5cGU9XCJjaGVja2JveFwiXG4gICAgICAgICAgICB7Li4uY2hlY2tib3hQcm9wc31cbiAgICAgICAgICAvPlxuICAgICAgICAgIDxUZXh0PlxuICAgICAgICAgICAge3RhYmxlLmhlYWRlckxhYmVsRm9yQ29sdW1uKGNvbHVtbil9XG4gICAgICAgICAgPC9UZXh0PlxuICAgICAgICA8L2xhYmVsPlxuICAgICAgPC9WaWV3PlxuICAgIClcbiAgfVxuXG4gIG9uQ2hlY2tib3hDaGFuZ2UgPSAoKSA9PiB7XG4gICAgY29uc3Qge2NoZWNrZWR9ID0gdGhpc1xuXG4gICAgaWYgKGNoZWNrZWQgPT09IHRydWUpIHtcbiAgICAgIHRoaXMuY2hlY2tlZCA9IG51bGxcbiAgICB9IGVsc2UgaWYgKGNoZWNrZWQgPT09IG51bGwpIHtcbiAgICAgIHRoaXMuY2hlY2tlZCA9IGZhbHNlXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2hlY2tlZCA9IHRydWVcbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZUNoZWNrYm94Q2hlY2tlZCgpXG4gICAgdGhpcy51cGRhdGVUYWJsZVNldHRpbmdDb2x1bW4oKVxuICB9XG5cbiAgdXBkYXRlQ2hlY2tib3hDaGVja2VkKCkge1xuICAgIGNvbnN0IHtjaGVja2VkfSA9IHRoaXMudHRcblxuICAgIGlmIChjaGVja2VkID09PSB0cnVlKSB7XG4gICAgICB0aGlzLmNoZWNrYm94UmVmLmN1cnJlbnQuY2hlY2tlZCA9IHRydWVcbiAgICAgIHRoaXMuY2hlY2tib3hSZWYuY3VycmVudC5pbmRldGVybWluYXRlID0gdW5kZWZpbmVkXG4gICAgfSBlbHNlIGlmIChjaGVja2VkID09PSBudWxsKSB7XG4gICAgICB0aGlzLmNoZWNrYm94UmVmLmN1cnJlbnQuY2hlY2tlZCA9IHVuZGVmaW5lZFxuICAgICAgdGhpcy5jaGVja2JveFJlZi5jdXJyZW50LmluZGV0ZXJtaW5hdGUgPSB0cnVlXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2hlY2tib3hSZWYuY3VycmVudC5jaGVja2VkID0gdW5kZWZpbmVkXG4gICAgICB0aGlzLmNoZWNrYm94UmVmLmN1cnJlbnQuaW5kZXRlcm1pbmF0ZSA9IHVuZGVmaW5lZFxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVRhYmxlU2V0dGluZ0NvbHVtbigpIHtcbiAgICBjb25zdCB7dGFibGUsIHRhYmxlU2V0dGluZ0NvbHVtbn0gPSB0aGlzLnBcblxuICAgIGF3YWl0IHRhYmxlU2V0dGluZ0NvbHVtbi51cGRhdGUoe3Zpc2libGU6IHRoaXMuY2hlY2tlZH0pXG5cbiAgICB0YWJsZS5ldmVudHMuZW1pdChcImNvbHVtblZpc2liaWxpdHlVcGRhdGVkXCIsIHt0YWJsZVNldHRpbmdDb2x1bW59KVxuICB9XG59KSlcbiJdfQ==