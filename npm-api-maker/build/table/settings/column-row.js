import React, { useEffect, useRef } from "react";
import BaseComponent from "../../base-component.js";
import columnIdentifier from "../column-identifier.js";
import memo from "set-state-compare/build/memo.js";
import PropTypes from "prop-types";
import propTypesExact from "prop-types-exact";
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import Text from "../../utils/text.js";
import { View } from "react-native";
export default memo(shapeComponent(class ColumnRow extends BaseComponent {
    static propTypes = propTypesExact({
        column: PropTypes.object.isRequired,
        table: PropTypes.object.isRequired,
        tableSettingColumn: PropTypes.object.isRequired
    });
    setup() {
        this.checked = this.p.tableSettingColumn.visible();
        this.checkboxRef = useRef();
        useEffect(() => {
            this.updateCheckboxChecked();
        }, [this.checked]);
    }
    render() {
        const { column, table, tableSettingColumn } = this.p;
        const checkboxProps = {};
        if (tableSettingColumn.visible() === true) {
            checkboxProps.checked = "checked";
        }
        else if (tableSettingColumn.visible() === null) {
            checkboxProps.indeterminate = "indeterminate";
        }
        return (<View dataSet={this.cache("rootViewDataSet", { component: "api-maker--table--settings--column-row" })} style={this.cache("rootViewStyle", { justifyContent: "center" })}>
        <label style={{ whiteSpace: "nowrap" }}>
          <input className="api-maker--table--setings--column-checkbox" data-identifier={columnIdentifier(column)} onChange={this.onCheckboxChange} ref={this.checkboxRef} type="checkbox" {...checkboxProps}/>
          <Text>
            {table.headerLabelForColumn(column)}
          </Text>
        </label>
      </View>);
    }
    onCheckboxChange = () => {
        const { checked } = this;
        if (checked === true) {
            this.checked = null;
        }
        else if (checked === null) {
            this.checked = false;
        }
        else {
            this.checked = true;
        }
        this.updateCheckboxChecked();
        this.updateTableSettingColumn();
    };
    updateCheckboxChecked() {
        const { checked } = this.tt;
        if (checked === true) {
            this.checkboxRef.current.checked = true;
            this.checkboxRef.current.indeterminate = undefined;
        }
        else if (checked === null) {
            this.checkboxRef.current.checked = undefined;
            this.checkboxRef.current.indeterminate = true;
        }
        else {
            this.checkboxRef.current.checked = undefined;
            this.checkboxRef.current.indeterminate = undefined;
        }
    }
    async updateTableSettingColumn() {
        const { table, tableSettingColumn } = this.p;
        await tableSettingColumn.update({ visible: this.checked });
        table.events.emit("columnVisibilityUpdated", { tableSettingColumn });
    }
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29sdW1uLXJvdy5qcyIsInNvdXJjZVJvb3QiOiIvc3JjLyIsInNvdXJjZXMiOlsidGFibGUvc2V0dGluZ3MvY29sdW1uLXJvdy5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEVBQUUsRUFBQyxTQUFTLEVBQUUsTUFBTSxFQUFDLE1BQU0sT0FBTyxDQUFBO0FBQzlDLE9BQU8sYUFBYSxNQUFNLHlCQUF5QixDQUFBO0FBQ25ELE9BQU8sZ0JBQWdCLE1BQU0seUJBQXlCLENBQUE7QUFDdEQsT0FBTyxJQUFJLE1BQU0saUNBQWlDLENBQUE7QUFDbEQsT0FBTyxTQUFTLE1BQU0sWUFBWSxDQUFBO0FBQ2xDLE9BQU8sY0FBYyxNQUFNLGtCQUFrQixDQUFBO0FBQzdDLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSw0Q0FBNEMsQ0FBQTtBQUN6RSxPQUFPLElBQUksTUFBTSxxQkFBcUIsQ0FBQTtBQUN0QyxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sY0FBYyxDQUFBO0FBRWpDLGVBQWUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLFNBQVUsU0FBUSxhQUFhO0lBQ3RFLE1BQU0sQ0FBQyxTQUFTLEdBQUcsY0FBYyxDQUFDO1FBQ2hDLE1BQU0sRUFBRSxTQUFTLENBQUMsTUFBTSxDQUFDLFVBQVU7UUFDbkMsS0FBSyxFQUFFLFNBQVMsQ0FBQyxNQUFNLENBQUMsVUFBVTtRQUNsQyxrQkFBa0IsRUFBRSxTQUFTLENBQUMsTUFBTSxDQUFDLFVBQVU7S0FDaEQsQ0FBQyxDQUFBO0lBRUYsS0FBSztRQUNILElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtRQUNsRCxJQUFJLENBQUMsV0FBVyxHQUFHLE1BQU0sRUFBRSxDQUFBO1FBRTNCLFNBQVMsQ0FBQyxHQUFHLEVBQUU7WUFDYixJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQTtRQUM5QixDQUFDLEVBQUUsQ0FBQyxJQUFJ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QUFBO1lBQzVDLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLGFBQWEsR0FBRyxTQUFTLENBQUE7UUFDcEQsQ0FBQztJQUNILENBQUM7SUFFRCxLQUFLLENBQUMsd0JBQXdCO1FBQzVCLE1BQU0sRUFBQyxLQUFLLEVBQUUsa0JBQWtCLEVBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFBO1FBRTFDLE1BQU0sa0JBQWtCLENBQUMsTUFBTSxDQUFDLEVBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPLEVBQUMsQ0FBQyxDQUFBO1FBRXhELEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLHlCQUF5QixFQUFFLEVBQUMsa0JBQWtCLEVBQUMsQ0FBQyxDQUFBO0lBQ3BFLENBQUM7Q0FDRixDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwge3VzZUVmZmVjdCwgdXNlUmVmfSBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IEJhc2VDb21wb25lbnQgZnJvbSBcIi4uLy4uL2Jhc2UtY29tcG9uZW50LmpzXCJcbmltcG9ydCBjb2x1bW5JZGVudGlmaWVyIGZyb20gXCIuLi9jb2x1bW4taWRlbnRpZmllci5qc1wiXG5pbXBvcnQgbWVtbyBmcm9tIFwic2V0LXN0YXRlLWNvbXBhcmUvYnVpbGQvbWVtby5qc1wiXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCJcbmltcG9ydCBwcm9wVHlwZXNFeGFjdCBmcm9tIFwicHJvcC10eXBlcy1leGFjdFwiXG5pbXBvcnQge3NoYXBlQ29tcG9uZW50fSBmcm9tIFwic2V0LXN0YXRlLWNvbXBhcmUvYnVpbGQvc2hhcGUtY29tcG9uZW50LmpzXCJcbmltcG9ydCBUZXh0IGZyb20gXCIuLi8uLi91dGlscy90ZXh0LmpzXCJcbmltcG9ydCB7Vmlld30gZnJvbSBcInJlYWN0LW5hdGl2ZVwiXG5cbmV4cG9ydCBkZWZhdWx0IG1lbW8oc2hhcGVDb21wb25lbnQoY2xhc3MgQ29sdW1uUm93IGV4dGVuZHMgQmFzZUNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSBwcm9wVHlwZXNFeGFjdCh7XG4gICAgY29sdW1uOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgdGFibGU6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICB0YWJsZVNldHRpbmdDb2x1bW46IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZFxuICB9KVxuXG4gIHNldHVwKCkge1xuICAgIHRoaXMuY2hlY2tlZCA9IHRoaXMucC50YWJsZVNldHRpbmdDb2x1bW4udmlzaWJsZSgpXG4gICAgdGhpcy5jaGVja2JveFJlZiA9IHVzZVJlZigpXG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgdGhpcy51cGRhdGVDaGVja2JveENoZWNrZWQoKVxuICAgIH0sIFt0aGlzLmNoZWNrZWRdKVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtjb2x1bW4sIHRhYmxlLCB0YWJsZVNldHRpbmdDb2x1bW59ID0gdGhpcy5wXG4gICAgY29uc3QgY2hlY2tib3hQcm9wcyA9IHt9XG5cbiAgICBpZiAodGFibGVTZXR0aW5nQ29sdW1uLnZpc2libGUoKSA9PT0gdHJ1ZSkge1xuICAgICAgY2hlY2tib3hQcm9wcy5jaGVja2VkID0gXCJjaGVja2VkXCJcbiAgICB9IGVsc2UgaWYgKHRhYmxlU2V0dGluZ0NvbHVtbi52aXNpYmxlKCkgPT09IG51bGwpIHtcbiAgICAgIGNoZWNrYm94UHJvcHMuaW5kZXRlcm1pbmF0ZSA9IFwiaW5kZXRlcm1pbmF0ZVwiXG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxWaWV3IGRhdGFTZXQ9e3RoaXMuY2FjaGUoXCJyb290Vmlld0RhdGFTZXRcIiwge2NvbXBvbmVudDogXCJhcGktbWFrZXItLXRhYmxlLS1zZXR0aW5ncy0tY29sdW1uLXJvd1wifSl9IHN0eWxlPXt0aGlzLmNhY2hlKFwicm9vdFZpZXdTdHlsZVwiLCB7anVzdGlmeUNvbnRlbnQ6IFwiY2VudGVyXCJ9KX0+XG4gICAgICAgIDxsYWJlbCBzdHlsZT17e3doaXRlU3BhY2U6IFwibm93cmFwXCJ9fT5cbiAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImFwaS1tYWtlci0tdGFibGUtLXNldGluZ3MtLWNvbHVtbi1jaGVja2JveFwiXG4gICAgICAgICAgICBkYXRhLWlkZW50aWZpZXI9e2NvbHVtbklkZW50aWZpZXIoY29sdW1uKX1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQ2hlY2tib3hDaGFuZ2V9XG4gICAgICAgICAgICByZWY9e3RoaXMuY2hlY2tib3hSZWZ9XG4gICAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxuICAgICAgICAgICAgey4uLmNoZWNrYm94UHJvcHN9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8VGV4dD5cbiAgICAgICAgICAgIHt0YWJsZS5oZWFkZXJMYWJlbEZvckNvbHVtbihjb2x1bW4pfVxuICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgPC9sYWJlbD5cbiAgICAgIDwvVmlldz5cbiAgICApXG4gIH1cblxuICBvbkNoZWNrYm94Q2hhbmdlID0gKCkgPT4ge1xuICAgIGNvbnN0IHtjaGVja2VkfSA9IHRoaXNcblxuICAgIGlmIChjaGVja2VkID09PSB0cnVlKSB7XG4gICAgICB0aGlzLmNoZWNrZWQgPSBudWxsXG4gICAgfSBlbHNlIGlmIChjaGVja2VkID09PSBudWxsKSB7XG4gICAgICB0aGlzLmNoZWNrZWQgPSBmYWxzZVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNoZWNrZWQgPSB0cnVlXG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVDaGVja2JveENoZWNrZWQoKVxuICAgIHRoaXMudXBkYXRlVGFibGVTZXR0aW5nQ29sdW1uKClcbiAgfVxuXG4gIHVwZGF0ZUNoZWNrYm94Q2hlY2tlZCgpIHtcbiAgICBjb25zdCB7Y2hlY2tlZH0gPSB0aGlzLnR0XG5cbiAgICBpZiAoY2hlY2tlZCA9PT0gdHJ1ZSkge1xuICAgICAgdGhpcy5jaGVja2JveFJlZi5jdXJyZW50LmNoZWNrZWQgPSB0cnVlXG4gICAgICB0aGlzLmNoZWNrYm94UmVmLmN1cnJlbnQuaW5kZXRlcm1pbmF0ZSA9IHVuZGVmaW5lZFxuICAgIH0gZWxzZSBpZiAoY2hlY2tlZCA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5jaGVja2JveFJlZi5jdXJyZW50LmNoZWNrZWQgPSB1bmRlZmluZWRcbiAgICAgIHRoaXMuY2hlY2tib3hSZWYuY3VycmVudC5pbmRldGVybWluYXRlID0gdHJ1ZVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNoZWNrYm94UmVmLmN1cnJlbnQuY2hlY2tlZCA9IHVuZGVmaW5lZFxuICAgICAgdGhpcy5jaGVja2JveFJlZi5jdXJyZW50LmluZGV0ZXJtaW5hdGUgPSB1bmRlZmluZWRcbiAgICB9XG4gIH1cblxuICBhc3luYyB1cGRhdGVUYWJsZVNldHRpbmdDb2x1bW4oKSB7XG4gICAgY29uc3Qge3RhYmxlLCB0YWJsZVNldHRpbmdDb2x1bW59ID0gdGhpcy5wXG5cbiAgICBhd2FpdCB0YWJsZVNldHRpbmdDb2x1bW4udXBkYXRlKHt2aXNpYmxlOiB0aGlzLmNoZWNrZWR9KVxuXG4gICAgdGFibGUuZXZlbnRzLmVtaXQoXCJjb2x1bW5WaXNpYmlsaXR5VXBkYXRlZFwiLCB7dGFibGVTZXR0aW5nQ29sdW1ufSlcbiAgfVxufSkpXG4iXX0=