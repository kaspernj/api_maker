import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { Pressable, View } from "react-native";
import BaseComponent from "../base-component";
import Collection from "../collection.js";
import HeaderColumnContent from "./header-column-content";
import memo from "set-state-compare/build/memo.js";
import Modal from "../utils/modal";
import PropTypes from "prop-types";
import propTypesExact from "prop-types-exact";
import React from "react";
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import Text from "../utils/text";
import useI18n from "i18n-on-steroids/src/use-i18n.mjs";
import useSorting from "./use-sorting.js";
export default memo(shapeComponent(class ApiMakerTableHeaderSelect extends BaseComponent {
    static propTypes = propTypesExact({
        preparedColumns: PropTypes.array.isRequired,
        query: PropTypes.instanceOf(Collection).isRequired,
        table: PropTypes.object
    });
    setup() {
        const { t } = useI18n({ namespace: "js.api_maker.table.header_select" });
        const { preparedColumns, query } = this.p;
        const { qParams, searchKey, sortAttribute, sortMode } = useSorting({ query });
        this.useStates({
            modalOpen: false
        });
        this.setInstance({ qParams, searchKey, sortAttribute, sortMode, t });
        this.sortedByPreparedColumn = preparedColumns.find((preparedColumn) => preparedColumn.tableSettingColumn.sortKey() == sortAttribute);
    }
    render() {
        const { sortedByPreparedColumn, sortMode, t } = this.tt;
        const { table } = this.p;
        const column = sortedByPreparedColumn?.column;
        const columnLabel = column && table.headerLabelForColumn(column);
        return (_jsxs(View, { dataSet: this.cache("rootViewDataSet", { component: "api-maker/table/header-select" }), children: [this.s.modalOpen &&
                    _jsx(Modal, { dataSet: this.cache("modalDataSet", { class: "table-header-select-modal" }), onRequestClose: this.tt.onModalRequestClose, transparent: true, children: this.p.preparedColumns.map(({ column, tableSettingColumn }) => _jsx(View, { style: this.cache("headerColumnContentViewStyle", { marginVertical: 5 }), children: _jsx(HeaderColumnContent, { column: column, table: table, tableSettingColumn: tableSettingColumn, sortLinkProps: this.cache("sortLinkProps", { usePressable: true }) }) }, tableSettingColumn.identifier())) }), _jsx(Pressable, { onPress: this.tt.onSortedByPress, children: _jsxs(Text, { children: [sortedByPreparedColumn && sortMode == "asc" &&
                                t(".sorted_by_column", { column: columnLabel, defaultValue: "Sorted by %{column}" }), sortedByPreparedColumn && sortMode == "desc" &&
                                t(".sorted_by_column_reversed", { column: columnLabel, defaultValue: "Sorted by %{column} reversed" }), !sortedByPreparedColumn &&
                                t(".not_sorted", { defaultValue: "Not sorted" })] }) })] }));
    }
    onModalRequestClose = () => this.setState({ modalOpen: false });
    onSortedByPress = () => this.setState({ modalOpen: true });
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLXNlbGVjdC5qcyIsInNvdXJjZVJvb3QiOiIvc3JjLyIsInNvdXJjZXMiOlsidGFibGUvaGVhZGVyLXNlbGVjdC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUUsSUFBSSxFQUFDLE1BQU0sY0FBYyxDQUFBO0FBQzVDLE9BQU8sYUFBYSxNQUFNLG1CQUFtQixDQUFBO0FBQzdDLE9BQU8sVUFBVSxNQUFNLGtCQUFrQixDQUFBO0FBQ3pDLE9BQU8sbUJBQW1CLE1BQU0seUJBQXlCLENBQUE7QUFDekQsT0FBTyxJQUFJLE1BQU0saUNBQWlDLENBQUE7QUFDbEQsT0FBTyxLQUFLLE1BQU0sZ0JBQWdCLENBQUE7QUFDbEMsT0FBTyxTQUFTLE1BQU0sWUFBWSxDQUFBO0FBQ2xDLE9BQU8sY0FBYyxNQUFNLGtCQUFrQixDQUFBO0FBQzdDLE9BQU8sS0FBSyxNQUFNLE9BQU8sQ0FBQTtBQUN6QixPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0sNENBQTRDLENBQUE7QUFDekUsT0FBTyxJQUFJLE1BQU0sZUFBZSxDQUFBO0FBQ2hDLE9BQU8sT0FBTyxNQUFNLG1DQUFtQyxDQUFBO0FBQ3ZELE9BQU8sVUFBVSxNQUFNLGtCQUFrQixDQUFBO0FBRXpDLGVBQWUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLHlCQUEwQixTQUFRLGFBQWE7SUFDdEYsTUFBTSxDQUFDLFNBQVMsR0FBRyxjQUFjLENBQUM7UUFDaEMsZUFBZSxFQUFFLFNBQVMsQ0FBQyxLQUFLLENBQUMsVUFBVTtRQUMzQyxLQUFLLEVBQUUsU0FBUyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxVQUFVO1FBQ2xELEtBQUssRUFBRSxTQUFTLENBQUMsTUFBTTtLQUN4QixDQUFDLENBQUE7SUFFRixLQUFLO1FBQ0gsTUFBTSxFQUFDLENBQUMsRUFBQyxHQUFHLE9BQU8sQ0FBQyxFQUFDLFNBQVMsRUFBRSxrQ0FBa0MsRUFBQyxDQUFDLENBQUE7UUFDcEUsTUFBTSxFQUFDLGVBQWUsRUFBRSxLQUFLLEVBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFBO1FBQ3ZDLE1BQU0sRUFBQyxPQUFPLEVBQUUsU0FBUyxFQUFFLGFBQWEsRUFBRSxRQUFRLEVBQUMsR0FBRyxVQUFVLENBQUMsRUFBQyxLQUFLLEVBQUMsQ0FBQyxDQUFBO1FBRXpFLElBQUksQ0FBQyxTQUFTLENBQUM7WUFDYixTQUFTLEVBQUUsS0FBSztTQUNqQixDQUFDLENBQUE7UUFDRixJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxhQUFhLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUE7UUFDbEUsSUFBSSxDQUFDLHNCQUFzQixHQUFHLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLEVBQUUsRUFBRSxDQUFDLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLEVBQUUsSUFBSSxhQUFhLENBQUMsQ0FBQTtJQUN0SSxDQUFDO0lBRUQsTUFBTTtRQUNKLE1BQU0sRUFBQyxzQkFBc0IsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQTtRQUNyRCxNQUFNLEVBQUMsS0FBSyxFQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQTtRQUN0QixNQUFNLE1BQU0sR0FBRyxzQkFBc0IsRUFBRSxNQUFNLENBQUE7UUFDN0MsTUFBTSxXQUFXLEdBQUcsTUFBTSxJQUFJLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsQ0FBQTtRQUVoRSxPQUFPLENBQ0wsTUFBQyxJQUFJLElBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsaUJBQWlCLEVBQUUsRUFBQyxTQUFTLEVBQUUsK0JBQStCLEVBQUMsQ0FBQyxhQUN2RixJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVM7b0JBQ2YsS0FBQyxLQUFLLElBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsY0FBYyxFQUFFLEVBQUMsS0FBSyxFQUFFLDJCQUEyQixFQUFDLENBQUMsRUFBRSxjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxtQkFBbUIsRUFBRSxXQUFXLGtCQUN2SSxJQUFJLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFDLE1BQU0sRUFBRSxrQkFBa0IsRUFBQyxFQUFFLEVBQUUsQ0FDM0QsS0FBQyxJQUFJLElBRUgsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsOEJBQThCLEVBQUUsRUFBQyxjQUFjLEVBQUUsQ0FBQyxFQUFDLENBQUMsWUFFdEUsS0FBQyxtQkFBbUIsSUFDbEIsTUFBTSxFQUFFLE1BQU0sRUFDZCxLQUFLLEVBQUUsS0FBSyxFQUNaLGtCQUFrQixFQUFFLGtCQUFrQixFQUN0QyxhQUFhLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLEVBQUUsRUFBQyxZQUFZLEVBQUUsSUFBSSxFQUFDLENBQUMsR0FDaEUsSUFSRyxrQkFBa0IsQ0FBQyxVQUFVLEVBQUUsQ0FTL0IsQ0FDUixHQUNLLEVBRVYsS0FBQyxTQUFTLElBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsZUFBZSxZQUN6QyxNQUFDLElBQUksZUFDRixzQkFBc0IsSUFBSSxRQUFRLElBQUksS0FBSztnQ0FDMUMsQ0FBQyxDQUFDLG1CQUFtQixFQUFFLEVBQUMsTUFBTSxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUscUJBQXFCLEVBQUMsQ0FBQyxFQUVuRixzQkFBc0IsSUFBSSxRQUFRLElBQUksTUFBTTtnQ0FDM0MsQ0FBQyxDQUFDLDRCQUE0QixFQUFFLEVBQUMsTUFBTSxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsOEJBQThCLEVBQUMsQ0FBQyxFQUVyRyxDQUFDLHNCQUFzQjtnQ0FDdEIsQ0FBQyxDQUFDLGFBQWEsRUFBRSxFQUFDLFlBQVksRUFBRSxZQUFZLEVBQUMsQ0FBQyxJQUUzQyxHQUNHLElBQ1AsQ0FDUixDQUFBO0lBQ0gsQ0FBQztJQUVELG1CQUFtQixHQUFHLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBQyxTQUFTLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQTtJQUM3RCxlQUFlLEdBQUcsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFBO0NBQ3pELENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtQcmVzc2FibGUsIFZpZXd9IGZyb20gXCJyZWFjdC1uYXRpdmVcIlxuaW1wb3J0IEJhc2VDb21wb25lbnQgZnJvbSBcIi4uL2Jhc2UtY29tcG9uZW50XCJcbmltcG9ydCBDb2xsZWN0aW9uIGZyb20gXCIuLi9jb2xsZWN0aW9uLmpzXCJcbmltcG9ydCBIZWFkZXJDb2x1bW5Db250ZW50IGZyb20gXCIuL2hlYWRlci1jb2x1bW4tY29udGVudFwiXG5pbXBvcnQgbWVtbyBmcm9tIFwic2V0LXN0YXRlLWNvbXBhcmUvYnVpbGQvbWVtby5qc1wiXG5pbXBvcnQgTW9kYWwgZnJvbSBcIi4uL3V0aWxzL21vZGFsXCJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSBcInByb3AtdHlwZXNcIlxuaW1wb3J0IHByb3BUeXBlc0V4YWN0IGZyb20gXCJwcm9wLXR5cGVzLWV4YWN0XCJcbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IHtzaGFwZUNvbXBvbmVudH0gZnJvbSBcInNldC1zdGF0ZS1jb21wYXJlL2J1aWxkL3NoYXBlLWNvbXBvbmVudC5qc1wiXG5pbXBvcnQgVGV4dCBmcm9tIFwiLi4vdXRpbHMvdGV4dFwiXG5pbXBvcnQgdXNlSTE4biBmcm9tIFwiaTE4bi1vbi1zdGVyb2lkcy9zcmMvdXNlLWkxOG4ubWpzXCJcbmltcG9ydCB1c2VTb3J0aW5nIGZyb20gXCIuL3VzZS1zb3J0aW5nLmpzXCJcblxuZXhwb3J0IGRlZmF1bHQgbWVtbyhzaGFwZUNvbXBvbmVudChjbGFzcyBBcGlNYWtlclRhYmxlSGVhZGVyU2VsZWN0IGV4dGVuZHMgQmFzZUNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSBwcm9wVHlwZXNFeGFjdCh7XG4gICAgcHJlcGFyZWRDb2x1bW5zOiBQcm9wVHlwZXMuYXJyYXkuaXNSZXF1aXJlZCxcbiAgICBxdWVyeTogUHJvcFR5cGVzLmluc3RhbmNlT2YoQ29sbGVjdGlvbikuaXNSZXF1aXJlZCxcbiAgICB0YWJsZTogUHJvcFR5cGVzLm9iamVjdFxuICB9KVxuXG4gIHNldHVwKCkge1xuICAgIGNvbnN0IHt0fSA9IHVzZUkxOG4oe25hbWVzcGFjZTogXCJqcy5hcGlfbWFrZXIudGFibGUuaGVhZGVyX3NlbGVjdFwifSlcbiAgICBjb25zdCB7cHJlcGFyZWRDb2x1bW5zLCBxdWVyeX0gPSB0aGlzLnBcbiAgICBjb25zdCB7cVBhcmFtcywgc2VhcmNoS2V5LCBzb3J0QXR0cmlidXRlLCBzb3J0TW9kZX0gPSB1c2VTb3J0aW5nKHtxdWVyeX0pXG5cbiAgICB0aGlzLnVzZVN0YXRlcyh7XG4gICAgICBtb2RhbE9wZW46IGZhbHNlXG4gICAgfSlcbiAgICB0aGlzLnNldEluc3RhbmNlKHtxUGFyYW1zLCBzZWFyY2hLZXksIHNvcnRBdHRyaWJ1dGUsIHNvcnRNb2RlLCB0fSlcbiAgICB0aGlzLnNvcnRlZEJ5UHJlcGFyZWRDb2x1bW4gPSBwcmVwYXJlZENvbHVtbnMuZmluZCgocHJlcGFyZWRDb2x1bW4pID0+IHByZXBhcmVkQ29sdW1uLnRhYmxlU2V0dGluZ0NvbHVtbi5zb3J0S2V5KCkgPT0gc29ydEF0dHJpYnV0ZSlcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7c29ydGVkQnlQcmVwYXJlZENvbHVtbiwgc29ydE1vZGUsIHR9ID0gdGhpcy50dFxuICAgIGNvbnN0IHt0YWJsZX0gPSB0aGlzLnBcbiAgICBjb25zdCBjb2x1bW4gPSBzb3J0ZWRCeVByZXBhcmVkQ29sdW1uPy5jb2x1bW5cbiAgICBjb25zdCBjb2x1bW5MYWJlbCA9IGNvbHVtbiAmJiB0YWJsZS5oZWFkZXJMYWJlbEZvckNvbHVtbihjb2x1bW4pXG5cbiAgICByZXR1cm4gKFxuICAgICAgPFZpZXcgZGF0YVNldD17dGhpcy5jYWNoZShcInJvb3RWaWV3RGF0YVNldFwiLCB7Y29tcG9uZW50OiBcImFwaS1tYWtlci90YWJsZS9oZWFkZXItc2VsZWN0XCJ9KX0+XG4gICAgICAgIHt0aGlzLnMubW9kYWxPcGVuICYmXG4gICAgICAgICAgPE1vZGFsIGRhdGFTZXQ9e3RoaXMuY2FjaGUoXCJtb2RhbERhdGFTZXRcIiwge2NsYXNzOiBcInRhYmxlLWhlYWRlci1zZWxlY3QtbW9kYWxcIn0pfSBvblJlcXVlc3RDbG9zZT17dGhpcy50dC5vbk1vZGFsUmVxdWVzdENsb3NlfSB0cmFuc3BhcmVudD5cbiAgICAgICAgICAgIHt0aGlzLnAucHJlcGFyZWRDb2x1bW5zLm1hcCgoe2NvbHVtbiwgdGFibGVTZXR0aW5nQ29sdW1ufSkgPT5cbiAgICAgICAgICAgICAgPFZpZXdcbiAgICAgICAgICAgICAgICBrZXk9e3RhYmxlU2V0dGluZ0NvbHVtbi5pZGVudGlmaWVyKCl9XG4gICAgICAgICAgICAgICAgc3R5bGU9e3RoaXMuY2FjaGUoXCJoZWFkZXJDb2x1bW5Db250ZW50Vmlld1N0eWxlXCIsIHttYXJnaW5WZXJ0aWNhbDogNX0pfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPEhlYWRlckNvbHVtbkNvbnRlbnRcbiAgICAgICAgICAgICAgICAgIGNvbHVtbj17Y29sdW1ufVxuICAgICAgICAgICAgICAgICAgdGFibGU9e3RhYmxlfVxuICAgICAgICAgICAgICAgICAgdGFibGVTZXR0aW5nQ29sdW1uPXt0YWJsZVNldHRpbmdDb2x1bW59XG4gICAgICAgICAgICAgICAgICBzb3J0TGlua1Byb3BzPXt0aGlzLmNhY2hlKFwic29ydExpbmtQcm9wc1wiLCB7dXNlUHJlc3NhYmxlOiB0cnVlfSl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9WaWV3PlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L01vZGFsPlxuICAgICAgICB9XG4gICAgICAgIDxQcmVzc2FibGUgb25QcmVzcz17dGhpcy50dC5vblNvcnRlZEJ5UHJlc3N9PlxuICAgICAgICAgIDxUZXh0PlxuICAgICAgICAgICAge3NvcnRlZEJ5UHJlcGFyZWRDb2x1bW4gJiYgc29ydE1vZGUgPT0gXCJhc2NcIiAmJlxuICAgICAgICAgICAgICB0KFwiLnNvcnRlZF9ieV9jb2x1bW5cIiwge2NvbHVtbjogY29sdW1uTGFiZWwsIGRlZmF1bHRWYWx1ZTogXCJTb3J0ZWQgYnkgJXtjb2x1bW59XCJ9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAge3NvcnRlZEJ5UHJlcGFyZWRDb2x1bW4gJiYgc29ydE1vZGUgPT0gXCJkZXNjXCIgJiZcbiAgICAgICAgICAgICAgdChcIi5zb3J0ZWRfYnlfY29sdW1uX3JldmVyc2VkXCIsIHtjb2x1bW46IGNvbHVtbkxhYmVsLCBkZWZhdWx0VmFsdWU6IFwiU29ydGVkIGJ5ICV7Y29sdW1ufSByZXZlcnNlZFwifSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHshc29ydGVkQnlQcmVwYXJlZENvbHVtbiAmJlxuICAgICAgICAgICAgICB0KFwiLm5vdF9zb3J0ZWRcIiwge2RlZmF1bHRWYWx1ZTogXCJOb3Qgc29ydGVkXCJ9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgPC9QcmVzc2FibGU+XG4gICAgICA8L1ZpZXc+XG4gICAgKVxuICB9XG5cbiAgb25Nb2RhbFJlcXVlc3RDbG9zZSA9ICgpID0+IHRoaXMuc2V0U3RhdGUoe21vZGFsT3BlbjogZmFsc2V9KVxuICBvblNvcnRlZEJ5UHJlc3MgPSAoKSA9PiB0aGlzLnNldFN0YXRlKHttb2RhbE9wZW46IHRydWV9KVxufSkpXG4iXX0=