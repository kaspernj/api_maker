import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from "react/jsx-runtime";
import React, { useMemo } from "react";
import { StyleSheet, View } from "react-native";
import BaseComponent from "../../base-component";
import CommandsPool from "../../commands-pool.js";
import config from "super-admin/config";
import Header from "./header/index";
import memo from "set-state-compare/build/memo.js";
import Menu from "./menu/index";
import PropTypes from "prop-types";
import PropTypesExact from "prop-types-exact";
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import Text from "../../utils/text";
import useBreakpoint from "../../use-breakpoint.js";
import useCurrentUser from "../../use-current-user.js";
import useI18n from "i18n-on-steroids/src/use-i18n.mjs";
const NoAccess = React.lazy(() => import("./no-access"));
const styles = StyleSheet.create({
    appLayoutContentContainer: {
        base: {
            minHeight: "100vh",
            backgroundColor: "#f7f7f7"
        },
        mdDown: {
            paddingTop: 130,
            paddingRight: 30,
            paddingBottom: 30
        },
        mdUp: {
            paddingTop: 130,
            paddingRight: 30,
            paddingBottom: 30,
            paddingLeft: 280
        },
        lgUp: {
            paddingTop: 130,
            paddingRight: 30,
            paddingBottom: 30,
            paddingLeft: 320
        }
    },
    mb15: {
        marginBottom: 15
    },
    rootView: {
        width: "100%",
        minHeight: "100vh",
        backgroundColor: "#fff",
        color: "#000"
    }
});
export default memo(shapeComponent(class ApiMakerSuperAdminLayout extends BaseComponent {
    static propTypes = PropTypesExact({
        actions: PropTypes.any,
        active: PropTypes.string,
        children: PropTypes.any,
        className: PropTypes.string,
        currentCustomer: PropTypes.object,
        currentCustomerId: PropTypes.string,
        currentUser: PropTypes.object,
        headTitle: PropTypes.string,
        headerTitle: PropTypes.string
    });
    setup() {
        const currentUser = useCurrentUser();
        const { locale, t } = useI18n({ namespace: "js.api_maker.super_admin.layout" });
        const { lgUp, mdUp, mdDown } = useBreakpoint();
        this.useStates({ menuTriggered: false });
        this.setInstance({ currentUser, lgUp, mdUp, mdDown, t });
        useMemo(() => {
            CommandsPool.current().globalRequestData.layout = "admin";
            CommandsPool.current().globalRequestData.locale = locale;
        }, [locale]);
    }
    render() {
        const { currentUser, lgUp, mdUp, mdDown, t } = this.tt;
        const { actions, active, children, className, currentCustomer, currentCustomerId, headTitle, headerTitle, menu, ...restProps } = this.props;
        const actualHeadTitle = headTitle || headerTitle;
        if (actualHeadTitle) {
            document.title = actualHeadTitle;
        }
        else {
            document.title = "Super Admin";
        }
        const noAccess = !currentUser;
        const appLayoutContentContainerStyles = [styles.appLayoutContentContainer.base];
        if (mdDown)
            appLayoutContentContainerStyles.push(styles.appLayoutContentContainer.mdDown);
        if (mdUp)
            appLayoutContentContainerStyles.push(styles.appLayoutContentContainer.mdUp);
        if (lgUp)
            appLayoutContentContainerStyles.push(styles.appLayoutContentContainer.lgUp);
        return (_jsxs(View, { dataSet: { component: "super-admin--layout", class: className, menuTriggered: this.s.menuTriggered }, style: styles.rootView, ...restProps, children: [_jsx(Menu, { active: active, noAccess: noAccess, onRequestMenuClose: this.tt.onRequestMenuClose, triggered: this.s.menuTriggered }), _jsx(Header, { actions: actions, onTriggerMenu: this.tt.onTriggerMenu, title: headerTitle }), _jsxs(View, { dataSet: { class: "app-layout-content-container" }, style: appLayoutContentContainerStyles, children: [noAccess &&
                            _jsxs(_Fragment, { children: [_jsx(NoAccess, {}), currentUser &&
                                        _jsx(_Fragment, { children: _jsx(Text, { style: styles.mb15, children: t(".try_signing_out_and_in_with_a_different_user", { defaultValue: "Try signing in with a different user." }) }) }), !currentUser &&
                                        _jsxs(_Fragment, { children: [_jsx(Text, { style: styles.mb15, children: t(".try_signing_in", { defaultValue: "Try signing in." }) }), config.signInContent()] })] }), !noAccess && children] })] }));
    }
    onRequestMenuClose = () => this.setState({ menuTriggered: false });
    onTriggerMenu = (e) => {
        e.preventDefault();
        this.setState({ menuTriggered: !this.s.menuTriggered });
    };
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiL3NyYy8iLCJzb3VyY2VzIjpbInN1cGVyLWFkbWluL2xheW91dC9pbmRleC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sS0FBSyxFQUFFLEVBQUMsT0FBTyxFQUFDLE1BQU0sT0FBTyxDQUFBO0FBQ3BDLE9BQU8sRUFBQyxVQUFVLEVBQUUsSUFBSSxFQUFDLE1BQU0sY0FBYyxDQUFBO0FBQzdDLE9BQU8sYUFBYSxNQUFNLHNCQUFzQixDQUFBO0FBQ2hELE9BQU8sWUFBWSxNQUFNLHdCQUF3QixDQUFBO0FBQ2pELE9BQU8sTUFBTSxNQUFNLG9CQUFvQixDQUFBO0FBQ3ZDLE9BQU8sTUFBTSxNQUFNLGdCQUFnQixDQUFBO0FBQ25DLE9BQU8sSUFBSSxNQUFNLGlDQUFpQyxDQUFBO0FBQ2xELE9BQU8sSUFBSSxNQUFNLGNBQWMsQ0FBQTtBQUMvQixPQUFPLFNBQVMsTUFBTSxZQUFZLENBQUE7QUFDbEMsT0FBTyxjQUFjLE1BQU0sa0JBQWtCLENBQUE7QUFDN0MsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLDRDQUE0QyxDQUFBO0FBQ3pFLE9BQU8sSUFBSSxNQUFNLGtCQUFrQixDQUFBO0FBQ25DLE9BQU8sYUFBYSxNQUFNLHlCQUF5QixDQUFBO0FBQ25ELE9BQU8sY0FBYyxNQUFNLDJCQUEyQixDQUFBO0FBQ3RELE9BQU8sT0FBTyxNQUFNLG1DQUFtQyxDQUFBO0FBRXZELE1BQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUE7QUFFeEQsTUFBTSxNQUFNLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQztJQUMvQix5QkFBeUIsRUFBRTtRQUN6QixJQUFJLEVBQUU7WUFDSixTQUFTLEVBQUUsT0FBTztZQUNsQixlQUFlLEVBQUUsU0FBUztTQUMzQjtRQUNELE1BQU0sRUFBRTtZQUNOLFVBQVUsRUFBRSxHQUFHO1lB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QyxJQUFJLFlBQ3JCLENBQUMsQ0FBQywrQ0FBK0MsRUFBRSxFQUFDLFlBQVksRUFBRSx1Q0FBdUMsRUFBQyxDQUFDLEdBQ3ZHLEdBQ04sRUFFSixDQUFDLFdBQVc7d0NBQ1gsOEJBQ0UsS0FBQyxJQUFJLElBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLFlBQ3JCLENBQUMsQ0FBQyxpQkFBaUIsRUFBRSxFQUFDLFlBQVksRUFBRSxpQkFBaUIsRUFBQyxDQUFDLEdBQ25ELEVBQ04sTUFBTSxDQUFDLGFBQWEsRUFBRSxJQUN0QixJQUVKLEVBRUosQ0FBQyxRQUFRLElBQUksUUFBUSxJQUNqQixJQUNGLENBQ1IsQ0FBQTtJQUNILENBQUM7SUFFRCxrQkFBa0IsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUMsYUFBYSxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUE7SUFDaEUsYUFBYSxHQUFHLENBQUMsQ0FBQyxFQUFFLEVBQUU7UUFDcEIsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFBO1FBQ2xCLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBQyxhQUFhLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLGFBQWEsRUFBQyxDQUFDLENBQUE7SUFDdkQsQ0FBQyxDQUFBO0NBQ0YsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHt1c2VNZW1vfSBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IHtTdHlsZVNoZWV0LCBWaWV3fSBmcm9tIFwicmVhY3QtbmF0aXZlXCJcbmltcG9ydCBCYXNlQ29tcG9uZW50IGZyb20gXCIuLi8uLi9iYXNlLWNvbXBvbmVudFwiXG5pbXBvcnQgQ29tbWFuZHNQb29sIGZyb20gXCIuLi8uLi9jb21tYW5kcy1wb29sLmpzXCJcbmltcG9ydCBjb25maWcgZnJvbSBcInN1cGVyLWFkbWluL2NvbmZpZ1wiXG5pbXBvcnQgSGVhZGVyIGZyb20gXCIuL2hlYWRlci9pbmRleFwiXG5pbXBvcnQgbWVtbyBmcm9tIFwic2V0LXN0YXRlLWNvbXBhcmUvYnVpbGQvbWVtby5qc1wiXG5pbXBvcnQgTWVudSBmcm9tIFwiLi9tZW51L2luZGV4XCJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSBcInByb3AtdHlwZXNcIlxuaW1wb3J0IFByb3BUeXBlc0V4YWN0IGZyb20gXCJwcm9wLXR5cGVzLWV4YWN0XCJcbmltcG9ydCB7c2hhcGVDb21wb25lbnR9IGZyb20gXCJzZXQtc3RhdGUtY29tcGFyZS9idWlsZC9zaGFwZS1jb21wb25lbnQuanNcIlxuaW1wb3J0IFRleHQgZnJvbSBcIi4uLy4uL3V0aWxzL3RleHRcIlxuaW1wb3J0IHVzZUJyZWFrcG9pbnQgZnJvbSBcIi4uLy4uL3VzZS1icmVha3BvaW50LmpzXCJcbmltcG9ydCB1c2VDdXJyZW50VXNlciBmcm9tIFwiLi4vLi4vdXNlLWN1cnJlbnQtdXNlci5qc1wiXG5pbXBvcnQgdXNlSTE4biBmcm9tIFwiaTE4bi1vbi1zdGVyb2lkcy9zcmMvdXNlLWkxOG4ubWpzXCJcblxuY29uc3QgTm9BY2Nlc3MgPSBSZWFjdC5sYXp5KCgpID0+IGltcG9ydChcIi4vbm8tYWNjZXNzXCIpKVxuXG5jb25zdCBzdHlsZXMgPSBTdHlsZVNoZWV0LmNyZWF0ZSh7XG4gIGFwcExheW91dENvbnRlbnRDb250YWluZXI6IHtcbiAgICBiYXNlOiB7XG4gICAgICBtaW5IZWlnaHQ6IFwiMTAwdmhcIixcbiAgICAgIGJhY2tncm91bmRDb2xvcjogXCIjZjdmN2Y3XCJcbiAgICB9LFxuICAgIG1kRG93bjoge1xuICAgICAgcGFkZGluZ1RvcDogMTMwLFxuICAgICAgcGFkZGluZ1JpZ2h0OiAzMCxcbiAgICAgIHBhZGRpbmdCb3R0b206IDMwXG4gICAgfSxcbiAgICBtZFVwOiB7XG4gICAgICBwYWRkaW5nVG9wOiAxMzAsXG4gICAgICBwYWRkaW5nUmlnaHQ6IDMwLFxuICAgICAgcGFkZGluZ0JvdHRvbTogMzAsXG4gICAgICBwYWRkaW5nTGVmdDogMjgwXG4gICAgfSxcbiAgICBsZ1VwOiB7XG4gICAgICBwYWRkaW5nVG9wOiAxMzAsXG4gICAgICBwYWRkaW5nUmlnaHQ6IDMwLFxuICAgICAgcGFkZGluZ0JvdHRvbTogMzAsXG4gICAgICBwYWRkaW5nTGVmdDogMzIwXG4gICAgfVxuICB9LFxuICBtYjE1OiB7XG4gICAgbWFyZ2luQm90dG9tOiAxNVxuICB9LFxuICByb290Vmlldzoge1xuICAgIHdpZHRoOiBcIjEwMCVcIixcbiAgICBtaW5IZWlnaHQ6IFwiMTAwdmhcIixcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiI2ZmZlwiLFxuICAgIGNvbG9yOiBcIiMwMDBcIlxuICB9XG59KVxuXG5leHBvcnQgZGVmYXVsdCBtZW1vKHNoYXBlQ29tcG9uZW50KGNsYXNzIEFwaU1ha2VyU3VwZXJBZG1pbkxheW91dCBleHRlbmRzIEJhc2VDb21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0gUHJvcFR5cGVzRXhhY3Qoe1xuICAgIGFjdGlvbnM6IFByb3BUeXBlcy5hbnksXG4gICAgYWN0aXZlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICAgIGNsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBjdXJyZW50Q3VzdG9tZXI6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgY3VycmVudEN1c3RvbWVySWQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgY3VycmVudFVzZXI6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgaGVhZFRpdGxlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGhlYWRlclRpdGxlOiBQcm9wVHlwZXMuc3RyaW5nXG4gIH0pXG5cbiAgc2V0dXAoKSB7XG4gICAgY29uc3QgY3VycmVudFVzZXIgPSB1c2VDdXJyZW50VXNlcigpXG4gICAgY29uc3Qge2xvY2FsZSwgdH0gPSB1c2VJMThuKHtuYW1lc3BhY2U6IFwianMuYXBpX21ha2VyLnN1cGVyX2FkbWluLmxheW91dFwifSlcbiAgICBjb25zdCB7bGdVcCwgbWRVcCwgbWREb3dufSA9IHVzZUJyZWFrcG9pbnQoKVxuXG4gICAgdGhpcy51c2VTdGF0ZXMoe21lbnVUcmlnZ2VyZWQ6IGZhbHNlfSlcbiAgICB0aGlzLnNldEluc3RhbmNlKHtjdXJyZW50VXNlciwgbGdVcCwgbWRVcCwgbWREb3duLCB0fSlcblxuICAgIHVzZU1lbW8oKCkgPT4ge1xuICAgICAgQ29tbWFuZHNQb29sLmN1cnJlbnQoKS5nbG9iYWxSZXF1ZXN0RGF0YS5sYXlvdXQgPSBcImFkbWluXCJcbiAgICAgIENvbW1hbmRzUG9vbC5jdXJyZW50KCkuZ2xvYmFsUmVxdWVzdERhdGEubG9jYWxlID0gbG9jYWxlXG4gICAgfSwgW2xvY2FsZV0pXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2N1cnJlbnRVc2VyLCBsZ1VwLCBtZFVwLCBtZERvd24sIHR9ID0gdGhpcy50dFxuICAgIGNvbnN0IHtcbiAgICAgIGFjdGlvbnMsXG4gICAgICBhY3RpdmUsXG4gICAgICBjaGlsZHJlbixcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIGN1cnJlbnRDdXN0b21lcixcbiAgICAgIGN1cnJlbnRDdXN0b21lcklkLFxuICAgICAgaGVhZFRpdGxlLFxuICAgICAgaGVhZGVyVGl0bGUsXG4gICAgICBtZW51LFxuICAgICAgLi4ucmVzdFByb3BzXG4gICAgfSA9IHRoaXMucHJvcHNcbiAgICBjb25zdCBhY3R1YWxIZWFkVGl0bGUgPSBoZWFkVGl0bGUgfHwgaGVhZGVyVGl0bGVcblxuICAgIGlmIChhY3R1YWxIZWFkVGl0bGUpIHtcbiAgICAgIGRvY3VtZW50LnRpdGxlID0gYWN0dWFsSGVhZFRpdGxlXG4gICAgfSBlbHNlIHtcbiAgICAgIGRvY3VtZW50LnRpdGxlID0gXCJTdXBlciBBZG1pblwiXG4gICAgfVxuXG4gICAgY29uc3Qgbm9BY2Nlc3MgPSAhY3VycmVudFVzZXJcbiAgICBjb25zdCBhcHBMYXlvdXRDb250ZW50Q29udGFpbmVyU3R5bGVzID0gW3N0eWxlcy5hcHBMYXlvdXRDb250ZW50Q29udGFpbmVyLmJhc2VdXG5cbiAgICBpZiAobWREb3duKSBhcHBMYXlvdXRDb250ZW50Q29udGFpbmVyU3R5bGVzLnB1c2goc3R5bGVzLmFwcExheW91dENvbnRlbnRDb250YWluZXIubWREb3duKVxuICAgIGlmIChtZFVwKSBhcHBMYXlvdXRDb250ZW50Q29udGFpbmVyU3R5bGVzLnB1c2goc3R5bGVzLmFwcExheW91dENvbnRlbnRDb250YWluZXIubWRVcClcbiAgICBpZiAobGdVcCkgYXBwTGF5b3V0Q29udGVudENvbnRhaW5lclN0eWxlcy5wdXNoKHN0eWxlcy5hcHBMYXlvdXRDb250ZW50Q29udGFpbmVyLmxnVXApXG5cbiAgICByZXR1cm4gKFxuICAgICAgPFZpZXdcbiAgICAgICAgZGF0YVNldD17e2NvbXBvbmVudDogXCJzdXBlci1hZG1pbi0tbGF5b3V0XCIsIGNsYXNzOiBjbGFzc05hbWUsIG1lbnVUcmlnZ2VyZWQ6IHRoaXMucy5tZW51VHJpZ2dlcmVkfX1cbiAgICAgICAgc3R5bGU9e3N0eWxlcy5yb290Vmlld31cbiAgICAgICAgey4uLnJlc3RQcm9wc30+XG4gICAgICAgIDxNZW51XG4gICAgICAgICAgYWN0aXZlPXthY3RpdmV9XG4gICAgICAgICAgbm9BY2Nlc3M9e25vQWNjZXNzfVxuICAgICAgICAgIG9uUmVxdWVzdE1lbnVDbG9zZT17dGhpcy50dC5vblJlcXVlc3RNZW51Q2xvc2V9XG4gICAgICAgICAgdHJpZ2dlcmVkPXt0aGlzLnMubWVudVRyaWdnZXJlZH1cbiAgICAgICAgLz5cbiAgICAgICAgPEhlYWRlciBhY3Rpb25zPXthY3Rpb25zfSBvblRyaWdnZXJNZW51PXt0aGlzLnR0Lm9uVHJpZ2dlck1lbnV9IHRpdGxlPXtoZWFkZXJUaXRsZX0gLz5cbiAgICAgICAgPFZpZXcgZGF0YVNldD17e2NsYXNzOiBcImFwcC1sYXlvdXQtY29udGVudC1jb250YWluZXJcIn19IHN0eWxlPXthcHBMYXlvdXRDb250ZW50Q29udGFpbmVyU3R5bGVzfT5cbiAgICAgICAgICB7bm9BY2Nlc3MgJiZcbiAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgIDxOb0FjY2VzcyAvPlxuICAgICAgICAgICAgICB7Y3VycmVudFVzZXIgJiZcbiAgICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgICAgPFRleHQgc3R5bGU9e3N0eWxlcy5tYjE1fT5cbiAgICAgICAgICAgICAgICAgICAge3QoXCIudHJ5X3NpZ25pbmdfb3V0X2FuZF9pbl93aXRoX2FfZGlmZmVyZW50X3VzZXJcIiwge2RlZmF1bHRWYWx1ZTogXCJUcnkgc2lnbmluZyBpbiB3aXRoIGEgZGlmZmVyZW50IHVzZXIuXCJ9KX1cbiAgICAgICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB7IWN1cnJlbnRVc2VyICYmXG4gICAgICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgICAgIDxUZXh0IHN0eWxlPXtzdHlsZXMubWIxNX0+XG4gICAgICAgICAgICAgICAgICAgIHt0KFwiLnRyeV9zaWduaW5nX2luXCIsIHtkZWZhdWx0VmFsdWU6IFwiVHJ5IHNpZ25pbmcgaW4uXCJ9KX1cbiAgICAgICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgICAgICAgIHtjb25maWcuc2lnbkluQ29udGVudCgpfVxuICAgICAgICAgICAgICAgIDwvPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICB9XG4gICAgICAgICAgeyFub0FjY2VzcyAmJiBjaGlsZHJlbn1cbiAgICAgICAgPC9WaWV3PlxuICAgICAgPC9WaWV3PlxuICAgIClcbiAgfVxuXG4gIG9uUmVxdWVzdE1lbnVDbG9zZSA9ICgpID0+IHRoaXMuc2V0U3RhdGUoe21lbnVUcmlnZ2VyZWQ6IGZhbHNlfSlcbiAgb25UcmlnZ2VyTWVudSA9IChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgdGhpcy5zZXRTdGF0ZSh7bWVudVRyaWdnZXJlZDogIXRoaXMucy5tZW51VHJpZ2dlcmVkfSlcbiAgfVxufSkpXG4iXX0=