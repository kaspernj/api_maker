import { StyleSheet, View } from "react-native";
import BaseComponent from "../../../base-component.js";
import Devise from "../../../devise.js";
import { FlashNotifications } from "flash-notifications";
import Icon from "../../../utils/icon.js";
import memo from "set-state-compare/build/memo.js";
import Link from "../../../link.js";
import MenuContent from "./menu-content.js";
import MenuItem from "./menu-item.js";
import Params from "../../../params.js";
import PropTypes from "prop-types";
import PropTypesExact from "prop-types-exact";
import React, { useMemo } from "react";
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import Text from "../../../utils/text.js";
import useBreakpoint from "../../../use-breakpoint.js";
import useCurrentUser from "../../../use-current-user.js";
import useI18n from "i18n-on-steroids/src/use-i18n.mjs";
import { WithDefaultStyle } from "../../../utils/default-style.js";
// Hook for consistent menu logo link styling (replaces SCSS)
export const useMenuLogoLinkStyle = () => useMemo(() => ({ color: "#dededf", textDecorationLine: "none" }), []);
const styles = StyleSheet.create({
    root: {
        base: {
            position: "fixed",
            zIndex: 9,
            overflowY: "auto",
            overflowX: "hidden",
            top: 0,
            left: 0,
            height: "100%",
            flexDirection: "column",
            backgroundColor: "#1b1c1e"
        },
        mdDown: {
            width: "100%",
            maxWidth: 250,
            maxHeight: "100vh",
            overflowY: "auto"
        },
        mdUp: {
            width: 250
        },
        lgUp: {
            width: 290
        }
    },
    userName: {
        flexShrink: 1,
        marginLeft: 8
    },
    userNameContainer: {
        overflow: "hidden",
        maxWidth: 140
    }
});
export default memo(shapeComponent(class ComponentsAdminLayoutMenu extends BaseComponent {
    static propTypes = PropTypesExact({
        active: PropTypes.string,
        noAccess: PropTypes.bool.isRequired,
        onRequestMenuClose: PropTypes.func.isRequired,
        triggered: PropTypes.bool.isRequired
    });
    setup() {
        const { lgUp, mdDown, mdUp } = useBreakpoint();
        const { t } = useI18n({ namespace: "js.api_maker.super_admin.layout.menu" });
        const currentUser = useCurrentUser();
        this.setInstance({ currentUser, lgUp, mdDown, mdUp, t });
    }
    render() {
        const { currentUser, lgUp, mdDown, mdUp, t } = this.tt;
        const menuLogoLinkStyle = useMenuLogoLinkStyle();
        const { active, noAccess, triggered } = this.props;
        const style = [styles.root.base];
        if (mdDown)
            style.push(styles.root.mdDown);
        if (mdUp)
            style.push(styles.root.mdUp);
        if (lgUp)
            style.push(styles.root.lgUp);
        if (mdDown && !triggered) {
            return null;
        }
        return (<View dataSet={this.cache("rootViewDataSet", { component: "super-admin--layout--menu", triggered }, [triggered])} style={style}>
        <WithDefaultStyle style={this.cache("withDefaultStyleStyle", { Text: { color: "#fff" } })}>
          <View dataSet={this.cache("menuLogoViewDataSet", { class: "menu-logo" })} style={this.cache("menuLogoViewStyle", {
                overflow: "hidden",
                marginTop: 25,
                marginRight: "auto",
                marginLeft: "auto"
            })}>
            <Link dataSet={this.cache("menuLogoLinkDataSet", { class: "menu-logo-link" })} to={Params.withParams({})}>
              <Text style={[
                menuLogoLinkStyle,
                this.cache("menuLogoLinkTextStyle", {
                    fontSize: 42,
                    textOverflow: "ellipsis",
                    whiteSpace: "nowrap"
                })
            ]}>
                Admin
              </Text>
            </Link>
          </View>
          <View dataSet={{ class: "menu-items-center" }} style={{ marginTop: 25 }}>
            {!noAccess &&
                <MenuContent active={active}/>}
          </View>
          <View dataSet={{ class: "menu-items-bottom" }} style={{ marginTop: "auto", marginBottom: 25 }}>
            {currentUser &&
                <View dataSet={{ class: "menu-user-section" }} style={{
                        flexDirection: "row",
                        alignItems: "center",
                        marginRight: 25,
                        marginBottom: 25,
                        marginLeft: 25
                    }}>
                <View dataSet={{ class: "menu-user-icon" }} style={{
                        width: 44,
                        height: 44,
                        alignItems: "center",
                        justifyContent: "center",
                        backgroundColor: "#abbcd0",
                        borderRadius: "50%"
                    }}>
                  <Icon name="user" size={12}/>
                </View>
                <View className="menu-user-name" style={styles.userName}>
                  <Text dataSet={{ class: "menu-user-name-container" }} style={styles.userNameContainer}>
                    {currentUser.name()}
                  </Text>
                </View>
              </View>}
            {currentUser &&
                <MenuItem active className="sign-out-menu-item" icon="sign-out-alt" label={t(".sign_out", { defaultValue: "Sign out" })} onClick={this.tt.onSignOutClicked}/>}
          </View>
        </WithDefaultStyle>
      </View>);
    }
    onSignOutClicked = async (e) => {
        e.preventDefault();
        try {
            await Devise.signOut();
            FlashNotifications.success(this.t(".you_have_been_signed_out", { defaultValue: "You have been signed out" }));
        }
        catch (error) {
            FlashNotifications.errorResponse(error);
        }
    };
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiL3NyYy8iLCJzb3VyY2VzIjpbInN1cGVyLWFkbWluL2xheW91dC9tZW51L2luZGV4LmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsVUFBVSxFQUFFLElBQUksRUFBQyxNQUFNLGNBQWMsQ0FBQTtBQUM3QyxPQUFPLGFBQWEsTUFBTSw0QkFBNEIsQ0FBQTtBQUN0RCxPQUFPLE1BQU0sTUFBTSxvQkFBb0IsQ0FBQTtBQUN2QyxPQUFPLEVBQUMsa0JBQWtCLEVBQUMsTUFBTSxxQkFBcUIsQ0FBQTtBQUN0RCxPQUFPLElBQUksTUFBTSx3QkFBd0IsQ0FBQTtBQUN6QyxPQUFPLElBQUksTUFBTSxpQ0FBaUMsQ0FBQTtBQUNsRCxPQUFPLElBQUksTUFBTSxrQkFBa0IsQ0FBQTtBQUNuQyxPQUFPLFdBQVcsTUFBTSxtQkFBbUIsQ0FBQTtBQUMzQyxPQUFPLFFBQVEsTUFBTSxnQkFBZ0IsQ0FBQTtBQUNyQyxPQUFPLE1BQU0sTUFBTSxvQkFBb0IsQ0FBQTtBQUN2QyxPQUFPLFNBQVMsTUFBTSxZQUFZLENBQUE7QUFDbEMsT0FBTyxjQUFjLE1BQU0sa0JBQWtCLENBQUE7QUFDN0MsT0FBTyxLQUFLLEVBQUUsRUFBQyxPQUFPLEVBQUMsTUFBTSxPQUFPLENBQUE7QUFDcEMsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLDRDQUE0QyxDQUFBO0FBQ3pFLE9BQU8sSUFBSSxNQUFNLHdCQUF3QixDQUFBO0FBQ3pDLE9BQU8sYUFBYSxNQUFNLDRCQUE0QixDQUFBO0FBQ3RELE9BQU8sY0FBYyxNQUFNLDhCQUE4QixDQUFBO0FBQ3pELE9BQU8sT0FBTyxNQUFNLG1DQUFtQyxDQUFBO0FBQ3ZELE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLGlDQUFpQyxDQUFBO0FBRWhFLDZEQUE2RDtBQUM3RCxNQUFNLENBQUMsTUFBTSxvQkFBb0IsR0FBRyxHQUFHLEVBQUUsQ0FDdkMsT0FBTyxDQUFDLEdBQUcsRUFBRSxD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QkFBMEIsRUFBQyxDQUFDLENBQUMsQ0FBQTtRQUM3RyxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLGtCQUFrQixDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUN6QyxDQUFDO0lBQ0gsQ0FBQyxDQUFBO0NBQ0YsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1N0eWxlU2hlZXQsIFZpZXd9IGZyb20gXCJyZWFjdC1uYXRpdmVcIlxuaW1wb3J0IEJhc2VDb21wb25lbnQgZnJvbSBcIi4uLy4uLy4uL2Jhc2UtY29tcG9uZW50LmpzXCJcbmltcG9ydCBEZXZpc2UgZnJvbSBcIi4uLy4uLy4uL2RldmlzZS5qc1wiXG5pbXBvcnQge0ZsYXNoTm90aWZpY2F0aW9uc30gZnJvbSBcImZsYXNoLW5vdGlmaWNhdGlvbnNcIlxuaW1wb3J0IEljb24gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL2ljb24uanNcIlxuaW1wb3J0IG1lbW8gZnJvbSBcInNldC1zdGF0ZS1jb21wYXJlL2J1aWxkL21lbW8uanNcIlxuaW1wb3J0IExpbmsgZnJvbSBcIi4uLy4uLy4uL2xpbmsuanNcIlxuaW1wb3J0IE1lbnVDb250ZW50IGZyb20gXCIuL21lbnUtY29udGVudC5qc1wiXG5pbXBvcnQgTWVudUl0ZW0gZnJvbSBcIi4vbWVudS1pdGVtLmpzXCJcbmltcG9ydCBQYXJhbXMgZnJvbSBcIi4uLy4uLy4uL3BhcmFtcy5qc1wiXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gXCJwcm9wLXR5cGVzXCJcbmltcG9ydCBQcm9wVHlwZXNFeGFjdCBmcm9tIFwicHJvcC10eXBlcy1leGFjdFwiXG5pbXBvcnQgUmVhY3QsIHt1c2VNZW1vfSBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IHtzaGFwZUNvbXBvbmVudH0gZnJvbSBcInNldC1zdGF0ZS1jb21wYXJlL2J1aWxkL3NoYXBlLWNvbXBvbmVudC5qc1wiXG5pbXBvcnQgVGV4dCBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdGV4dC5qc1wiXG5pbXBvcnQgdXNlQnJlYWtwb2ludCBmcm9tIFwiLi4vLi4vLi4vdXNlLWJyZWFrcG9pbnQuanNcIlxuaW1wb3J0IHVzZUN1cnJlbnRVc2VyIGZyb20gXCIuLi8uLi8uLi91c2UtY3VycmVudC11c2VyLmpzXCJcbmltcG9ydCB1c2VJMThuIGZyb20gXCJpMThuLW9uLXN0ZXJvaWRzL3NyYy91c2UtaTE4bi5tanNcIlxuaW1wb3J0IHtXaXRoRGVmYXVsdFN0eWxlfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvZGVmYXVsdC1zdHlsZS5qc1wiXG5cbi8vIEhvb2sgZm9yIGNvbnNpc3RlbnQgbWVudSBsb2dvIGxpbmsgc3R5bGluZyAocmVwbGFjZXMgU0NTUylcbmV4cG9ydCBjb25zdCB1c2VNZW51TG9nb0xpbmtTdHlsZSA9ICgpID0+XG4gIHVzZU1lbW8oKCkgPT4gKHtjb2xvcjogXCIjZGVkZWRmXCIsIHRleHREZWNvcmF0aW9uTGluZTogXCJub25lXCJ9KSwgW10pXG5cbmNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAgcm9vdDoge1xuICAgIGJhc2U6IHtcbiAgICAgIHBvc2l0aW9uOiBcImZpeGVkXCIsXG4gICAgICB6SW5kZXg6IDksXG4gICAgICBvdmVyZmxvd1k6IFwiYXV0b1wiLFxuICAgICAgb3ZlcmZsb3dYOiBcImhpZGRlblwiLFxuICAgICAgdG9wOiAwLFxuICAgICAgbGVmdDogMCxcbiAgICAgIGhlaWdodDogXCIxMDAlXCIsXG4gICAgICBmbGV4RGlyZWN0aW9uOiBcImNvbHVtblwiLFxuICAgICAgYmFja2dyb3VuZENvbG9yOiBcIiMxYjFjMWVcIlxuICAgIH0sXG4gICAgbWREb3duOiB7XG4gICAgICB3aWR0aDogXCIxMDAlXCIsXG4gICAgICBtYXhXaWR0aDogMjUwLFxuICAgICAgbWF4SGVpZ2h0OiBcIjEwMHZoXCIsXG4gICAgICBvdmVyZmxvd1k6IFwiYXV0b1wiXG4gICAgfSxcbiAgICBtZFVwOiB7XG4gICAgICB3aWR0aDogMjUwXG4gICAgfSxcbiAgICBsZ1VwOiB7XG4gICAgICB3aWR0aDogMjkwXG4gICAgfVxuICB9LFxuICB1c2VyTmFtZToge1xuICAgIGZsZXhTaHJpbms6IDEsXG4gICAgbWFyZ2luTGVmdDogOFxuICB9LFxuICB1c2VyTmFtZUNvbnRhaW5lcjoge1xuICAgIG92ZXJmbG93OiBcImhpZGRlblwiLFxuICAgIG1heFdpZHRoOiAxNDBcbiAgfVxufSlcblxuZXhwb3J0IGRlZmF1bHQgbWVtbyhzaGFwZUNvbXBvbmVudChjbGFzcyBDb21wb25lbnRzQWRtaW5MYXlvdXRNZW51IGV4dGVuZHMgQmFzZUNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSBQcm9wVHlwZXNFeGFjdCh7XG4gICAgYWN0aXZlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIG5vQWNjZXNzOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIG9uUmVxdWVzdE1lbnVDbG9zZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICB0cmlnZ2VyZWQ6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWRcbiAgfSlcblxuICBzZXR1cCgpIHtcbiAgICBjb25zdCB7bGdVcCwgbWREb3duLCBtZFVwfSA9IHVzZUJyZWFrcG9pbnQoKVxuICAgIGNvbnN0IHt0fSA9IHVzZUkxOG4oe25hbWVzcGFjZTogXCJqcy5hcGlfbWFrZXIuc3VwZXJfYWRtaW4ubGF5b3V0Lm1lbnVcIn0pXG4gICAgY29uc3QgY3VycmVudFVzZXIgPSB1c2VDdXJyZW50VXNlcigpXG5cbiAgICB0aGlzLnNldEluc3RhbmNlKHtjdXJyZW50VXNlciwgbGdVcCwgbWREb3duLCBtZFVwLCB0fSlcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7Y3VycmVudFVzZXIsIGxnVXAsIG1kRG93biwgbWRVcCwgdH0gPSB0aGlzLnR0XG4gICAgY29uc3QgbWVudUxvZ29MaW5rU3R5bGUgPSB1c2VNZW51TG9nb0xpbmtTdHlsZSgpXG4gICAgY29uc3Qge2FjdGl2ZSwgbm9BY2Nlc3MsIHRyaWdnZXJlZH0gPSB0aGlzLnByb3BzXG5cbiAgICBjb25zdCBzdHlsZSA9IFtzdHlsZXMucm9vdC5iYXNlXVxuXG4gICAgaWYgKG1kRG93bikgc3R5bGUucHVzaChzdHlsZXMucm9vdC5tZERvd24pXG4gICAgaWYgKG1kVXApIHN0eWxlLnB1c2goc3R5bGVzLnJvb3QubWRVcClcbiAgICBpZiAobGdVcCkgc3R5bGUucHVzaChzdHlsZXMucm9vdC5sZ1VwKVxuXG4gICAgaWYgKG1kRG93biAmJiAhdHJpZ2dlcmVkKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICA8VmlldyBkYXRhU2V0PXt0aGlzLmNhY2hlKFwicm9vdFZpZXdEYXRhU2V0XCIsIHtjb21wb25lbnQ6IFwic3VwZXItYWRtaW4tLWxheW91dC0tbWVudVwiLCB0cmlnZ2VyZWR9LCBbdHJpZ2dlcmVkXSl9IHN0eWxlPXtzdHlsZX0+XG4gICAgICAgIDxXaXRoRGVmYXVsdFN0eWxlIHN0eWxlPXt0aGlzLmNhY2hlKFwid2l0aERlZmF1bHRTdHlsZVN0eWxlXCIsIHtUZXh0OiB7Y29sb3I6IFwiI2ZmZlwifX0pfT5cbiAgICAgICAgICA8Vmlld1xuICAgICAgICAgICAgZGF0YVNldD17dGhpcy5jYWNoZShcIm1lbnVMb2dvVmlld0RhdGFTZXRcIiwge2NsYXNzOiBcIm1lbnUtbG9nb1wifSl9XG4gICAgICAgICAgICBzdHlsZT17dGhpcy5jYWNoZShcIm1lbnVMb2dvVmlld1N0eWxlXCIsIHtcbiAgICAgICAgICAgICAgb3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG4gICAgICAgICAgICAgIG1hcmdpblRvcDogMjUsXG4gICAgICAgICAgICAgIG1hcmdpblJpZ2h0OiBcImF1dG9cIixcbiAgICAgICAgICAgICAgbWFyZ2luTGVmdDogXCJhdXRvXCJcbiAgICAgICAgICAgIH0pfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxMaW5rIGRhdGFTZXQ9e3RoaXMuY2FjaGUoXCJtZW51TG9nb0xpbmtEYXRhU2V0XCIsIHtjbGFzczogXCJtZW51LWxvZ28tbGlua1wifSl9IHRvPXtQYXJhbXMud2l0aFBhcmFtcyh7fSl9PlxuICAgICAgICAgICAgICA8VGV4dFxuICAgICAgICAgICAgICAgIHN0eWxlPXtbXG4gICAgICAgICAgICAgICAgICBtZW51TG9nb0xpbmtTdHlsZSxcbiAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGUoXCJtZW51TG9nb0xpbmtUZXh0U3R5bGVcIiwge1xuICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogNDIsXG4gICAgICAgICAgICAgICAgICAgIHRleHRPdmVyZmxvdzogXCJlbGxpcHNpc1wiLFxuICAgICAgICAgICAgICAgICAgICB3aGl0ZVNwYWNlOiBcIm5vd3JhcFwiXG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICBBZG1pblxuICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICA8L0xpbms+XG4gICAgICAgICAgPC9WaWV3PlxuICAgICAgICAgIDxWaWV3IGRhdGFTZXQ9e3tjbGFzczogXCJtZW51LWl0ZW1zLWNlbnRlclwifX0gc3R5bGU9e3ttYXJnaW5Ub3A6IDI1fX0+XG4gICAgICAgICAgICB7IW5vQWNjZXNzICYmXG4gICAgICAgICAgICAgIDxNZW51Q29udGVudCBhY3RpdmU9e2FjdGl2ZX0gLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgICAgPFZpZXcgZGF0YVNldD17e2NsYXNzOiBcIm1lbnUtaXRlbXMtYm90dG9tXCJ9fSBzdHlsZT17e21hcmdpblRvcDogXCJhdXRvXCIsIG1hcmdpbkJvdHRvbTogMjV9fT5cbiAgICAgICAgICAgIHtjdXJyZW50VXNlciAmJlxuICAgICAgICAgICAgICA8Vmlld1xuICAgICAgICAgICAgICAgIGRhdGFTZXQ9e3tjbGFzczogXCJtZW51LXVzZXItc2VjdGlvblwifX1cbiAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgZmxleERpcmVjdGlvbjogXCJyb3dcIixcbiAgICAgICAgICAgICAgICAgIGFsaWduSXRlbXM6IFwiY2VudGVyXCIsXG4gICAgICAgICAgICAgICAgICBtYXJnaW5SaWdodDogMjUsXG4gICAgICAgICAgICAgICAgICBtYXJnaW5Cb3R0b206IDI1LFxuICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogMjVcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPFZpZXdcbiAgICAgICAgICAgICAgICAgIGRhdGFTZXQ9e3tjbGFzczogXCJtZW51LXVzZXItaWNvblwifX1cbiAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiA0NCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA0NCxcbiAgICAgICAgICAgICAgICAgICAgYWxpZ25JdGVtczogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICAgICAganVzdGlmeUNvbnRlbnQ6IFwiY2VudGVyXCIsXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCIjYWJiY2QwXCIsXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlclJhZGl1czogXCI1MCVcIlxuICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8SWNvbiBuYW1lPVwidXNlclwiIHNpemU9ezEyfSAvPlxuICAgICAgICAgICAgICAgIDwvVmlldz5cbiAgICAgICAgICAgICAgICA8VmlldyBjbGFzc05hbWU9XCJtZW51LXVzZXItbmFtZVwiIHN0eWxlPXtzdHlsZXMudXNlck5hbWV9PlxuICAgICAgICAgICAgICAgICAgPFRleHQgZGF0YVNldD17e2NsYXNzOiBcIm1lbnUtdXNlci1uYW1lLWNvbnRhaW5lclwifX0gc3R5bGU9e3N0eWxlcy51c2VyTmFtZUNvbnRhaW5lcn0+XG4gICAgICAgICAgICAgICAgICAgIHtjdXJyZW50VXNlci5uYW1lKCl9XG4gICAgICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICAgICAgPC9WaWV3PlxuICAgICAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB7Y3VycmVudFVzZXIgJiZcbiAgICAgICAgICAgICAgPE1lbnVJdGVtXG4gICAgICAgICAgICAgICAgYWN0aXZlXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwic2lnbi1vdXQtbWVudS1pdGVtXCJcbiAgICAgICAgICAgICAgICBpY29uPVwic2lnbi1vdXQtYWx0XCJcbiAgICAgICAgICAgICAgICBsYWJlbD17dChcIi5zaWduX291dFwiLCB7ZGVmYXVsdFZhbHVlOiBcIlNpZ24gb3V0XCJ9KX1cbiAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnR0Lm9uU2lnbk91dENsaWNrZWR9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgPC9WaWV3PlxuICAgICAgICA8L1dpdGhEZWZhdWx0U3R5bGU+XG4gICAgICA8L1ZpZXc+XG4gICAgKVxuICB9XG5cbiAgb25TaWduT3V0Q2xpY2tlZCA9IGFzeW5jIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgRGV2aXNlLnNpZ25PdXQoKVxuICAgICAgRmxhc2hOb3RpZmljYXRpb25zLnN1Y2Nlc3ModGhpcy50KFwiLnlvdV9oYXZlX2JlZW5fc2lnbmVkX291dFwiLCB7ZGVmYXVsdFZhbHVlOiBcIllvdSBoYXZlIGJlZW4gc2lnbmVkIG91dFwifSkpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIEZsYXNoTm90aWZpY2F0aW9ucy5lcnJvclJlc3BvbnNlKGVycm9yKVxuICAgIH1cbiAgfVxufSkpXG4iXX0=