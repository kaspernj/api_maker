import { jsxs as _jsxs, jsx as _jsx } from "react/jsx-runtime";
import BaseComponent from "../base-component";
import { digg } from "diggerize";
import Link from "../link";
import memo from "set-state-compare/build/memo.js";
import Params from "../params.js";
import React from "react";
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import Text from "../utils/text";
import { useMemo } from "react";
export default memo(shapeComponent(class ApiMakerSuperAdminShowReflectionLink extends BaseComponent {
    setup() {
        this.useStates({ count: undefined });
        useMemo(() => {
            this.countRelationship();
        }, []);
    }
    countRelationship = async () => {
        const { model, reflection } = this.p;
        const query = model[reflection.name()]();
        const count = await query.ransack().count();
        this.setState({ count });
    };
    render() {
        const { model, modelClass, reflection } = this.p;
        const { count } = this.s;
        return (_jsx(Link, { to: Params.withParams({ model: digg(modelClass.modelClassData(), "name"), model_id: model.primaryKey(), model_reflection: reflection.name() }), children: _jsxs(Text, { children: [modelClass.humanAttributeName(reflection.name()), " (", count, ")"] }) }));
    }
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hvdy1yZWZsZWN0aW9uLWxpbmsuanMiLCJzb3VyY2VSb290IjoiL3NyYy8iLCJzb3VyY2VzIjpbInN1cGVyLWFkbWluL3Nob3ctcmVmbGVjdGlvbi1saW5rLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxhQUFhLE1BQU0sbUJBQW1CLENBQUE7QUFDN0MsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLFdBQVcsQ0FBQTtBQUM5QixPQUFPLElBQUksTUFBTSxTQUFTLENBQUE7QUFDMUIsT0FBTyxJQUFJLE1BQU0saUNBQWlDLENBQUE7QUFDbEQsT0FBTyxNQUFNLE1BQU0sY0FBYyxDQUFBO0FBQ2pDLE9BQU8sS0FBSyxNQUFNLE9BQU8sQ0FBQTtBQUN6QixPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0sNENBQTRDLENBQUE7QUFDekUsT0FBTyxJQUFJLE1BQU0sZUFBZSxDQUFBO0FBQ2hDLE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxPQUFPLENBQUE7QUFFN0IsZUFBZSxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sb0NBQXFDLFNBQVEsYUFBYTtJQUNqRyxLQUFLO1FBQ0gsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFDLEtBQUssRUFBRSxTQUFTLEVBQUMsQ0FBQyxDQUFBO1FBRWxDLE9BQU8sQ0FBQyxHQUFHLEVBQUU7WUFDWCxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQTtRQUMxQixDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUE7SUFDUixDQUFDO0lBRUQsaUJBQWlCLEdBQUcsS0FBSyxJQUFJLEVBQUU7UUFDN0IsTUFBTSxFQUFDLEtBQUssRUFBRSxVQUFVLEVBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFBO1FBQ2xDLE1BQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFBO1FBQ3hDLE1BQU0sS0FBSyxHQUFHLE1BQU0sS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQUssRUFBRSxDQUFBO1FBRTNDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBQyxLQUFLLEVBQUMsQ0FBQyxDQUFBO0lBQ3hCLENBQUMsQ0FBQTtJQUVELE1BQU07UUFDSixNQUFNLEVBQUMsS0FBSyxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFBO1FBQzlDLE1BQU0sRUFBQyxLQUFLLEVBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFBO1FBRXRCLE9BQU8sQ0FDTCxLQUFDLElBQUksSUFBQyxFQUFFLEVBQUUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLGNBQWMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsVUFBVSxFQUFFLEVBQUUsZ0JBQWdCLEVBQUUsVUFBVSxDQUFDLElBQUksRUFBRSxFQUFDLENBQUMsWUFDaEosTUFBQyxJQUFJLGVBQ0YsVUFBVSxDQUFDLGtCQUFrQixDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxRQUFJLEtBQUssU0FDckQsR0FDRixDQUNSLENBQUE7SUFDSCxDQUFDO0NBQ0YsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQmFzZUNvbXBvbmVudCBmcm9tIFwiLi4vYmFzZS1jb21wb25lbnRcIlxuaW1wb3J0IHtkaWdnfSBmcm9tIFwiZGlnZ2VyaXplXCJcbmltcG9ydCBMaW5rIGZyb20gXCIuLi9saW5rXCJcbmltcG9ydCBtZW1vIGZyb20gXCJzZXQtc3RhdGUtY29tcGFyZS9idWlsZC9tZW1vLmpzXCJcbmltcG9ydCBQYXJhbXMgZnJvbSBcIi4uL3BhcmFtcy5qc1wiXG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCJcbmltcG9ydCB7c2hhcGVDb21wb25lbnR9IGZyb20gXCJzZXQtc3RhdGUtY29tcGFyZS9idWlsZC9zaGFwZS1jb21wb25lbnQuanNcIlxuaW1wb3J0IFRleHQgZnJvbSBcIi4uL3V0aWxzL3RleHRcIlxuaW1wb3J0IHt1c2VNZW1vfSBmcm9tIFwicmVhY3RcIlxuXG5leHBvcnQgZGVmYXVsdCBtZW1vKHNoYXBlQ29tcG9uZW50KGNsYXNzIEFwaU1ha2VyU3VwZXJBZG1pblNob3dSZWZsZWN0aW9uTGluayBleHRlbmRzIEJhc2VDb21wb25lbnQge1xuICBzZXR1cCgpIHtcbiAgICB0aGlzLnVzZVN0YXRlcyh7Y291bnQ6IHVuZGVmaW5lZH0pXG5cbiAgICB1c2VNZW1vKCgpID0+IHtcbiAgICAgIHRoaXMuY291bnRSZWxhdGlvbnNoaXAoKVxuICAgIH0sIFtdKVxuICB9XG5cbiAgY291bnRSZWxhdGlvbnNoaXAgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qge21vZGVsLCByZWZsZWN0aW9ufSA9IHRoaXMucFxuICAgIGNvbnN0IHF1ZXJ5ID0gbW9kZWxbcmVmbGVjdGlvbi5uYW1lKCldKClcbiAgICBjb25zdCBjb3VudCA9IGF3YWl0IHF1ZXJ5LnJhbnNhY2soKS5jb3VudCgpXG5cbiAgICB0aGlzLnNldFN0YXRlKHtjb3VudH0pXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge21vZGVsLCBtb2RlbENsYXNzLCByZWZsZWN0aW9ufSA9IHRoaXMucFxuICAgIGNvbnN0IHtjb3VudH0gPSB0aGlzLnNcblxuICAgIHJldHVybiAoXG4gICAgICA8TGluayB0bz17UGFyYW1zLndpdGhQYXJhbXMoe21vZGVsOiBkaWdnKG1vZGVsQ2xhc3MubW9kZWxDbGFzc0RhdGEoKSwgXCJuYW1lXCIpLCBtb2RlbF9pZDogbW9kZWwucHJpbWFyeUtleSgpLCBtb2RlbF9yZWZsZWN0aW9uOiByZWZsZWN0aW9uLm5hbWUoKX0pfT5cbiAgICAgICAgPFRleHQ+XG4gICAgICAgICAge21vZGVsQ2xhc3MuaHVtYW5BdHRyaWJ1dGVOYW1lKHJlZmxlY3Rpb24ubmFtZSgpKX0gKHtjb3VudH0pXG4gICAgICAgIDwvVGV4dD5cbiAgICAgIDwvTGluaz5cbiAgICApXG4gIH1cbn0pKVxuIl19