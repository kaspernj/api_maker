import BaseComponent from "../base-component.js";
import { digg } from "diggerize";
import Link from "../link.js";
import memo from "set-state-compare/build/memo.js";
import Params from "../params.js";
import React from "react";
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import Text from "../utils/text.js";
import { useMemo } from "react";
export default memo(shapeComponent(class ApiMakerSuperAdminShowReflectionLink extends BaseComponent {
    setup() {
        this.useStates({ count: undefined });
        useMemo(() => {
            this.countRelationship();
        }, []);
    }
    countRelationship = async () => {
        const { model, reflection } = this.p;
        const query = model[reflection.name()]();
        const count = await query.ransack().count();
        this.setState({ count });
    };
    render() {
        const { model, modelClass, reflection } = this.p;
        const { count } = this.s;
        return (<Link to={Params.withParams({ model: digg(modelClass.modelClassData(), "name"), model_id: model.primaryKey(), model_reflection: reflection.name() })}>
        <Text>
          {modelClass.humanAttributeName(reflection.name())} ({count})
        </Text>
      </Link>);
    }
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hvdy1yZWZsZWN0aW9uLWxpbmsuanMiLCJzb3VyY2VSb290IjoiL3NyYy8iLCJzb3VyY2VzIjpbInN1cGVyLWFkbWluL3Nob3ctcmVmbGVjdGlvbi1saW5rLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLGFBQWEsTUFBTSxzQkFBc0IsQ0FBQTtBQUNoRCxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sV0FBVyxDQUFBO0FBQzlCLE9BQU8sSUFBSSxNQUFNLFlBQVksQ0FBQTtBQUM3QixPQUFPLElBQUksTUFBTSxpQ0FBaUMsQ0FBQTtBQUNsRCxPQUFPLE1BQU0sTUFBTSxjQUFjLENBQUE7QUFDakMsT0FBTyxLQUFLLE1BQU0sT0FBTyxDQUFBO0FBQ3pCLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSw0Q0FBNEMsQ0FBQTtBQUN6RSxPQUFPLElBQUksTUFBTSxrQkFBa0IsQ0FBQTtBQUNuQyxPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sT0FBTyxDQUFBO0FBRTdCLGVBQWUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLG9DQUFxQyxTQUFRLGFBQWE7SUFDakcsS0FBSztRQUNILElBQUksQ0FBQyxTQUFTLENBQUMsRUFBQyxLQUFLLEVBQUUsU0FBUyxFQUFDLENBQUMsQ0FBQTtRQUVsQyxPQUFPLENBQUMsR0FBRyxFQUFFO1lBQ1gsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUE7UUFDMUIsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFBO0lBQ1IsQ0FBQztJQUVELGlCQUFpQixHQUFHLEtBQUssSUFBSSxFQUFFO1FBQzdCLE1BQU0sRUFBQyxLQUFLLEVBQUUsVUFBVSxFQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQTtRQUNsQyxNQUFNLEtBQUssR0FBRyxLQUFLLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQTtRQUN4QyxNQUFNLEtBQUssR0FBRyxNQUFNLEtBQUssQ0FBQyxPQUFPLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtRQUUzQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUMsS0FBSyxFQUFDLENBQUMsQ0FBQTtJQUN4QixDQUFDLENBQUE7SUFFRCxNQUFNO1FBQ0osTUFBTSxFQUFDLEtBQUssRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQTtRQUM5QyxNQUFNLEVBQUMsS0FBSyxFQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQTtRQUV0QixPQUFPLENBQ0wsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLGNBQWMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsVUFBVSxFQUFFLEVBQUUsZ0JBQWdCLEVBQUUsVUFBVSxDQUFDLElBQUksRUFBRSxFQUFDLENBQUMsQ0FBQyxDQUNqSjtRQUFBLENBQUMsSUFBSSxDQUNIO1VBQUEsQ0FBQyxVQUFVLENBQUMsa0JBQWtCLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUUsRUFBQyxDQUFDLEtBQUssQ0FBQztRQUM3RCxFQUFFLElBQUksQ0FDUjtNQUFBLEVBQUUsSUFBSSxDQUFDLENBQ1IsQ0FBQTtJQUNILENBQUM7Q0FDRixDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCYXNlQ29tcG9uZW50IGZyb20gXCIuLi9iYXNlLWNvbXBvbmVudC5qc1wiXG5pbXBvcnQge2RpZ2d9IGZyb20gXCJkaWdnZXJpemVcIlxuaW1wb3J0IExpbmsgZnJvbSBcIi4uL2xpbmsuanNcIlxuaW1wb3J0IG1lbW8gZnJvbSBcInNldC1zdGF0ZS1jb21wYXJlL2J1aWxkL21lbW8uanNcIlxuaW1wb3J0IFBhcmFtcyBmcm9tIFwiLi4vcGFyYW1zLmpzXCJcbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IHtzaGFwZUNvbXBvbmVudH0gZnJvbSBcInNldC1zdGF0ZS1jb21wYXJlL2J1aWxkL3NoYXBlLWNvbXBvbmVudC5qc1wiXG5pbXBvcnQgVGV4dCBmcm9tIFwiLi4vdXRpbHMvdGV4dC5qc1wiXG5pbXBvcnQge3VzZU1lbW99IGZyb20gXCJyZWFjdFwiXG5cbmV4cG9ydCBkZWZhdWx0IG1lbW8oc2hhcGVDb21wb25lbnQoY2xhc3MgQXBpTWFrZXJTdXBlckFkbWluU2hvd1JlZmxlY3Rpb25MaW5rIGV4dGVuZHMgQmFzZUNvbXBvbmVudCB7XG4gIHNldHVwKCkge1xuICAgIHRoaXMudXNlU3RhdGVzKHtjb3VudDogdW5kZWZpbmVkfSlcblxuICAgIHVzZU1lbW8oKCkgPT4ge1xuICAgICAgdGhpcy5jb3VudFJlbGF0aW9uc2hpcCgpXG4gICAgfSwgW10pXG4gIH1cblxuICBjb3VudFJlbGF0aW9uc2hpcCA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB7bW9kZWwsIHJlZmxlY3Rpb259ID0gdGhpcy5wXG4gICAgY29uc3QgcXVlcnkgPSBtb2RlbFtyZWZsZWN0aW9uLm5hbWUoKV0oKVxuICAgIGNvbnN0IGNvdW50ID0gYXdhaXQgcXVlcnkucmFuc2FjaygpLmNvdW50KClcblxuICAgIHRoaXMuc2V0U3RhdGUoe2NvdW50fSlcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7bW9kZWwsIG1vZGVsQ2xhc3MsIHJlZmxlY3Rpb259ID0gdGhpcy5wXG4gICAgY29uc3Qge2NvdW50fSA9IHRoaXMuc1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxMaW5rIHRvPXtQYXJhbXMud2l0aFBhcmFtcyh7bW9kZWw6IGRpZ2cobW9kZWxDbGFzcy5tb2RlbENsYXNzRGF0YSgpLCBcIm5hbWVcIiksIG1vZGVsX2lkOiBtb2RlbC5wcmltYXJ5S2V5KCksIG1vZGVsX3JlZmxlY3Rpb246IHJlZmxlY3Rpb24ubmFtZSgpfSl9PlxuICAgICAgICA8VGV4dD5cbiAgICAgICAgICB7bW9kZWxDbGFzcy5odW1hbkF0dHJpYnV0ZU5hbWUocmVmbGVjdGlvbi5uYW1lKCkpfSAoe2NvdW50fSlcbiAgICAgICAgPC9UZXh0PlxuICAgICAgPC9MaW5rPlxuICAgIClcbiAgfVxufSkpXG4iXX0=