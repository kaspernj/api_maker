import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import BaseComponent from "../base-component";
import classNames from "classnames";
import { Input as ApiMakerInput } from "@kaspernj/api-maker/build/inputs/input";
import Checkbox from "./checkbox";
import memo from "set-state-compare/build/memo.js";
import PropTypes from "prop-types";
import React from "react";
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import useI18n from "i18n-on-steroids/src/use-i18n.mjs";
import useInput from "../use-input.js";
export default memo(shapeComponent(class ApiMakerInputsAttachment extends BaseComponent {
    static propTypes = {
        className: PropTypes.string,
        model: PropTypes.object.isRequired,
        onPurgeChanged: PropTypes.func,
        purgeName: PropTypes.string
    };
    setup() {
        const { t } = useI18n({ namespace: "js.api_maker.inputs.attachment" });
        const { inputProps } = useInput({ props: this.props });
        this.setInstance({ inputProps, t });
        this.useStates({
            purgeChecked: false
        });
    }
    render() {
        const { inputProps, t } = this.tt;
        const { attribute, checkboxComponent, className, label, model, name, onPurgeChanged, purgeName, wrapperOpts, ...restProps } = this.props;
        const CheckboxComponent = checkboxComponent || Checkbox;
        const newInputProps = Object.assign({}, inputProps, { type: "file" });
        return (_jsxs("div", { className: classNames("api-maker--inputs--attachment", "components--inputs--input", className), ...restProps, children: [this.isImage() &&
                    _jsx("a", { href: this.getUrl(), target: "_blank", children: _jsx("img", { src: this.getUrl(), style: { maxWidth: "200px", maxHeight: "200px" } }) }), this.getUrl() &&
                    _jsxs("div", { className: "input-checkbox", style: { paddingTop: "15px", paddingBottom: "15px" }, children: [_jsx(CheckboxComponent, { id: this.getPurgeInputId(), name: this.getPurgeInputName(), onChange: this.props.onPurgeChanged }), _jsx("label", { className: "checkbox-label", htmlFor: this.getPurgeInputId(), children: t("js.shared.delete") })] }), !this.s.purgeChecked &&
                    _jsx(ApiMakerInput, { defaultValue: null, inputProps: newInputProps, model: model })] }));
    }
    getContentType() {
        const { attribute, model } = this.p;
        const attributeName = `${attribute}ContentType`;
        if (!(attributeName in model))
            throw new Error(`No such method on ${model.modelClassData().name}: ${attributeName}`);
        return model[attributeName]();
    }
    getPurgeInputId() {
        const { inputProps } = this.tt;
        return `${inputProps.id}_purge`;
    }
    getPurgeInputName() {
        if ("purgeName" in this.props)
            return this.props.purgeName;
        const { inputProps } = this.tt;
        if (!inputProps.name)
            return null;
        const match = inputProps.name.match(/^(.+)\[(.+?)\]$/);
        const purgeInputName = `${match[1]}[${match[2]}_purge]`;
        return purgeInputName;
    }
    getUrl() {
        const { attribute, model } = this.p;
        const attributeName = `${attribute}Url`;
        if (!(attributeName in model))
            throw new Error(`No such method on ${model.modelClassData().name}: ${attributeName}`);
        return model[attributeName]();
    }
    isImage() {
        return this.getContentType()?.startsWith("image/");
    }
    onPurgeChanged = (e) => {
        this.setState({ purgeChecked: digg(e, "target", "checked") });
        if (this.props.onPurgeChanged)
            this.props.onPurgeChanged(e);
    };
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXR0YWNobWVudC5qcyIsInNvdXJjZVJvb3QiOiIvc3JjLyIsInNvdXJjZXMiOlsiaW5wdXRzL2F0dGFjaG1lbnQuanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLGFBQWEsTUFBTSxtQkFBbUIsQ0FBQTtBQUM3QyxPQUFPLFVBQVUsTUFBTSxZQUFZLENBQUE7QUFDbkMsT0FBTyxFQUFDLEtBQUssSUFBSSxhQUFhLEVBQUMsTUFBTSx3Q0FBd0MsQ0FBQTtBQUM3RSxPQUFPLFFBQVEsTUFBTSxZQUFZLENBQUE7QUFDakMsT0FBTyxJQUFJLE1BQU0saUNBQWlDLENBQUE7QUFDbEQsT0FBTyxTQUFTLE1BQU0sWUFBWSxDQUFBO0FBQ2xDLE9BQU8sS0FBSyxNQUFNLE9BQU8sQ0FBQTtBQUN6QixPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0sNENBQTRDLENBQUE7QUFDekUsT0FBTyxPQUFPLE1BQU0sbUNBQW1DLENBQUE7QUFDdkQsT0FBTyxRQUFRLE1BQU0saUJBQWlCLENBQUE7QUFFdEMsZUFBZSxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sd0JBQXlCLFNBQVEsYUFBYTtJQUNyRixNQUFNLENBQUMsU0FBUyxHQUFHO1FBQ2pCLFNBQVMsRUFBRSxTQUFTLENBQUMsTUFBTTtRQUMzQixLQUFLLEVBQUUsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVO1FBQ2xDLGNBQWMsRUFBRSxTQUFTLENBQUMsSUFBSTtRQUM5QixTQUFTLEVBQUUsU0FBUyxDQUFDLE1BQU07S0FDNUIsQ0FBQTtJQUVELEtBQUs7UUFDSCxNQUFNLEVBQUMsQ0FBQyxFQUFDLEdBQUcsT0FBTyxDQUFDLEVBQUMsU0FBUyxFQUFFLGdDQUFnQyxFQUFDLENBQUMsQ0FBQTtRQUNsRSxNQUFNLEVBQUMsVUFBVSxFQUFDLEdBQUcsUUFBUSxDQUFDLEVBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLEVBQUMsQ0FBQyxDQUFBO1FBRWxELElBQUksQ0FBQyxXQUFXLENBQUMsRUFBQyxVQUFV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IlxuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSBcImNsYXNzbmFtZXNcIlxuaW1wb3J0IHtJbnB1dCBhcyBBcGlNYWtlcklucHV0fSBmcm9tIFwiQGthc3Blcm5qL2FwaS1tYWtlci9idWlsZC9pbnB1dHMvaW5wdXRcIlxuaW1wb3J0IENoZWNrYm94IGZyb20gXCIuL2NoZWNrYm94XCJcbmltcG9ydCBtZW1vIGZyb20gXCJzZXQtc3RhdGUtY29tcGFyZS9idWlsZC9tZW1vLmpzXCJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSBcInByb3AtdHlwZXNcIlxuaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiXG5pbXBvcnQge3NoYXBlQ29tcG9uZW50fSBmcm9tIFwic2V0LXN0YXRlLWNvbXBhcmUvYnVpbGQvc2hhcGUtY29tcG9uZW50LmpzXCJcbmltcG9ydCB1c2VJMThuIGZyb20gXCJpMThuLW9uLXN0ZXJvaWRzL3NyYy91c2UtaTE4bi5tanNcIlxuaW1wb3J0IHVzZUlucHV0IGZyb20gXCIuLi91c2UtaW5wdXQuanNcIlxuXG5leHBvcnQgZGVmYXVsdCBtZW1vKHNoYXBlQ29tcG9uZW50KGNsYXNzIEFwaU1ha2VySW5wdXRzQXR0YWNobWVudCBleHRlbmRzIEJhc2VDb21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIGNsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBtb2RlbDogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIG9uUHVyZ2VDaGFuZ2VkOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBwdXJnZU5hbWU6IFByb3BUeXBlcy5zdHJpbmdcbiAgfVxuXG4gIHNldHVwKCkge1xuICAgIGNvbnN0IHt0fSA9IHVzZUkxOG4oe25hbWVzcGFjZTogXCJqcy5hcGlfbWFrZXIuaW5wdXRzLmF0dGFjaG1lbnRcIn0pXG4gICAgY29uc3Qge2lucHV0UHJvcHN9ID0gdXNlSW5wdXQoe3Byb3BzOiB0aGlzLnByb3BzfSlcblxuICAgIHRoaXMuc2V0SW5zdGFuY2Uoe2lucHV0UHJvcHMsIHR9KVxuICAgIHRoaXMudXNlU3RhdGVzKHtcbiAgICAgIHB1cmdlQ2hlY2tlZDogZmFsc2VcbiAgICB9KVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtpbnB1dFByb3BzLCB0fSA9IHRoaXMudHRcbiAgICBjb25zdCB7YXR0cmlidXRlLCBjaGVja2JveENvbXBvbmVudCwgY2xhc3NOYW1lLCBsYWJlbCwgbW9kZWwsIG5hbWUsIG9uUHVyZ2VDaGFuZ2VkLCBwdXJnZU5hbWUsIHdyYXBwZXJPcHRzLCAuLi5yZXN0UHJvcHN9ID0gdGhpcy5wcm9wc1xuICAgIGNvbnN0IENoZWNrYm94Q29tcG9uZW50ID0gY2hlY2tib3hDb21wb25lbnQgfHwgQ2hlY2tib3hcbiAgICBjb25zdCBuZXdJbnB1dFByb3BzID0gT2JqZWN0LmFzc2lnbih7fSwgaW5wdXRQcm9wcywge3R5cGU6IFwiZmlsZVwifSlcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT17Y2xhc3NOYW1lcyhcImFwaS1tYWtlci0taW5wdXRzLS1hdHRhY2htZW50XCIsIFwiY29tcG9uZW50cy0taW5wdXRzLS1pbnB1dFwiLCBjbGFzc05hbWUpfSB7Li4ucmVzdFByb3BzfT5cbiAgICAgICAge3RoaXMuaXNJbWFnZSgpICYmXG4gICAgICAgICAgPGEgaHJlZj17dGhpcy5nZXRVcmwoKX0gdGFyZ2V0PVwiX2JsYW5rXCI+XG4gICAgICAgICAgICA8aW1nIHNyYz17dGhpcy5nZXRVcmwoKX0gc3R5bGU9e3ttYXhXaWR0aDogXCIyMDBweFwiLCBtYXhIZWlnaHQ6IFwiMjAwcHhcIn19IC8+XG4gICAgICAgICAgPC9hPlxuICAgICAgICB9XG4gICAgICAgIHt0aGlzLmdldFVybCgpICYmXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jaGVja2JveFwiIHN0eWxlPXt7cGFkZGluZ1RvcDogXCIxNXB4XCIsIHBhZGRpbmdCb3R0b206IFwiMTVweFwifX0+XG4gICAgICAgICAgICA8Q2hlY2tib3hDb21wb25lbnQgaWQ9e3RoaXMuZ2V0UHVyZ2VJbnB1dElkKCl9IG5hbWU9e3RoaXMuZ2V0UHVyZ2VJbnB1dE5hbWUoKX0gb25DaGFuZ2U9e3RoaXMucHJvcHMub25QdXJnZUNoYW5nZWR9IC8+XG4gICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwiY2hlY2tib3gtbGFiZWxcIiBodG1sRm9yPXt0aGlzLmdldFB1cmdlSW5wdXRJZCgpfT5cbiAgICAgICAgICAgICAge3QoXCJqcy5zaGFyZWQuZGVsZXRlXCIpfVxuICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgfVxuICAgICAgICB7IXRoaXMucy5wdXJnZUNoZWNrZWQgJiZcbiAgICAgICAgICA8QXBpTWFrZXJJbnB1dFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlPXtudWxsfVxuICAgICAgICAgICAgaW5wdXRQcm9wcz17bmV3SW5wdXRQcm9wc31cbiAgICAgICAgICAgIG1vZGVsPXttb2RlbH1cbiAgICAgICAgICAvPlxuICAgICAgICB9XG4gICAgICA8L2Rpdj5cbiAgICApXG4gIH1cblxuICBnZXRDb250ZW50VHlwZSgpIHtcbiAgICBjb25zdCB7YXR0cmlidXRlLCBtb2RlbH0gPSB0aGlzLnBcbiAgICBjb25zdCBhdHRyaWJ1dGVOYW1lID0gYCR7YXR0cmlidXRlfUNvbnRlbnRUeXBlYFxuXG4gICAgaWYgKCEoYXR0cmlidXRlTmFtZSBpbiBtb2RlbCkpIHRocm93IG5ldyBFcnJvcihgTm8gc3VjaCBtZXRob2Qgb24gJHttb2RlbC5tb2RlbENsYXNzRGF0YSgpLm5hbWV9OiAke2F0dHJpYnV0ZU5hbWV9YClcblxuICAgIHJldHVybiBtb2RlbFthdHRyaWJ1dGVOYW1lXSgpXG4gIH1cblxuICBnZXRQdXJnZUlucHV0SWQoKSB7XG4gICAgY29uc3Qge2lucHV0UHJvcHN9ID0gdGhpcy50dFxuXG4gICAgcmV0dXJuIGAke2lucHV0UHJvcHMuaWR9X3B1cmdlYFxuICB9XG5cbiAgZ2V0UHVyZ2VJbnB1dE5hbWUoKSB7XG4gICAgaWYgKFwicHVyZ2VOYW1lXCIgaW4gdGhpcy5wcm9wcykgcmV0dXJuIHRoaXMucHJvcHMucHVyZ2VOYW1lXG5cbiAgICBjb25zdCB7aW5wdXRQcm9wc30gPSB0aGlzLnR0XG5cbiAgICBpZiAoIWlucHV0UHJvcHMubmFtZSkgcmV0dXJuIG51bGxcblxuICAgIGNvbnN0IG1hdGNoID0gaW5wdXRQcm9wcy5uYW1lLm1hdGNoKC9eKC4rKVxcWyguKz8pXFxdJC8pXG4gICAgY29uc3QgcHVyZ2VJbnB1dE5hbWUgPSBgJHttYXRjaFsxXX1bJHttYXRjaFsyXX1fcHVyZ2VdYFxuXG4gICAgcmV0dXJuIHB1cmdlSW5wdXROYW1lXG4gIH1cblxuICBnZXRVcmwoKSB7XG4gICAgY29uc3Qge2F0dHJpYnV0ZSwgbW9kZWx9ID0gdGhpcy5wXG4gICAgY29uc3QgYXR0cmlidXRlTmFtZSA9IGAke2F0dHJpYnV0ZX1VcmxgXG5cbiAgICBpZiAoIShhdHRyaWJ1dGVOYW1lIGluIG1vZGVsKSkgdGhyb3cgbmV3IEVycm9yKGBObyBzdWNoIG1ldGhvZCBvbiAke21vZGVsLm1vZGVsQ2xhc3NEYXRhKCkubmFtZX06ICR7YXR0cmlidXRlTmFtZX1gKVxuXG4gICAgcmV0dXJuIG1vZGVsW2F0dHJpYnV0ZU5hbWVdKClcbiAgfVxuXG4gIGlzSW1hZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Q29udGVudFR5cGUoKT8uc3RhcnRzV2l0aChcImltYWdlL1wiKVxuICB9XG5cbiAgb25QdXJnZUNoYW5nZWQgPSAoZSkgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoe3B1cmdlQ2hlY2tlZDogZGlnZyhlLCBcInRhcmdldFwiLCBcImNoZWNrZWRcIil9KVxuXG4gICAgaWYgKHRoaXMucHJvcHMub25QdXJnZUNoYW5nZWQpIHRoaXMucHJvcHMub25QdXJnZUNoYW5nZWQoZSlcbiAgfVxufSkpXG4iXX0=