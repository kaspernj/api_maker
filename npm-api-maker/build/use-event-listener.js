import useEnvSense from "env-sense/build/use-env-sense.js";
import { useCallback, useEffect, useLayoutEffect } from "react";
/**
 * @param {object} target
 * @param {string} event
 * @param {function} onCalled
 * @returns {void}
 */
const ApiMakerUseEventListener = (target, event, onCalled) => {
    const { isServer } = useEnvSense();
    const useWorkingEffect = isServer ? useEffect : useLayoutEffect;
    const onCalledCallback = useCallback((...args) => {
        onCalled.apply(null, args);
    }, [target, event, onCalled]);
    useWorkingEffect(() => {
        if (target) {
            const eventListener = target.addEventListener(event, onCalledCallback);
            return () => {
                if (eventListener?.remove)
                    eventListener.remove(); // This is how its done in Expo + Jest.
                if (target.removeEventListener)
                    target.removeEventListener(event, onCalledCallback); // This is the "old" way in browsers.
            };
        }
    }, [target, event, onCalled]);
};
export default ApiMakerUseEventListener;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlLWV2ZW50LWxpc3RlbmVyLmpzIiwic291cmNlUm9vdCI6Ii9zcmMvIiwic291cmNlcyI6WyJ1c2UtZXZlbnQtbGlzdGVuZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxXQUFXLE1BQU0sa0NBQWtDLENBQUE7QUFDMUQsT0FBTyxFQUFDLFdBQVcsRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFDLE1BQU0sT0FBTyxDQUFBO0FBRTdEOzs7OztHQUtHO0FBQ0gsTUFBTSx3QkFBd0IsR0FBRyxDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLEVBQUU7SUFDM0QsTUFBTSxFQUFDLFFBQVEsRUFBQyxHQUFHLFdBQVcsRUFBRSxDQUFBO0lBQ2hDLE1BQU0sZ0JBQWdCLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQTtJQUMvRCxNQUFNLGdCQUFnQixHQUFHLFdBQVcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxFQUFFLEVBQUU7UUFDL0MsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUE7SUFDNUIsQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFBO0lBRTdCLGdCQUFnQixDQUFDLEdBQUcsRUFBRTtRQUNwQixJQUFJLE1BQU0sRUFBRSxDQUFDO1lBQ1gsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLGdCQUFnQixDQUFDLEtBQUssRUFBRSxnQkFBZ0IsQ0FBQyxDQUFBO1lBRXRFLE9BQU8sR0FBRyxFQUFFO2dCQUNWLElBQUksYUFBYSxFQUFFLE1BQU07b0JBQUUsYUFBYSxDQUFDLE1BQU0sRUFBRSxDQUFBLENBQUMsdUNBQXVDO2dCQUN6RixJQUFJLE1BQU0sQ0FBQyxtQkFBbUI7b0JBQUUsTUFBTSxDQUFDLG1CQUFtQixDQUFDLEtBQUssRUFBRSxnQkFBZ0IsQ0FBQyxDQUFBLENBQUMscUNBQXFDO1lBQzNILENBQUMsQ0FBQTtRQUNILENBQUM7SUFDSCxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUE7QUFDL0IsQ0FBQyxDQUFBO0FBRUQsZUFBZSx3QkFBd0IsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB1c2VFbnZTZW5zZSBmcm9tIFwiZW52LXNlbnNlL2J1aWxkL3VzZS1lbnYtc2Vuc2UuanNcIlxuaW1wb3J0IHt1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VMYXlvdXRFZmZlY3R9IGZyb20gXCJyZWFjdFwiXG5cbi8qKlxuICogQHBhcmFtIHtvYmplY3R9IHRhcmdldFxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50XG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBvbkNhbGxlZFxuICogQHJldHVybnMge3ZvaWR9XG4gKi9cbmNvbnN0IEFwaU1ha2VyVXNlRXZlbnRMaXN0ZW5lciA9ICh0YXJnZXQsIGV2ZW50LCBvbkNhbGxlZCkgPT4ge1xuICBjb25zdCB7aXNTZXJ2ZXJ9ID0gdXNlRW52U2Vuc2UoKVxuICBjb25zdCB1c2VXb3JraW5nRWZmZWN0ID0gaXNTZXJ2ZXIgPyB1c2VFZmZlY3QgOiB1c2VMYXlvdXRFZmZlY3RcbiAgY29uc3Qgb25DYWxsZWRDYWxsYmFjayA9IHVzZUNhbGxiYWNrKCguLi5hcmdzKSA9PiB7XG4gICAgb25DYWxsZWQuYXBwbHkobnVsbCwgYXJncylcbiAgfSwgW3RhcmdldCwgZXZlbnQsIG9uQ2FsbGVkXSlcblxuICB1c2VXb3JraW5nRWZmZWN0KCgpID0+IHtcbiAgICBpZiAodGFyZ2V0KSB7XG4gICAgICBjb25zdCBldmVudExpc3RlbmVyID0gdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIG9uQ2FsbGVkQ2FsbGJhY2spXG5cbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGlmIChldmVudExpc3RlbmVyPy5yZW1vdmUpIGV2ZW50TGlzdGVuZXIucmVtb3ZlKCkgLy8gVGhpcyBpcyBob3cgaXRzIGRvbmUgaW4gRXhwbyArIEplc3QuXG4gICAgICAgIGlmICh0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcikgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIG9uQ2FsbGVkQ2FsbGJhY2spIC8vIFRoaXMgaXMgdGhlIFwib2xkXCIgd2F5IGluIGJyb3dzZXJzLlxuICAgICAgfVxuICAgIH1cbiAgfSwgW3RhcmdldCwgZXZlbnQsIG9uQ2FsbGVkXSlcbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBpTWFrZXJVc2VFdmVudExpc3RlbmVyXG4iXX0=