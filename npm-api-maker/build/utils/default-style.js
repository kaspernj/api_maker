import { jsx as _jsx } from "react/jsx-runtime";
import React, { createContext, useContext, useMemo } from "react";
import { incorporate } from "incorporator";
import memo from "set-state-compare/build/memo.js";
const DefaultStyleContext = createContext({
    Text: []
});
const useDefaultStyle = () => {
    const defaultStyle = useContext(DefaultStyleContext);
    return defaultStyle;
};
const useMergedStyle = (style, elementType) => {
    const defaultStyle = useDefaultStyle();
    const stylesList = useMemo(() => {
        const defaultElementStyle = defaultStyle[elementType];
        let stylesList;
        if (Array.isArray(defaultElementStyle)) {
            stylesList = [...defaultElementStyle];
        }
        else if (typeof defaultElementStyle == "object") {
            stylesList = [defaultElementStyle];
        }
        else {
            throw new Error(`Unknown type for default element type: ${typeof defaultElementStyle}`);
        }
        if (style && Array.isArray(style)) {
            for (const styleI of style) {
                stylesList.push(styleI);
            }
        }
        else if (style) {
            stylesList.push(style);
        }
        return stylesList;
    }, [defaultStyle, elementType, style]);
    const actualNewDefaultStyle = useMemo(() => {
        const actualNewDefaultStyle = { ...defaultStyle };
        actualNewDefaultStyle[elementType] = stylesList;
        return actualNewDefaultStyle;
    }, [defaultStyle, elementType, stylesList]);
    return { newDefaultStyle: actualNewDefaultStyle, stylesList };
};
const WithDefaultStyle = memo(({ children, style, ...restProps }) => {
    if (Object.keys(restProps).length > 0) {
        throw new Error(`Unhandled props: ${Object.keys(restProps).join(", ")}`);
    }
    const defaultStyle = useContext(DefaultStyleContext);
    const newDefaultStyle = useMemo(() => {
        for (const key in style) {
            if (!(key in defaultStyle)) {
                throw new Error(`Invalid element type given: ${key}`);
            }
        }
        const newDefaultStyle = {};
        incorporate(newDefaultStyle, defaultStyle, style);
        return newDefaultStyle;
    }, [defaultStyle, style]);
    return (_jsx(DefaultStyleContext.Provider, { value: newDefaultStyle, children: children }));
});
export { useDefaultStyle, useMergedStyle, WithDefaultStyle };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVmYXVsdC1zdHlsZS5qcyIsInNvdXJjZVJvb3QiOiIvc3JjLyIsInNvdXJjZXMiOlsidXRpbHMvZGVmYXVsdC1zdHlsZS5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sS0FBSyxFQUFFLEVBQUMsYUFBYSxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUMsTUFBTSxPQUFPLENBQUE7QUFDL0QsT0FBTyxFQUFDLFdBQVcsRUFBQyxNQUFNLGNBQWMsQ0FBQTtBQUN4QyxPQUFPLElBQUksTUFBTSxpQ0FBaUMsQ0FBQTtBQUVsRCxNQUFNLG1CQUFtQixHQUFHLGFBQWEsQ0FBQztJQUN4QyxJQUFJLEVBQUUsRUFBRTtDQUNULENBQUMsQ0FBQTtBQUVGLE1BQU0sZUFBZSxHQUFHLEdBQUcsRUFBRTtJQUMzQixNQUFNLFlBQVksR0FBRyxVQUFVLENBQUMsbUJBQW1CLENBQUMsQ0FBQTtJQUVwRCxPQUFPLFlBQVksQ0FBQTtBQUNyQixDQUFDLENBQUE7QUFFRCxNQUFNLGNBQWMsR0FBRyxDQUFDLEtBQUssRUFBRSxXQUFXLEVBQUUsRUFBRTtJQUM1QyxNQUFNLFlBQVksR0FBRyxlQUFlLEVBQUUsQ0FBQTtJQUV0QyxNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsR0FBRyxFQUFFO1FBQzlCLE1BQU0sbUJBQW1CLEdBQUcsWUFBWSxDQUFDLFdBQVcsQ0FBQyxDQUFBO1FBQ3JELElBQUksVUFBVSxDQUFBO1FBRWQsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLEVBQUUsQ0FBQztZQUN2QyxVQUFVLEdBQUcsQ0FBQyxHQUFHLG1CQUFtQixDQUFDLENBQUE7UUFDdkMsQ0FBQzthQUFNLElBQUksT0FBTyxtQkFBbUIsSUFBSSxRQUFRLEVBQUUsQ0FBQztZQUNsRCxVQUFVLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFBO1FBQ3BDLENBQUM7YUFBTSxDQUFDO1lBQ04sTUFBTSxJQUFJLEtBQUssQ0FBQywwQ0FBMEMsT0FBTyxtQkFBbUIsRUFBRSxDQUFDLENBQUE7UUFDekYsQ0FBQztRQUVELElBQUksS0FBSyxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUNsQyxLQUFLLE1BQU0sTUFBTSxJQUFJLEtBQUssRUFBRSxDQUFDO2dCQUMzQixVQUFVLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFBO1lBQ3pCLENBQUM7UUFDSCxDQUFDO2FBQU0sSUFBSSxLQUFLLEVBQUUsQ0FBQztZQUNqQixVQUFVLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFBO1FBQ3hCLENBQUM7UUFFRCxPQUFPLFVBQVUsQ0FBQTtJQUNuQixDQUFDLEVBQUUsQ0FBQyxZQUFZLEVBQUUsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUE7SUFFdEMsTUFBTSxxQkFBcUIsR0FBRyxPQUFPLENBQUMsR0FBRyxFQUFFO1FBQ3pDLE1BQU0scUJBQXFCLEdBQUcsRUFBQyxHQUFHLFlBQVksRUFBQyxDQUFBO1FBRS9DLHFCQUFxQixDQUFDLFdBQVcsQ0FBQyxHQUFHLFVBQVUsQ0FBQTtRQUUvQyxPQUFPLHFCQUFxQixDQUFBO0lBQzlCLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxXQUFXLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQTtJQUUzQyxPQUFPLEVBQUMsZUFBZSxFQUFFLHFCQUFxQixFQUFFLFVBQVUsRUFBQyxDQUFBO0FBQzdELENBQUMsQ0FBQTtBQUVELE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLENBQUMsRUFBQyxRQUFRLEVBQUUsS0FBSyxFQUFFLEdBQUcsU0FBUyxFQUFDLEVBQUUsRUFBRTtJQUNoRSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1FBQ3RDLE1BQU0sSUFBSSxLQUFLLENBQUMsb0JBQW9CLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQTtJQUMxRSxDQUFDO0lBRUQsTUFBTSxZQUFZLEdBQUcsVUFBVSxDQUFDLG1CQUFtQixDQUFDLENBQUE7SUFFcEQsTUFBTSxlQUFlLEdBQUcsT0FBTyxDQUFDLEdBQUcsRUFBRTtRQUNuQyxLQUFLLE1BQU0sR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDO1lBQ3hCLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxZQUFZLENBQUMsRUFBRSxDQUFDO2dCQUMzQixNQUFNLElBQUksS0FBSyxDQUFDLCtCQUErQixHQUFHLEVBQUUsQ0FBQyxDQUFBO1lBQ3ZELENBQUM7UUFDSCxDQUFDO1FBRUQsTUFBTSxlQUFlLEdBQUcsRUFBRSxDQUFBO1FBRTFCLFdBQVcsQ0FBQyxlQUFlLEVBQUUsWUFBWSxFQUFFLEtBQUssQ0FBQyxDQUFBO1FBRWpELE9BQU8sZUFBZSxDQUFBO0lBQ3hCLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFBO0lBRXpCLE9BQU8sQ0FDTCxLQUFDLG1CQUFtQixDQUFDLFFBQVEsSUFBQyxLQUFLLEVBQUUsZUFBZSxZQUNqRCxRQUFRLEdBQ29CLENBQ2hDLENBQUE7QUFDSCxDQUFDLENBQUMsQ0FBQTtBQUVGLE9BQU8sRUFBQyxlQUFlLEVBQUUsY0FBYyxFQUFFLGdCQUFnQixFQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHtjcmVhdGVDb250ZXh0LCB1c2VDb250ZXh0LCB1c2VNZW1vfSBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IHtpbmNvcnBvcmF0ZX0gZnJvbSBcImluY29ycG9yYXRvclwiXG5pbXBvcnQgbWVtbyBmcm9tIFwic2V0LXN0YXRlLWNvbXBhcmUvYnVpbGQvbWVtby5qc1wiXG5cbmNvbnN0IERlZmF1bHRTdHlsZUNvbnRleHQgPSBjcmVhdGVDb250ZXh0KHtcbiAgVGV4dDogW11cbn0pXG5cbmNvbnN0IHVzZURlZmF1bHRTdHlsZSA9ICgpID0+IHtcbiAgY29uc3QgZGVmYXVsdFN0eWxlID0gdXNlQ29udGV4dChEZWZhdWx0U3R5bGVDb250ZXh0KVxuXG4gIHJldHVybiBkZWZhdWx0U3R5bGVcbn1cblxuY29uc3QgdXNlTWVyZ2VkU3R5bGUgPSAoc3R5bGUsIGVsZW1lbnRUeXBlKSA9PiB7XG4gIGNvbnN0IGRlZmF1bHRTdHlsZSA9IHVzZURlZmF1bHRTdHlsZSgpXG5cbiAgY29uc3Qgc3R5bGVzTGlzdCA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IGRlZmF1bHRFbGVtZW50U3R5bGUgPSBkZWZhdWx0U3R5bGVbZWxlbWVudFR5cGVdXG4gICAgbGV0IHN0eWxlc0xpc3RcblxuICAgIGlmIChBcnJheS5pc0FycmF5KGRlZmF1bHRFbGVtZW50U3R5bGUpKSB7XG4gICAgICBzdHlsZXNMaXN0ID0gWy4uLmRlZmF1bHRFbGVtZW50U3R5bGVdXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZGVmYXVsdEVsZW1lbnRTdHlsZSA9PSBcIm9iamVjdFwiKSB7XG4gICAgICBzdHlsZXNMaXN0ID0gW2RlZmF1bHRFbGVtZW50U3R5bGVdXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biB0eXBlIGZvciBkZWZhdWx0IGVsZW1lbnQgdHlwZTogJHt0eXBlb2YgZGVmYXVsdEVsZW1lbnRTdHlsZX1gKVxuICAgIH1cblxuICAgIGlmIChzdHlsZSAmJiBBcnJheS5pc0FycmF5KHN0eWxlKSkge1xuICAgICAgZm9yIChjb25zdCBzdHlsZUkgb2Ygc3R5bGUpIHtcbiAgICAgICAgc3R5bGVzTGlzdC5wdXNoKHN0eWxlSSlcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHN0eWxlKSB7XG4gICAgICBzdHlsZXNMaXN0LnB1c2goc3R5bGUpXG4gICAgfVxuXG4gICAgcmV0dXJuIHN0eWxlc0xpc3RcbiAgfSwgW2RlZmF1bHRTdHlsZSwgZWxlbWVudFR5cGUsIHN0eWxlXSlcblxuICBjb25zdCBhY3R1YWxOZXdEZWZhdWx0U3R5bGUgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBjb25zdCBhY3R1YWxOZXdEZWZhdWx0U3R5bGUgPSB7Li4uZGVmYXVsdFN0eWxlfVxuXG4gICAgYWN0dWFsTmV3RGVmYXVsdFN0eWxlW2VsZW1lbnRUeXBlXSA9IHN0eWxlc0xpc3RcblxuICAgIHJldHVybiBhY3R1YWxOZXdEZWZhdWx0U3R5bGVcbiAgfSwgW2RlZmF1bHRTdHlsZSwgZWxlbWVudFR5cGUsIHN0eWxlc0xpc3RdKVxuXG4gIHJldHVybiB7bmV3RGVmYXVsdFN0eWxlOiBhY3R1YWxOZXdEZWZhdWx0U3R5bGUsIHN0eWxlc0xpc3R9XG59XG5cbmNvbnN0IFdpdGhEZWZhdWx0U3R5bGUgPSBtZW1vKCh7Y2hpbGRyZW4sIHN0eWxlLCAuLi5yZXN0UHJvcHN9KSA9PiB7XG4gIGlmIChPYmplY3Qua2V5cyhyZXN0UHJvcHMpLmxlbmd0aCA+IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVuaGFuZGxlZCBwcm9wczogJHtPYmplY3Qua2V5cyhyZXN0UHJvcHMpLmpvaW4oXCIsIFwiKX1gKVxuICB9XG5cbiAgY29uc3QgZGVmYXVsdFN0eWxlID0gdXNlQ29udGV4dChEZWZhdWx0U3R5bGVDb250ZXh0KVxuXG4gIGNvbnN0IG5ld0RlZmF1bHRTdHlsZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGZvciAoY29uc3Qga2V5IGluIHN0eWxlKSB7XG4gICAgICBpZiAoIShrZXkgaW4gZGVmYXVsdFN0eWxlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgZWxlbWVudCB0eXBlIGdpdmVuOiAke2tleX1gKVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IG5ld0RlZmF1bHRTdHlsZSA9IHt9XG5cbiAgICBpbmNvcnBvcmF0ZShuZXdEZWZhdWx0U3R5bGUsIGRlZmF1bHRTdHlsZSwgc3R5bGUpXG5cbiAgICByZXR1cm4gbmV3RGVmYXVsdFN0eWxlXG4gIH0sIFtkZWZhdWx0U3R5bGUsIHN0eWxlXSlcblxuICByZXR1cm4gKFxuICAgIDxEZWZhdWx0U3R5bGVDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtuZXdEZWZhdWx0U3R5bGV9PlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvRGVmYXVsdFN0eWxlQ29udGV4dC5Qcm92aWRlcj5cbiAgKVxufSlcblxuZXhwb3J0IHt1c2VEZWZhdWx0U3R5bGUsIHVzZU1lcmdlZFN0eWxlLCBXaXRoRGVmYXVsdFN0eWxlfVxuIl19