import React, { createContext, useContext, useMemo } from "react";
import { incorporate } from "incorporator";
import memo from "set-state-compare/build/memo.js";
const DefaultStyleContext = createContext({
    Text: []
});
const useDefaultStyle = () => {
    const defaultStyle = useContext(DefaultStyleContext);
    return defaultStyle;
};
const useMergedStyle = (style, elementType) => {
    const defaultStyle = useDefaultStyle();
    const stylesList = useMemo(() => {
        const defaultElementStyle = defaultStyle[elementType];
        let stylesList;
        if (Array.isArray(defaultElementStyle)) {
            stylesList = [...defaultElementStyle];
        }
        else if (typeof defaultElementStyle == "object") {
            stylesList = [defaultElementStyle];
        }
        else {
            throw new Error(`Unknown type for default element type: ${typeof defaultElementStyle}`);
        }
        if (style && Array.isArray(style)) {
            for (const styleI of style) {
                stylesList.push(styleI);
            }
        }
        else if (style) {
            stylesList.push(style);
        }
        return stylesList;
    }, [defaultStyle, elementType, style]);
    const actualNewDefaultStyle = useMemo(() => {
        const actualNewDefaultStyle = { ...defaultStyle };
        actualNewDefaultStyle[elementType] = stylesList;
        return actualNewDefaultStyle;
    }, [defaultStyle, elementType, stylesList]);
    return { newDefaultStyle: actualNewDefaultStyle, stylesList };
};
const WithDefaultStyle = memo(({ children, style, ...restProps }) => {
    if (Object.keys(restProps).length > 0) {
        throw new Error(`Unhandled props: ${Object.keys(restProps).join(", ")}`);
    }
    const defaultStyle = useContext(DefaultStyleContext);
    const newDefaultStyle = useMemo(() => {
        for (const key in style) {
            if (!(key in defaultStyle)) {
                throw new Error(`Invalid element type given: ${key}`);
            }
        }
        const newDefaultStyle = {};
        incorporate(newDefaultStyle, defaultStyle, style);
        return newDefaultStyle;
    }, [defaultStyle, style]);
    return (<DefaultStyleContext.Provider value={newDefaultStyle}>
      {children}
    </DefaultStyleContext.Provider>);
});
export { useDefaultStyle, useMergedStyle, WithDefaultStyle };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVmYXVsdC1zdHlsZS5qcyIsInNvdXJjZVJvb3QiOiIvc3JjLyIsInNvdXJjZXMiOlsidXRpbHMvZGVmYXVsdC1zdHlsZS5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEVBQUUsRUFBQyxhQUFhLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBQyxNQUFNLE9BQU8sQ0FBQTtBQUMvRCxPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0sY0FBYyxDQUFBO0FBQ3hDLE9BQU8sSUFBSSxNQUFNLGlDQUFpQyxDQUFBO0FBRWxELE1BQU0sbUJBQW1CLEdBQUcsYUFBYSxDQUFDO0lBQ3hDLElBQUksRUFBRSxFQUFFO0NBQ1QsQ0FBQyxDQUFBO0FBRUYsTUFBTSxlQUFlLEdBQUcsR0FBRyxFQUFFO0lBQzNCLE1BQU0sWUFBWSxHQUFHLFVBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFBO0lBRXBELE9BQU8sWUFBWSxDQUFBO0FBQ3JCLENBQUMsQ0FBQTtBQUVELE1BQU0sY0FBYyxHQUFHLENBQUMsS0FBSyxFQUFFLFdBQVcsRUFBRSxFQUFFO0lBQzVDLE1BQU0sWUFBWSxHQUFHLGVBQWUsRUFBRSxDQUFBO0lBRXRDLE1BQU0sVUFBVSxHQUFHLE9BQU8sQ0FBQyxHQUFHLEVBQUU7UUFDOUIsTUFBTSxtQkFBbUIsR0FBRyxZQUFZLENBQUMsV0FBVyxDQUFDLENBQUE7UUFDckQsSUFBSSxVQUFVLENBQUE7UUFFZCxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsRUFBRSxDQUFDO1lBQ3ZDLFVBQVUsR0FBRyxDQUFDLEdBQUcsbUJBQW1CLENBQUMsQ0FBQTtRQUN2QyxDQUFDO2FBQU0sSUFBSSxPQUFPLG1CQUFtQixJQUFJLFFBQVEsRUFBRSxDQUFDO1lBQ2xELFVBQVUsR0FBRyxDQUFDLG1CQUFtQixDQUFDLENBQUE7UUFDcEMsQ0FBQzthQUFNLENBQUM7WUFDTixNQUFNLElBQUksS0FBSyxDQUFDLDBDQUEwQyxPQUFPLG1CQUFtQixFQUFFLENBQUMsQ0FBQTtRQUN6RixDQUFDO1FBRUQsSUFBSSxLQUFLLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQ2xDLEtBQUssTUFBTSxNQUFNLElBQUksS0FBSyxFQUFFLENBQUM7Z0JBQzNCLFVBQVUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUE7WUFDekIsQ0FBQztRQUNILENBQUM7YUFBTSxJQUFJLEtBQUssRUFBRSxDQUFDO1lBQ2pCLFVBQVUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDeEIsQ0FBQztRQUVELE9BQU8sVUFBVSxDQUFBO0lBQ25CLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxXQUFXLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQTtJQUV0QyxNQUFNLHFCQUFxQixHQUFHLE9BQU8sQ0FBQyxHQUFHLEVBQUU7UUFDekMsTUFBTSxxQkFBcUIsR0FBRyxFQUFDLEdBQUcsWUFBWSxFQUFDLENBQUE7UUFFL0MscUJBQXFCLENBQUMsV0FBVyxDQUFDLEdBQUcsVUFBVSxDQUFBO1FBRS9DLE9BQU8scUJBQXFCLENBQUE7SUFDOUIsQ0FBQyxFQUFFLENBQUMsWUFBWSxFQUFFLFdBQVcsRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFBO0lBRTNDLE9BQU8sRUFBQyxlQUFlLEVBQUUscUJBQXFCLEVBQUUsVUFBVSxFQUFDLENBQUE7QUFDN0QsQ0FBQyxDQUFBO0FBRUQsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsQ0FBQyxFQUFDLFFBQVEsRUFBRSxLQUFLLEVBQUUsR0FBRyxTQUFTLEVBQUMsRUFBRSxFQUFFO0lBQ2hFLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDdEMsTUFBTSxJQUFJLEtBQUssQ0FBQyxvQkFBb0IsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFBO0lBQzFFLENBQUM7SUFFRCxNQUFNLFlBQVksR0FBRyxVQUFVLENBQUMsbUJBQW1CLENBQUMsQ0FBQTtJQUVwRCxNQUFNLGVBQWUsR0FBRyxPQUFPLENBQUMsR0FBRyxFQUFFO1FBQ25DLEtBQUssTUFBTSxHQUFHLElBQUksS0FBSyxFQUFFLENBQUM7WUFDeEIsSUFBSSxDQUFDLENBQUMsR0FBRyxJQUFJLFlBQVksQ0FBQyxFQUFFLENBQUM7Z0JBQzNCLE1BQU0sSUFBSSxLQUFLLENBQUMsK0JBQStCLEdBQUcsRUFBRSxDQUFDLENBQUE7WUFDdkQsQ0FBQztRQUNILENBQUM7UUFFRCxNQUFNLGVBQWUsR0FBRyxFQUFFLENBQUE7UUFFMUIsV0FBVyxDQUFDLGVBQWUsRUFBRSxZQUFZLEVBQUUsS0FBSyxDQUFDLENBQUE7UUFFakQsT0FBTyxlQUFlLENBQUE7SUFDeEIsQ0FBQyxFQUFFLENBQUMsWUFBWSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUE7SUFFekIsT0FBTyxDQUNMLENBQUMsbUJBQW1CLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUNuRDtNQUFBLENBQUMsUUFBUSxDQUNYO0lBQUEsRUFBRSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FDaEMsQ0FBQTtBQUNILENBQUMsQ0FBQyxDQUFBO0FBRUYsT0FBTyxFQUFDLGVBQWUsRUFBRSxjQUFjLEVBQUUsZ0JBQWdCLEVBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwge2NyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZU1lbW99IGZyb20gXCJyZWFjdFwiXG5pbXBvcnQge2luY29ycG9yYXRlfSBmcm9tIFwiaW5jb3Jwb3JhdG9yXCJcbmltcG9ydCBtZW1vIGZyb20gXCJzZXQtc3RhdGUtY29tcGFyZS9idWlsZC9tZW1vLmpzXCJcblxuY29uc3QgRGVmYXVsdFN0eWxlQ29udGV4dCA9IGNyZWF0ZUNvbnRleHQoe1xuICBUZXh0OiBbXVxufSlcblxuY29uc3QgdXNlRGVmYXVsdFN0eWxlID0gKCkgPT4ge1xuICBjb25zdCBkZWZhdWx0U3R5bGUgPSB1c2VDb250ZXh0KERlZmF1bHRTdHlsZUNvbnRleHQpXG5cbiAgcmV0dXJuIGRlZmF1bHRTdHlsZVxufVxuXG5jb25zdCB1c2VNZXJnZWRTdHlsZSA9IChzdHlsZSwgZWxlbWVudFR5cGUpID0+IHtcbiAgY29uc3QgZGVmYXVsdFN0eWxlID0gdXNlRGVmYXVsdFN0eWxlKClcblxuICBjb25zdCBzdHlsZXNMaXN0ID0gdXNlTWVtbygoKSA9PiB7XG4gICAgY29uc3QgZGVmYXVsdEVsZW1lbnRTdHlsZSA9IGRlZmF1bHRTdHlsZVtlbGVtZW50VHlwZV1cbiAgICBsZXQgc3R5bGVzTGlzdFxuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZGVmYXVsdEVsZW1lbnRTdHlsZSkpIHtcbiAgICAgIHN0eWxlc0xpc3QgPSBbLi4uZGVmYXVsdEVsZW1lbnRTdHlsZV1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZhdWx0RWxlbWVudFN0eWxlID09IFwib2JqZWN0XCIpIHtcbiAgICAgIHN0eWxlc0xpc3QgPSBbZGVmYXVsdEVsZW1lbnRTdHlsZV1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHR5cGUgZm9yIGRlZmF1bHQgZWxlbWVudCB0eXBlOiAke3R5cGVvZiBkZWZhdWx0RWxlbWVudFN0eWxlfWApXG4gICAgfVxuXG4gICAgaWYgKHN0eWxlICYmIEFycmF5LmlzQXJyYXkoc3R5bGUpKSB7XG4gICAgICBmb3IgKGNvbnN0IHN0eWxlSSBvZiBzdHlsZSkge1xuICAgICAgICBzdHlsZXNMaXN0LnB1c2goc3R5bGVJKVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoc3R5bGUpIHtcbiAgICAgIHN0eWxlc0xpc3QucHVzaChzdHlsZSlcbiAgICB9XG5cbiAgICByZXR1cm4gc3R5bGVzTGlzdFxuICB9LCBbZGVmYXVsdFN0eWxlLCBlbGVtZW50VHlwZSwgc3R5bGVdKVxuXG4gIGNvbnN0IGFjdHVhbE5ld0RlZmF1bHRTdHlsZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IGFjdHVhbE5ld0RlZmF1bHRTdHlsZSA9IHsuLi5kZWZhdWx0U3R5bGV9XG5cbiAgICBhY3R1YWxOZXdEZWZhdWx0U3R5bGVbZWxlbWVudFR5cGVdID0gc3R5bGVzTGlzdFxuXG4gICAgcmV0dXJuIGFjdHVhbE5ld0RlZmF1bHRTdHlsZVxuICB9LCBbZGVmYXVsdFN0eWxlLCBlbGVtZW50VHlwZSwgc3R5bGVzTGlzdF0pXG5cbiAgcmV0dXJuIHtuZXdEZWZhdWx0U3R5bGU6IGFjdHVhbE5ld0RlZmF1bHRTdHlsZSwgc3R5bGVzTGlzdH1cbn1cblxuY29uc3QgV2l0aERlZmF1bHRTdHlsZSA9IG1lbW8oKHtjaGlsZHJlbiwgc3R5bGUsIC4uLnJlc3RQcm9wc30pID0+IHtcbiAgaWYgKE9iamVjdC5rZXlzKHJlc3RQcm9wcykubGVuZ3RoID4gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihgVW5oYW5kbGVkIHByb3BzOiAke09iamVjdC5rZXlzKHJlc3RQcm9wcykuam9pbihcIiwgXCIpfWApXG4gIH1cblxuICBjb25zdCBkZWZhdWx0U3R5bGUgPSB1c2VDb250ZXh0KERlZmF1bHRTdHlsZUNvbnRleHQpXG5cbiAgY29uc3QgbmV3RGVmYXVsdFN0eWxlID0gdXNlTWVtbygoKSA9PiB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gc3R5bGUpIHtcbiAgICAgIGlmICghKGtleSBpbiBkZWZhdWx0U3R5bGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBlbGVtZW50IHR5cGUgZ2l2ZW46ICR7a2V5fWApXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbmV3RGVmYXVsdFN0eWxlID0ge31cblxuICAgIGluY29ycG9yYXRlKG5ld0RlZmF1bHRTdHlsZSwgZGVmYXVsdFN0eWxlLCBzdHlsZSlcblxuICAgIHJldHVybiBuZXdEZWZhdWx0U3R5bGVcbiAgfSwgW2RlZmF1bHRTdHlsZSwgc3R5bGVdKVxuXG4gIHJldHVybiAoXG4gICAgPERlZmF1bHRTdHlsZUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e25ld0RlZmF1bHRTdHlsZX0+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9EZWZhdWx0U3R5bGVDb250ZXh0LlByb3ZpZGVyPlxuICApXG59KVxuXG5leHBvcnQge3VzZURlZmF1bHRTdHlsZSwgdXNlTWVyZ2VkU3R5bGUsIFdpdGhEZWZhdWx0U3R5bGV9XG4iXX0=