artifact_dirs:
  - ruby-gem/spec/dummy/tmp/screenshots
before_script:
  - cd ruby-gem && bundle install --jobs 4 --without production staging && bundle exec appraisal install && bundle exec appraisal bundle

  - cd npm-api-maker && yarn install --network-timeout 120000
  - cd npm-api-maker && yarn link

  - cd npm-api-maker-inputs && yarn install --network-timeout 120000
  - cd npm-api-maker-inputs && yarn link @kaspernj/api-maker
  - cd npm-api-maker-inputs && yarn link

  - cd npm-api-maker-bootstrap && yarn install --network-timeout 120000
  - cd npm-api-maker-bootstrap && yarn link @kaspernj/api-maker
  - cd npm-api-maker-bootstrap && yarn link @kaspernj/api-maker-inputs
  - cd npm-api-maker-bootstrap && yarn link

  - cd api_maker_table_npm && yarn install --network-timeout 120000
  - cd api_maker_table_npm && yarn link @kaspernj/api-maker
  - cd api_maker_table_npm && yarn link @kaspernj/api-maker-bootstrap
  - cd api_maker_table_npm && yarn link @kaspernj/api-maker-inputs
  - cd api_maker_table_npm && yarn link

  - cd ruby-gem/spec/dummy && yarn install --network-timeout 120000
  - cd ruby-gem/spec/dummy && yarn link @kaspernj/api-maker
  - cd ruby-gem/spec/dummy && yarn link @kaspernj/api-maker-bootstrap
  - cd ruby-gem/spec/dummy && yarn link @kaspernj/api-maker-inputs
  - cd ruby-gem/spec/dummy && yarn link @kaspernj/api-maker-table
  - cd ruby-gem/spec/dummy && yarn
  - cd ruby-gem/spec/dummy && bundle exec rails db:environment:set RAILS_ENV=test
  - cd ruby-gem/spec/dummy && bundle exec rails db:schema:load
  - cd ruby-gem/spec/dummy && rake api_maker:generate_models

  - cd ruby-gem/spec/dummy && bundle exec RAILS_ENV=development rails db:schema:load
  - cd ruby-gem/spec/dummy && RAILS_ENV=development bin/webpacker
rvm: true
builds:
  build_1:
    environment:
      RUBY_VERSION: 2.7.6
    name: RSpec Kaminari Ruby 2.7.6
    script:
      - cd ruby-gem && bundle exec appraisal kaminari rspec --format documentation spec/api_maker spec/services
  build_2:
    environment:
      RUBY_VERSION: 3.0.4
    name: RSpec Kaminari Ruby 3.0.4
    script:
      - cd ruby-gem && bundle exec appraisal kaminari rspec --format documentation spec/api_maker spec/services
  build_3:
    environment:
      RUBY_VERSION: 3.1.2
    name: RSpec Kaminari Ruby 3.1.2
    script:
      - cd ruby-gem && bundle exec appraisal kaminari rspec --format documentation spec/api_maker spec/services
  build_4:
    environment:
      RUBY_VERSION: 2.7.6
    name: RSpec WillPaginate Ruby 2.7.6
    script:
      - cd ruby-gem && bundle exec appraisal will_paginate rspec --format documentation spec/api_maker spec/services
  build_5:
    environment:
      RUBY_VERSION: 3.0.4
    name: RSpec WillPaginate Ruby 3.0.4
    script:
      - cd ruby-gem && bundle exec appraisal will_paginate rspec --format documentation spec/api_maker spec/services
  build_6:
    environment:
      RUBY_VERSION: 3.1.2
    name: RSpec WillPaginate Ruby 3.1.2
    script:
      - cd ruby-gem && bundle exec appraisal will_paginate rspec --format documentation spec/api_maker spec/services
  build_7:
    environment:
      RUBY_VERSION: 2.7.6
    name: Chrome Kaminari Ruby 2.7.6
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal kaminari rspec --format documentation spec/system
  build_8:
    environment:
      RUBY_VERSION: 3.0.4
    name: Chrome Kaminari Ruby 3.0.4
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal kaminari rspec --format documentation spec/system
  build_9:
    environment:
      RUBY_VERSION: 3.1.2
    name: Chrome Kaminari Ruby 3.1.2
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal kaminari rspec --format documentation spec/system
  build_10:
    environment:
      RUBY_VERSION: 2.7.6
    name: Chrome WillPaginate Ruby 2.7.6
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal will_paginate rspec --format documentation spec/system
  build_11:
    environment:
      RUBY_VERSION: 3.0.4
    name: Chrome WillPaginate Ruby 3.0.4
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal will_paginate rspec --format documentation spec/system
  build_12:
    environment:
      RUBY_VERSION: 3.1.2
    name: Chrome WillPaginate Ruby 3.1.2
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal will_paginate rspec --format documentation spec/system
  build_13:
    name: Firefox Kaminari Ruby 2.7.6
    environment:
      RUBY_VERSION: 2.7.6
      SELENIUM_DRIVER: firefox
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal kaminari rspec --format documentation spec/system
  build_14:
    name: Firefox Kaminari Ruby 3.0.4
    environment:
      RUBY_VERSION: 3.0.4
      SELENIUM_DRIVER: firefox
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal kaminari rspec --format documentation spec/system
  build_15:
    name: Firefox Kaminari Ruby 3.1.2
    environment:
      RUBY_VERSION: 3.1.2
      SELENIUM_DRIVER: firefox
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal kaminari rspec --format documentation spec/system
  build_16:
    name: Firefox WillPaginate Ruby 2.7.6
    environment:
      RUBY_VERSION: 2.7.6
      SELENIUM_DRIVER: firefox
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal will_paginate rspec --format documentation spec/system
  build_17:
    name: Firefox WillPaginate Ruby 3.0.4
    environment:
      RUBY_VERSION: 3.0.4
      SELENIUM_DRIVER: firefox
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal will_paginate rspec --format documentation spec/system
  build_18:
    name: Firefox WillPaginate Ruby 3.1.2
    environment:
      RUBY_VERSION: 3.1.2
      SELENIUM_DRIVER: firefox
    script:
      - cd ruby-gem/spec/dummy && bin/webpacker
      - cd ruby-gem && xvfb-run bundle exec appraisal will_paginate rspec --format documentation spec/system
  build_19:
    name: NPM API maker Jest
    script:
      - cd npm-api-maker && yarn test
  build_20:
    name: Rubocop
    script:
      - cd ruby-gem && bundle exec rubocop
  build_21:
    name: Rails Best Practices
    script:
      - cd ruby-gem && bundle exec rails_best_practices
  build_22:
    name: API maker ESLint
    script:
      - cd npm-api-maker && yarn eslint .
  build_23:
    name: API maker ESLint find rules
    script:
      - cd npm-api-maker && yarn eslint-find-rules -u .eslintrc.js
  build_24:
    name: API maker Bootstrap ESLint
    script:
      - cd npm-api-maker-bootstrap && yarn eslint .
  build_25:
    name: API maker Bootstrap ESLint find rules
    script:
      - cd npm-api-maker-bootstrap && yarn eslint-find-rules -u .eslintrc.js
  build_26:
    name: API maker Inputs ESLint
    script:
      - cd npm-api-maker-inputs && yarn eslint .
  build_27:
    name: API maker Inputs ESLint find rules
    script:
      - cd npm-api-maker-inputs && yarn eslint-find-rules -u .eslintrc.js
