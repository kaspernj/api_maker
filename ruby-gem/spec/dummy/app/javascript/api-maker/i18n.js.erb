/* rails-erb-loader-dependencies ../config/locales/ */

import {digg} from "@kaspernj/object-digger"
import I18n from "i18n-js"

const locale = document.querySelector("html").getAttribute("lang")

I18n.fallbacks = true
I18n.locale = locale

if (digg(window, "RAILS_ENV") == "development") {
  I18n.missingTranslation = function(key) {
    console.error(`No translation for: ${key}`)

    return `translation missing: ${key}`
  }
} else if (digg(window, "RAILS_ENV") == "test") {
  I18n.missingTranslation = function(key) {
    throw new Error(`translation missing: ${key}`)
  }
}

I18n.translations = <%= I18n::JS.filtered_translations.to_json %>

export default I18n
