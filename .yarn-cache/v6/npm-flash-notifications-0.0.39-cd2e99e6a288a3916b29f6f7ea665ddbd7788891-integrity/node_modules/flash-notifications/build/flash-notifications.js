// @ts-check
import { digg } from "diggerize";
import configuration from "./configuration.js";
import events from "./events.js";
export default class FlashNotifications {
    /**
     * @param {string} message
     * @returns {void}
     */
    static alert(message) {
        FlashNotifications.show({ type: "alert", text: message });
    }
    /**
     * @param {string} message
     * @returns {void}
     */
    static error(message) {
        FlashNotifications.show({ type: "error", text: message });
    }
    /**
     * @param {Error} error
     * @returns {void}
     */
    static errorResponse(error) {
        // @ts-expect-error
        if (error.apiMakerType == "ValidationError") {
            // @ts-expect-error
            if (error.hasUnhandledErrors()) {
                // @ts-expect-error
                const unhandledErrorMessages = error.getUnhandledErrors().map((subError) => subError.getFullErrorMessages()).flat();
                FlashNotifications.error(unhandledErrorMessages.join(". "));
            }
            else {
                const defaultValue = "Couldn't submit because of validation errors.";
                FlashNotifications.alert(configuration.translate("js.notification.couldnt_submit_because_of_validation_errors", { defaultValue }));
            }
            // @ts-expect-error
        }
        else if (error.apiMakerType == "BaseError") {
            // @ts-expect-error
            if (error.args.response && error.args.response.errors) {
                const errors = /** @type {Array<string | {message: string}[]>} */ (digg(error, "args", "response", "errors"));
                const errorMessages = errors.map((error) => {
                    if (typeof error == "string") {
                        return error;
                    }
                    return digg(error, "message");
                });
                FlashNotifications.error(errorMessages.join(". "));
            }
            else {
                throw error;
            }
        }
        else {
            console.error(`Didnt know what to do with that ${error.constructor.name}: ${error.message}`);
            throw error;
        }
    }
    /**
     * @param {string} message
     * @returns {void}
     */
    static success(message) {
        FlashNotifications.show({ type: "success", text: message });
    }
    /**
     * @param {object} args
     * @param {string} args.text
     * @param {string} args.type
     * @returns {void}
     */
    static show(args) {
        let title;
        if (args.type == "alert") {
            title = configuration.translate("js.shared.alert", { defaultValue: "Alert" });
        }
        else if (args.type == "error") {
            title = configuration.translate("js.shared.error", { defaultValue: "Error" });
        }
        else if (args.type == "success") {
            title = configuration.translate("js.shared.success", { defaultValue: "Success" });
        }
        else {
            title = configuration.translate("js.shared.notification", { defaultValue: "Notification" });
        }
        events.emit("pushNotification", {
            message: args.text,
            title,
            type: args.type
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmxhc2gtbm90aWZpY2F0aW9ucy5qcyIsInNvdXJjZVJvb3QiOiIvc3JjLyIsInNvdXJjZXMiOlsiZmxhc2gtbm90aWZpY2F0aW9ucy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFZO0FBRVosT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLFdBQVcsQ0FBQTtBQUU5QixPQUFPLGFBQWEsTUFBTSxvQkFBb0IsQ0FBQTtBQUM5QyxPQUFPLE1BQU0sTUFBTSxhQUFhLENBQUE7QUFFaEMsTUFBTSxDQUFDLE9BQU8sT0FBTyxrQkFBa0I7SUFDckM7OztPQUdHO0lBQ0gsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPO1FBQ2xCLGtCQUFrQixDQUFDLElBQUksQ0FBQyxFQUFDLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUE7SUFDekQsQ0FBQztJQUVEOzs7T0FHRztJQUNILE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTztRQUNsQixrQkFBa0IsQ0FBQyxJQUFJLENBQUMsRUFBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUMsQ0FBQyxDQUFBO0lBQ3pELENBQUM7SUFFRDs7O09BR0c7SUFDSCxNQUFNLENBQUMsYUFBYSxDQUFDLEtBQUs7UUFDeEIsbUJBQW1CO1FBQ25CLElBQUksS0FBSyxDQUFDLFlBQVksSUFBSSxpQkFBaUIsRUFBRSxDQUFDO1lBQzVDLG1CQUFtQjtZQUNuQixJQUFJLEtBQUssQ0FBQyxrQkFBa0IsRUFBRSxFQUFFLENBQUM7Z0JBQy9CLG1CQUFtQjtnQkFDbkIsTUFBTSxzQkFBc0IsR0FBRyxLQUFLLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUE7Z0JBRW5ILGtCQUFrQixDQUFDLEtBQUssQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQTtZQUM3RCxDQUFDO2lCQUFNLENBQUM7Z0JBQ04sTUFBTSxZQUFZLEdBQUcsK0NBQStDLENBQUE7Z0JBRXBFLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLDZEQUE2RCxFQUFFLEVBQUMsWUFBWSxFQUFDLENBQUMsQ0FBQyxDQUFBO1lBQ2xJLENBQUM7WUFDSCxtQkFBbUI7UUFDbkIsQ0FBQzthQUFNLElBQUksS0FBSyxDQUFDLFlBQVksSUFBSSxXQUFXLEVBQUUsQ0FBQztZQUM3QyxtQkFBbUI7WUFDbkIsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQztnQkFDdEQsTUFBTSxNQUFNLEdBQUcsa0RBQWtELENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQTtnQkFDN0csTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFO29CQUN6QyxJQUFJLE9BQU8sS0FBSyxJQUFJLFFBQVEsRUFBRSxDQUFDO3dCQUM3QixPQUFPLEtBQUssQ0FBQTtvQkFDZCxDQUFDO29CQUVELE9BQU8sSUFBSSxDQUFDLEtBQUssRUFBRSxTQUFTLENBQUMsQ0FBQTtnQkFDL0IsQ0FBQyxDQUFDLENBQUE7Z0JBRUYsa0JBQWtCLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQTtZQUNwRCxDQUFDO2lCQUFNLENBQUM7Z0JBQ04sTUFBTSxLQUFLLENBQUE7WUFDYixDQUFDO1FBQ0gsQ0FBQzthQUFNLENBQUM7WUFDTixPQUFPLENBQUMsS0FBSyxDQUFDLG1DQUFtQyxLQUFLLENBQUMsV0FBVyxDQUFDLElBQUksS0FBSyxLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQTtZQUM1RixNQUFNLEtBQUssQ0FBQTtRQUNiLENBQUM7SUFDSCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPO1FBQ3BCLGtCQUFrQixDQUFDLElBQUksQ0FBQyxFQUFDLElBQUksRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUE7SUFDM0QsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJO1FBQ2QsSUFBSSxLQUFLLENBQUE7UUFFVCxJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksT0FBTyxFQUFFLENBQUM7WUFDekIsS0FBSyxHQUFHLGFBQWEsQ0FBQyxTQUFTLENBQUMsaUJBQWlCLEVBQUUsRUFBQyxZQUFZLEVBQUUsT0FBTyxFQUFDLENBQUMsQ0FBQTtRQUM3RSxDQUFDO2FBQU0sSUFBSSxJQUFJLENBQUMsSUFBSSxJQUFJLE9BQU8sRUFBRSxDQUFDO1lBQ2hDLEtBQUssR0FBRyxhQUFhLENBQUMsU0FBUyxDQUFDLGlCQUFpQixFQUFFLEVBQUMsWUFBWSxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUE7UUFDN0UsQ0FBQzthQUFNLElBQUksSUFBSSxDQUFDLElBQUksSUFBSSxTQUFTLEVBQUUsQ0FBQztZQUNsQyxLQUFLLEdBQUcsYUFBYSxDQUFDLFNBQVMsQ0FBQyxtQkFBbUIsRUFBRSxFQUFDLFlBQVksRUFBRSxTQUFTLEVBQUMsQ0FBQyxDQUFBO1FBQ2pGLENBQUM7YUFBTSxDQUFDO1lBQ04sS0FBSyxHQUFHLGFBQWEsQ0FBQyxTQUFTLENBQUMsd0JBQXdCLEVBQUUsRUFBQyxZQUFZLEVBQUUsY0FBYyxFQUFDLENBQUMsQ0FBQTtRQUMzRixDQUFDO1FBRUQsTUFBTSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsRUFBRTtZQUM5QixPQUFPLEVBQUUsSUFBSSxDQUFDLElBQUk7WUFDbEIsS0FBSztZQUNMLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTtTQUNoQixDQUFDLENBQUE7SUFDSixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAdHMtY2hlY2tcblxuaW1wb3J0IHtkaWdnfSBmcm9tIFwiZGlnZ2VyaXplXCJcblxuaW1wb3J0IGNvbmZpZ3VyYXRpb24gZnJvbSBcIi4vY29uZmlndXJhdGlvbi5qc1wiXG5pbXBvcnQgZXZlbnRzIGZyb20gXCIuL2V2ZW50cy5qc1wiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZsYXNoTm90aWZpY2F0aW9ucyB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZVxuICAgKiBAcmV0dXJucyB7dm9pZH1cbiAgICovXG4gIHN0YXRpYyBhbGVydChtZXNzYWdlKSB7XG4gICAgRmxhc2hOb3RpZmljYXRpb25zLnNob3coe3R5cGU6IFwiYWxlcnRcIiwgdGV4dDogbWVzc2FnZX0pXG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBzdGF0aWMgZXJyb3IobWVzc2FnZSkge1xuICAgIEZsYXNoTm90aWZpY2F0aW9ucy5zaG93KHt0eXBlOiBcImVycm9yXCIsIHRleHQ6IG1lc3NhZ2V9KVxuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7RXJyb3J9IGVycm9yXG4gICAqIEByZXR1cm5zIHt2b2lkfVxuICAgKi9cbiAgc3RhdGljIGVycm9yUmVzcG9uc2UoZXJyb3IpIHtcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgaWYgKGVycm9yLmFwaU1ha2VyVHlwZSA9PSBcIlZhbGlkYXRpb25FcnJvclwiKSB7XG4gICAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgICBpZiAoZXJyb3IuaGFzVW5oYW5kbGVkRXJyb3JzKCkpIHtcbiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgICAgICBjb25zdCB1bmhhbmRsZWRFcnJvck1lc3NhZ2VzID0gZXJyb3IuZ2V0VW5oYW5kbGVkRXJyb3JzKCkubWFwKChzdWJFcnJvcikgPT4gc3ViRXJyb3IuZ2V0RnVsbEVycm9yTWVzc2FnZXMoKSkuZmxhdCgpXG5cbiAgICAgICAgRmxhc2hOb3RpZmljYXRpb25zLmVycm9yKHVuaGFuZGxlZEVycm9yTWVzc2FnZXMuam9pbihcIi4gXCIpKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdFZhbHVlID0gXCJDb3VsZG4ndCBzdWJtaXQgYmVjYXVzZSBvZiB2YWxpZGF0aW9uIGVycm9ycy5cIlxuXG4gICAgICAgIEZsYXNoTm90aWZpY2F0aW9ucy5hbGVydChjb25maWd1cmF0aW9uLnRyYW5zbGF0ZShcImpzLm5vdGlmaWNhdGlvbi5jb3VsZG50X3N1Ym1pdF9iZWNhdXNlX29mX3ZhbGlkYXRpb25fZXJyb3JzXCIsIHtkZWZhdWx0VmFsdWV9KSlcbiAgICAgIH1cbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgfSBlbHNlIGlmIChlcnJvci5hcGlNYWtlclR5cGUgPT0gXCJCYXNlRXJyb3JcIikge1xuICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgICAgaWYgKGVycm9yLmFyZ3MucmVzcG9uc2UgJiYgZXJyb3IuYXJncy5yZXNwb25zZS5lcnJvcnMpIHtcbiAgICAgICAgY29uc3QgZXJyb3JzID0gLyoqIEB0eXBlIHtBcnJheTxzdHJpbmcgfCB7bWVzc2FnZTogc3RyaW5nfVtdPn0gKi8gKGRpZ2coZXJyb3IsIFwiYXJnc1wiLCBcInJlc3BvbnNlXCIsIFwiZXJyb3JzXCIpKVxuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VzID0gZXJyb3JzLm1hcCgoZXJyb3IpID0+IHtcbiAgICAgICAgICBpZiAodHlwZW9mIGVycm9yID09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlcnJvclxuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBkaWdnKGVycm9yLCBcIm1lc3NhZ2VcIilcbiAgICAgICAgfSlcblxuICAgICAgICBGbGFzaE5vdGlmaWNhdGlvbnMuZXJyb3IoZXJyb3JNZXNzYWdlcy5qb2luKFwiLiBcIikpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBlcnJvclxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBEaWRudCBrbm93IHdoYXQgdG8gZG8gd2l0aCB0aGF0ICR7ZXJyb3IuY29uc3RydWN0b3IubmFtZX06ICR7ZXJyb3IubWVzc2FnZX1gKVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBzdGF0aWMgc3VjY2VzcyhtZXNzYWdlKSB7XG4gICAgRmxhc2hOb3RpZmljYXRpb25zLnNob3coe3R5cGU6IFwic3VjY2Vzc1wiLCB0ZXh0OiBtZXNzYWdlfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge29iamVjdH0gYXJnc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gYXJncy50ZXh0XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhcmdzLnR5cGVcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBzdGF0aWMgc2hvdyhhcmdzKSB7XG4gICAgbGV0IHRpdGxlXG5cbiAgICBpZiAoYXJncy50eXBlID09IFwiYWxlcnRcIikge1xuICAgICAgdGl0bGUgPSBjb25maWd1cmF0aW9uLnRyYW5zbGF0ZShcImpzLnNoYXJlZC5hbGVydFwiLCB7ZGVmYXVsdFZhbHVlOiBcIkFsZXJ0XCJ9KVxuICAgIH0gZWxzZSBpZiAoYXJncy50eXBlID09IFwiZXJyb3JcIikge1xuICAgICAgdGl0bGUgPSBjb25maWd1cmF0aW9uLnRyYW5zbGF0ZShcImpzLnNoYXJlZC5lcnJvclwiLCB7ZGVmYXVsdFZhbHVlOiBcIkVycm9yXCJ9KVxuICAgIH0gZWxzZSBpZiAoYXJncy50eXBlID09IFwic3VjY2Vzc1wiKSB7XG4gICAgICB0aXRsZSA9IGNvbmZpZ3VyYXRpb24udHJhbnNsYXRlKFwianMuc2hhcmVkLnN1Y2Nlc3NcIiwge2RlZmF1bHRWYWx1ZTogXCJTdWNjZXNzXCJ9KVxuICAgIH0gZWxzZSB7XG4gICAgICB0aXRsZSA9IGNvbmZpZ3VyYXRpb24udHJhbnNsYXRlKFwianMuc2hhcmVkLm5vdGlmaWNhdGlvblwiLCB7ZGVmYXVsdFZhbHVlOiBcIk5vdGlmaWNhdGlvblwifSlcbiAgICB9XG5cbiAgICBldmVudHMuZW1pdChcInB1c2hOb3RpZmljYXRpb25cIiwge1xuICAgICAgbWVzc2FnZTogYXJncy50ZXh0LFxuICAgICAgdGl0bGUsXG4gICAgICB0eXBlOiBhcmdzLnR5cGVcbiAgICB9KVxuICB9XG59XG4iXX0=