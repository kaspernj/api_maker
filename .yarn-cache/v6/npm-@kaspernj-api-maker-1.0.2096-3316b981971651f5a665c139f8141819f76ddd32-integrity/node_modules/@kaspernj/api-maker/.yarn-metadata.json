{
  "manifest": {
    "name": "@kaspernj/api-maker",
    "type": "module",
    "version": "1.0.2096",
    "description": "My new module",
    "files": [
      "build/**"
    ],
    "types": "build/index.d.ts",
    "main": "build/index.js",
    "scripts": {
      "build": "rm -rf build && tsc || true",
      "clean": "expo-module clean",
      "lint": "expo-module lint",
      "test": "NODE_OPTIONS=--experimental-vm-modules expo-module test",
      "prepare": "npm run clean && npm run build",
      "prepublishOnly": "expo-module prepublishOnly && npm run build",
      "open:ios": "xed example/ios",
      "open:android": "open -a \"Android Studio\" example/android",
      "lint:eslint": "eslint --ext .js,.jsx",
      "release:patch": "node scripts/release-patch.js",
      "release:patch-master": "node scripts/release-patch.js --require-master",
      "typecheck": "tsc --noEmit",
      "typecheck:file": "sh -c 'file=\"${npm_config_file:-${FILE:-}}\"; if [ -z \"$file\" ] && [ \"${0#--file=}\" != \"$0\" ]; then file=\"${0#--file=}\"; fi; if [ -z \"$file\" ] && [ \"${1#--file=}\" != \"$1\" ]; then file=\"${1#--file=}\"; fi; file=\"${file#npm-api-maker/}\"; file=\"${file#./}\"; if [ -z \"$file\" ]; then echo \"Missing --file=src/path/to/file.js\"; exit 2; fi; tmp=$(mktemp); tsc --noEmit -p tsconfig.json --pretty false >\"$tmp\" 2>&1; if rg --fixed-strings \"$file\" \"$tmp\" >/dev/null; then rg --fixed-strings \"$file\" \"$tmp\"; rm -f \"$tmp\"; exit 1; else rm -f \"$tmp\"; exit 0; fi'",
      "watch": "tsc -w"
    },
    "keywords": [
      "react-native",
      "expo",
      "api-maker",
      "ApiMaker"
    ],
    "repository": {
      "type": "git",
      "url": "git+https://github.com/kaspernj/api_maker.git"
    },
    "bugs": {
      "url": "https://github.com/kaspernj/api_maker/issues"
    },
    "author": {
      "name": "kaspernj",
      "email": "kasper@diestoeckels.de",
      "url": "github.com/kaspernj"
    },
    "license": "MIT",
    "homepage": "https://github.com/kaspernj/api_maker#readme",
    "dependencies": {
      "clone-deep": ">= 4.0.1",
      "debounce": ">= 2.0.0",
      "diggerize": ">= 1.0.10",
      "env-sense": ">= 1.0.2",
      "epic-locks": ">= 1.0.6",
      "eventemitter3": "^5.0.1",
      "file-saver": "^2.0.5",
      "form-data-objectizer": ">= 1.0.0",
      "form-serialize": ">= 0.7.2",
      "format-number": ">= 3.0.0",
      "incorporator": ">= 1.0.5",
      "inflection": ">= 1.12.0",
      "js-money": ">= 0.6.3",
      "numberable": ">= 1.0.0",
      "object-to-formdata": ">= 4.1.0",
      "on-location-changed": ">= 1.0.18",
      "qs": ">= 6.9.3",
      "replaceall": ">= 0.1.6",
      "responsive-breakpoints": ">= 0.1.3",
      "set-state-compare": ">= 1.0.69",
      "spark-md5": "^3.0.2",
      "stacktrace-parser": "^0.1.10",
      "strftime": ">= 0.10.0",
      "uniqunize": "^1.0.3",
      "url-parse": "^1.5.10",
      "wake-event": ">= 0.0.1",
      "ya-use-event-emitter": "^0.1.2",
      "ya-use-event-listener": ">= 0.1.1"
    },
    "devDependencies": {
      "@babel/eslint-parser": "^7.16.3",
      "@babel/preset-env": "^7.12.11",
      "@babel/preset-react": "^7.26.3",
      "@jest/globals": "~30.2.0",
      "@types/react": "~19.0.10",
      "babel-jest": "~30.2.0",
      "eslint": "^9.23.0",
      "eslint-config-expo": "~9.2.0",
      "eslint-plugin-jest": "^29.0.1",
      "eslint-plugin-jsdoc": "^62.0.0",
      "eslint-plugin-react": "^7.23.2",
      "expo": "~53.0.26",
      "expo-module-scripts": "^5.0.8",
      "jest": "~29.7.0",
      "react": "19.0.0",
      "react-native": "0.79.6",
      "typescript": "~5.8.3",
      "velocious": "^1.0.175"
    },
    "peerDependencies": {
      "expo": "*",
      "flash-notifications": ">= 0.0.33",
      "history": "^5.3.0",
      "i18n-on-steroids": ">= 1.0.21",
      "react": ">=18.3.0",
      "react-native": "*",
      "react-native-vector-icons": "*"
    },
    "resolutions": {
      "@expo/config-plugins": "~10.1.1",
      "@expo/metro-config": "~0.20.18",
      "metro": "^0.82.0",
      "metro-config": "^0.82.0",
      "metro-resolver": "^0.82.0"
    },
    "overrides": {
      "@expo/config-plugins": "~10.1.1",
      "@expo/metro-config": "~0.20.18",
      "metro": "^0.82.0",
      "metro-config": "^0.82.0",
      "metro-resolver": "^0.82.0"
    },
    "packageManager": "yarn@1.22.22+sha512.a6b2f7906b721bba3d67d4aff083df04dad64c399707841b7acf00f6b133b7ac24255f2652fa22ae3534329dc6180534e98d17432037ff6fd140556e2bb3137e",
    "_registry": "npm",
    "_loc": "/home/dev/api_maker/.yarn-cache/v6/npm-@kaspernj-api-maker-1.0.2096-3316b981971651f5a665c139f8141819f76ddd32-integrity/node_modules/@kaspernj/api-maker/package.json",
    "readmeFilename": "README.md",
    "readme": "# @kaspernj/api-maker\n\nClient-side library for ApiMaker-powered Rails APIs. It provides model classes, collections, and UI helpers for web and React Native apps, backed by the JSON payloads generated by the ApiMaker server gem.\n\n## Installation\n\n```bash\nnpm install @kaspernj/api-maker\n```\n\n## Quick start\n\nApiMaker models are generated from `model-recipes.json` (usually emitted by the Rails gem). Import the models and set up the shared config before making requests.\n\n```js\nimport config from \"@kaspernj/api-maker/build/config\"\nimport Models from \"@kaspernj/api-maker/build/models\"\nimport history from \"./history\"\nimport routes from \"./routes\"\n\nconst {Account, Project, User} = Models\n\nconfig.setHistory(history)\nconfig.setLinkTo((path) => history.push(path))\nconfig.setNavigation({\n  navigate: (routeName, params) => history.push(routes[routeName](params))\n})\nconfig.setRoutes(routes)\nconfig.setCurrenciesCollection([\n  [\"US Dollar\", \"usd\"],\n  [\"Euro\", \"eur\"]\n])\n\nconst users = await User.ransack({name_cont: \"sam\"}).per(20).toArray()\nconst user = await User.find(\"a0f3842b-1e4c-4e9d-8f2d-cd021e5a9b6a\")\n```\n\n## Models and collections\n\nModels are generated from the server recipes and inherit `BaseModel`. Collections let you compose queries fluently and then execute them with `toArray()`.\n\n```js\nconst activeProjects = await Project\n  .ransack({state_eq: \"active\"})\n  .preload([\"owner\"])\n  .sort(\"created_at desc\")\n  .toArray()\n\nconst firstProject = await Project.ransack({name_cont: \"api\"}).first()\nconst totalCount = await Project.ransack().count()\n```\n\n## Relationship loading and preloading\n\nRelationship accessors are generated from the recipe. For a relationship named `account`, you get:\n\n- `user.account()` to read a cached relationship.\n- `user.loadAccount()` to fetch it from the API.\n\nReading a relationship before it is loaded raises `NotLoadedError` unless the model is new.\n\n### Requesting preloads from the server\n\nUse `preload` on a collection to have the server include related records in the response. ApiMaker stores those models in the relationship cache automatically.\n\n```js\nconst users = await User\n  .ransack()\n  .preload([\"account\", \"roles\"])\n  .toArray()\n\nusers[0].account()\n```\n\n### Manually preloading with `preloadRelationship`\n\nWhen you already have related model instances (for example after creating records or from another response), you can mark a relationship as loaded without another request.\n\n```js\nconst user = await User.find(\"a0f3842b-1e4c-4e9d-8f2d-cd021e5a9b6a\")\nconst account = await Account.find(\"f6c0b2b3-0a37-4e6e-ae3a-2e6a38e3953d\")\n\nuser.preloadRelationship(\"account\", account)\nuser.account()\n```\n\n`preloadRelationship` accepts:\n\n- A single model (for `belongs_to` / `has_one` relationships).\n- An array of models (for `has_many` relationships).\n- `null` when the relationship is known to be empty.\n\nThe relationship name is stored in `snake_case`, so `preloadRelationship(\"Account\", account)` and `preloadRelationship(\"account\", account)` are equivalent. After preloading, both `account()` and `loadAccount()` return the cached value without hitting the network.\n\n## Configuration notes\n\n`config` is a shared singleton. Some helpers (forms, routing, navigation, and money inputs) require config values like `history`, `linkTo`, `navigation`, and `currenciesCollection` to be set. If a required value is missing, the getter throws an error to avoid silent failures.\n\n## API reference\n\nApiMaker generates model classes from your recipes. The classes inherit `BaseModel` and expose relationship helpers based on your server-side associations.\n\n### Relationship helpers (generated)\n\nFor a relationship named `account`, the model class gets:\n\n- `user.account()` to read the cached relationship.\n- `user.loadAccount()` to fetch it from the API.\n\nFor `has_many`, the getter returns a `Collection` for that relationship:\n\n```js\nconst user = await User.find(\"a0f3842b-1e4c-4e9d-8f2d-cd021e5a9b6a\")\n\nconst tasksCollection = user.tasks()\nconst tasks = await tasksCollection.toArray()\n```\n\n### BaseModel static methods\n\n- `attributes()`: Returns attribute metadata for the model. Example: `User.attributes()`\n- `hasAttribute(attributeName)`: Checks if the attribute exists on the model. Example: `User.hasAttribute(\"email\")`\n- `modelClassData()`: Returns recipe data for the model class. Example: `User.modelClassData()`\n- `newCustomEvent(validationErrors)`: Creates a validation-errors event. Example: `BaseModel.newCustomEvent(errors)`\n- `sendValidationErrorsEvent(validationErrors, options)`: Dispatches the validation error event to a form. Example: `BaseModel.sendValidationErrorsEvent(errors, {form})`\n- `find(id)`: Loads a record by primary key. Example: `User.find(\"a0f3842b-1e4c-4e9d-8f2d-cd021e5a9b6a\")`\n- `findOrCreateBy(findOrCreateByArgs, args)`: Find or create a record server-side. Example: `User.findOrCreateBy({email: \"sam@example.com\"}, {additionalData: {invite: true}})`\n- `modelName()`: Returns a `ModelName` helper for inflection. Example: `User.modelName().human()`\n- `primaryKey()`: Returns the primary key column name. Example: `User.primaryKey()`\n- `ransack(query)`: Starts a collection query. Example: `User.ransack({email_cont: \"@example.com\"})`\n- `select(select)`: Adds a `select` clause to a new query. Example: `User.select({users: [\"id\", \"email\"]})`\n- `ransackableAssociations()`: Returns associations that are searchable. Example: `User.ransackableAssociations()`\n- `ransackableAttributes()`: Returns attributes that are searchable. Example: `User.ransackableAttributes()`\n- `ransackableScopes()`: Returns scopes that are searchable. Example: `User.ransackableScopes()`\n- `reflections()`: Returns relationship metadata. Example: `User.reflections()`\n- `reflection(name)`: Looks up a relationship by name. Example: `User.reflection(\"account\")`\n- `_token()`: Reads the CSRF token from the page. Example: `BaseModel._token()`\n- `all()`: Alias for `ransack()`. Example: `User.all().toArray()`\n- `parseValidationErrors({error, model, options})`: Converts server validation errors to `ValidationErrors`. Example: `BaseModel.parseValidationErrors({error, model: user, options: {form}})`\n- `humanAttributeName(attributeName)`: Returns a translated attribute name. Example: `User.humanAttributeName(\"email\")`\n- `snakeCase(string)`: Underscores a string. Example: `BaseModel.snakeCase(\"AccountOwner\")`\n- `_objectDataFromGivenRawData(rawData, options)`: Normalizes form data or objects. Example: `BaseModel._objectDataFromGivenRawData(form, {})`\n- `_callCollectionCommand(args, commandArgs)`: Executes a command and parses validation errors. Example: `BaseModel._callCollectionCommand({args: {save: payload}}, {})`\n- `_postDataFromArgs(args)`: Serializes args for a command request. Example: `BaseModel._postDataFromArgs({save: payload})`\n\n### BaseModel instance methods\n\n- `constructor(args)`: Creates a model instance. Example: `const user = new User({id: \"123\"})`\n- `modelClass()`: Returns the model class. Example: `user.modelClass().modelName().name`\n- `modelClassData()`: Returns the recipe data for the model. Example: `user.modelClassData().name`\n- `primaryKey()`: Reads the primary key value. Example: `user.primaryKey()`\n- `identifierKey()`: Returns a stable key for UI lists. Example: `user.identifierKey()`\n- `uniqueKey()`: Generates a random unique key. Example: `user.uniqueKey()`\n- `cacheKey()`: Returns cache key based on id and updated_at. Example: `user.cacheKey()`\n- `localCacheKey()`: Returns a local cache key. Example: `user.localCacheKey()`\n- `fullCacheKey()`: Returns a full cache key. Example: `user.fullCacheKey()`\n- `clone()`: Returns a shallow clone of the model. Example: `const clone = user.clone()`\n- `attributes()`: Returns merged attributes and changes. Example: `user.attributes()`\n- `getAttributes()`: Returns attributes merged with changes. Example: `user.getAttributes()`\n- `assignAttributes(newAttributes)`: Assigns changes and tracks diffs. Example: `user.assignAttributes({email: \"sam@example.com\"})`\n- `readAttribute(attributeName)`: Reads a camelCase or snake_case attribute. Example: `user.readAttribute(\"email\")`\n- `readAttributeUnderscore(attributeName)`: Reads a snake_case attribute. Example: `user.readAttributeUnderscore(\"email\")`\n- `isAttributeLoaded(attributeName)`: Checks if an attribute is loaded. Example: `user.isAttributeLoaded(\"email\")`\n- `isAttributeChanged(attributeName)`: Checks if an attribute changed. Example: `user.isAttributeChanged(\"email\")`\n- `savedChangeToAttribute(attributeName)`: Checks if an attribute changed in the last save. Example: `user.savedChangeToAttribute(\"email\")`\n- `isChanged()`: Returns true if any attributes changed. Example: `user.isChanged()`\n- `isNewRecord()`: Returns true if the model is not persisted. Example: `user.isNewRecord()`\n- `isPersisted()`: Returns true if the model has been saved. Example: `user.isPersisted()`\n- `can(abilityName)`: Checks a loaded ability. Example: `user.can(\"update\")`\n- `ensureAbilities(listOfAbilities)`: Loads missing abilities from the server. Example: `await user.ensureAbilities([\"update\"])`\n- `isAssociationLoaded(associationName)`: Checks if a relationship is cached. Example: `user.isAssociationLoaded(\"account\")`\n- `isAssociationLoadedUnderscore(associationName)`: Checks a relationship cache using snake_case. Example: `user.isAssociationLoadedUnderscore(\"account\")`\n- `isAssociationPresent(associationName)`: Checks if the relationship is present in memory. Example: `user.isAssociationPresent(\"account\")`\n- `create(attributes, options)`: Creates the record on the server. Example: `await user.create({email: \"sam@example.com\"})`\n- `createRaw(rawData, options)`: Creates the record with raw form data. Example: `await user.createRaw(formElement)`\n- `update(newAttributes, options)`: Updates only changed attributes. Example: `await user.update({email: \"new@example.com\"})`\n- `updateRaw(rawData, options)`: Updates with raw form data. Example: `await user.updateRaw(formElement)`\n- `save()`: Creates or updates based on `isNewRecord()`. Example: `await user.save()`\n- `saveRaw(rawData, options)`: Creates or updates using raw data. Example: `await user.saveRaw(formElement)`\n- `destroy()`: Deletes the record. Example: `await user.destroy()`\n- `reload()`: Reloads the record with the same query params. Example: `await user.reload()`\n- `isValid()`: Not implemented and throws. Example: `user.isValid()`\n- `isValidOnServer()`: Runs server-side validation. Example: `await user.isValidOnServer()`\n- `handleResponseError(response)`: Raises a structured error from a response. Example: `user.handleResponseError(response)`\n- `preloadRelationship(relationshipName, model)`: Marks a relationship as loaded. Example: `user.preloadRelationship(\"account\", account)`\n- `markForDestruction()`: Marks a record for later deletion. Example: `user.markForDestruction()`\n- `markedForDestruction()`: Returns destruction flag. Example: `user.markedForDestruction()`\n- `_callMemberCommand(args, commandArgs)`: Executes a member command. Example: `user._callMemberCommand({args: {}}, {})`\n- `_isPresent(value)`: Presence helper used internally. Example: `user._isPresent(\"hi\")`\n- `_isDateChanged(oldValue, newValue)`: Date change helper. Example: `user._isDateChanged(\"2024-01-01\", \"2024-02-01\")`\n- `_isIntegerChanged(oldValue, newValue)`: Integer change helper. Example: `user._isIntegerChanged(1, 2)`\n- `_isStringChanged(oldValue, newValue)`: String change helper. Example: `user._isStringChanged(\"a\", \"b\")`\n- `setNewModel(model)`: Copies data + relationships from another instance. Example: `user.setNewModel(newUser)`\n- `setNewModelData(model)`: Copies only attributes from another instance. Example: `user.setNewModelData(newUser)`\n- `_refreshModelFromResponse(response)`: Updates model from a command response. Example: `user._refreshModelFromResponse(response)`\n- `_refreshModelDataFromResponse(response)`: Updates attributes from a command response. Example: `user._refreshModelDataFromResponse(response)`\n- `_readModelDataFromArgs(args)`: Populates model from API payload. Example: `user._readModelDataFromArgs({data: payload})`\n- `_readPreloadedRelationships(preloaded)`: Populates relationship cache from preloads. Example: `user._readPreloadedRelationships(preloaded)`\n- `_loadBelongsToReflection(args, queryArgs)`: Loads a belongs_to relationship. Example: `user._loadBelongsToReflection({reflectionName: \"account\", model: user, modelClass: Account})`\n- `_readBelongsToReflection({reflectionName})`: Reads a belongs_to relationship. Example: `user._readBelongsToReflection({reflectionName: \"account\"})`\n- `_loadHasManyReflection(args, queryArgs)`: Loads a has_many relationship. Example: `user._loadHasManyReflection({reflectionName: \"tasks\", model: user, modelClass: Task})`\n- `_loadHasOneReflection(args, queryArgs)`: Loads a has_one relationship. Example: `user._loadHasOneReflection({reflectionName: \"profile\", model: user, modelClass: Profile})`\n- `_readHasOneReflection({reflectionName})`: Reads a has_one relationship. Example: `user._readHasOneReflection({reflectionName: \"profile\"})`\n\n### Collection methods\n\n- `constructor(args, queryArgs)`: Creates a collection query. Example: `new Collection({modelClass: User})`\n- `modelClass()`: Returns the model class for the collection. Example: `collection.modelClass()`\n- `clone()`: Returns a copy of the collection. Example: `const next = collection.clone()`\n- `abilities(abilities)`: Adds ability filters to the query. Example: `User.ransack().abilities({User: [\"update\"]})`\n- `accessibleBy(abilityName)`: Restricts by ability. Example: `User.ransack().accessibleBy(\"read\")`\n- `ransack(params)`: Adds ransack params. Example: `User.ransack().ransack({email_cont: \"@example.com\"})`\n- `search(params)`: Adds search params. Example: `User.ransack().search({q: \"sam\"})`\n- `searchKey(searchKey)`: Sets the search key. Example: `User.ransack().searchKey(\"query\")`\n- `select(select)`: Selects attributes per model. Example: `User.ransack().select({users: [\"id\", \"email\"]})`\n- `selectColumns(selectColumns)`: Selects columns per table. Example: `User.ransack().selectColumns({users: [\"id\", \"email\"]})`\n- `preload(preloadValue)`: Preloads relationships. Example: `User.ransack().preload([\"account\"])`\n- `groupBy(...columns)`: Adds group-by columns. Example: `User.ransack().groupBy(\"users.id\")`\n- `sort(sortBy)`: Adds sort to ransack params. Example: `User.ransack().sort(\"created_at desc\")`\n- `distinct()`: Enables distinct results. Example: `User.ransack().distinct()`\n- `limit(amount)`: Limits the result count. Example: `User.ransack().limit(10)`\n- `page(page)`: Sets the page number. Example: `User.ransack().page(2)`\n- `per(per)`: Sets the page size. Example: `User.ransack().per(50)`\n- `pageKey(pageKey)`: Sets a custom page param key. Example: `User.ransack().pageKey(\"p\")`\n- `perKey(perKey)`: Sets a custom per param key. Example: `User.ransack().perKey(\"per_page\")`\n- `except(...keys)`: Removes query keys. Example: `User.ransack().page(2).except(\"page\")`\n- `params()`: Returns request params. Example: `User.ransack().limit(5).params()`\n- `isFiltered()`: Returns true when filters are set. Example: `User.ransack().limit(5).isFiltered()`\n- `count()`: Returns count for the query. Example: `await User.ransack().count()`\n- `first()`: Returns the first record. Example: `await User.ransack().first()`\n- `toArray()`: Executes and returns models. Example: `await User.ransack().toArray()`\n- `result()`: Executes and returns a `Result` wrapper. Example: `const result = await User.ransack().result()`\n- `each(callback)`: Iterates over the loaded array. Example: `await User.ransack().each((user) => console.log(user.id()))`\n- `ensureLoaded()`: Loads and sets relationship models. Example: `await user.tasks().ensureLoaded()`\n- `isLoaded()`: Checks if a relationship is loaded. Example: `user.tasks().isLoaded()`\n- `preloaded()`: Returns cached models for a relationship. Example: `user.tasks().preloaded()`\n- `loaded()`: Returns the loaded relationship value. Example: `user.tasks().loaded()`\n- `loadedArray()`: Returns loaded relationship array. Example: `user.tasks().loadedArray()`\n- `set(newCollection)`: Replaces the relationship collection. Example: `user.tasks().set([task])`\n- `push(newModel)`: Pushes a model onto the relationship collection. Example: `user.tasks().push(task)`\n- `find(callback)`: Finds within the loaded array. Example: `user.tasks().find((task) => task.id() == \"1\")`\n- `forEach(callback)`: Iterates the loaded array. Example: `user.tasks().forEach((task) => console.log(task.id()))`\n- `map(callback)`: Maps the loaded array. Example: `user.tasks().map((task) => task.title())`\n- `_addQueryToModels(models)`: Assigns the collection to returned models. Example: `collection._addQueryToModels(models)`\n- `_merge(newQueryArgs)`: Merges query args. Example: `collection._merge({limit: 5})`\n- `_response()`: Executes the request and returns the raw response. Example: `await collection._response()`\n\n## Related docs\n\nThe server-side setup, resource definitions, and serializers live in the main ApiMaker repository README.\n"
  },
  "artifacts": [],
  "remote": {
    "resolved": "https://registry.yarnpkg.com/@kaspernj/api-maker/-/api-maker-1.0.2096.tgz#3316b981971651f5a665c139f8141819f76ddd32",
    "type": "tarball",
    "reference": "https://registry.yarnpkg.com/@kaspernj/api-maker/-/api-maker-1.0.2096.tgz",
    "hash": "3316b981971651f5a665c139f8141819f76ddd32",
    "integrity": "sha512-T+dIgD4XXHQqUQIBohVcryI/UXE9F20LE+VbmtT2P772sk8rONo6okpvPZAV3Lvj/MqwLB5uaVXQ4Ajn2cP9BQ==",
    "registry": "npm",
    "packageName": "@kaspernj/api-maker",
    "cacheIntegrity": "sha512-T+dIgD4XXHQqUQIBohVcryI/UXE9F20LE+VbmtT2P772sk8rONo6okpvPZAV3Lvj/MqwLB5uaVXQ4Ajn2cP9BQ== sha1-Mxa5gZcWUfWmZcE5+BQYGfdt3TI="
  },
  "registry": "npm",
  "hash": "3316b981971651f5a665c139f8141819f76ddd32"
}