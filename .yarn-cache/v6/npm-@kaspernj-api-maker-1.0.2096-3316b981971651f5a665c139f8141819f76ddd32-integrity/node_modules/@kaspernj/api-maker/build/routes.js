import * as inflection from "inflection";
import { digg } from "diggerize";
export default class ApiMakerRoutes {
    constructor({ jsRoutes, locale, routeDefinitions }) {
        if (!jsRoutes)
            throw new Error("'jsRoutes' wasn't given");
        this.jsRoutes = jsRoutes;
        this.routeDefinitions = routeDefinitions;
        for (const routeDefinition of digg(this, "routeDefinitions", "routes")) {
            let testRouteNamePath, testRouteNameUrl;
            const routeNamePath = inflection.camelize(`${digg(routeDefinition, "name")}_path`, true);
            const routeNameUrl = inflection.camelize(`${digg(routeDefinition, "name")}_url`, true);
            if (locale) {
                testRouteNamePath = inflection.camelize(`${digg(routeDefinition, "name")}_${locale}_path`, true);
                testRouteNameUrl = inflection.camelize(`${digg(routeDefinition, "name")}_${locale}_url`, true);
            }
            else {
                testRouteNamePath = inflection.camelize(`${digg(routeDefinition, "name")}_path`, true);
                testRouteNameUrl = inflection.camelize(`${digg(routeDefinition, "name")}_url`, true);
            }
            if (!(testRouteNamePath in this.jsRoutes)) {
                throw new Error(`No such path in JS routes: ${testRouteNamePath}: ${Object.keys(this.jsRoutes).join(", ")}`);
            }
            this[routeNamePath] = (...args) => {
                let routeNamePathToUse;
                if (locale) {
                    routeNamePathToUse = inflection.camelize(`${digg(routeDefinition, "name")}_${I18n.locale}_path`, true); // eslint-disable-line no-undef
                }
                else {
                    routeNamePathToUse = routeNamePath;
                }
                return this.jsRoutes[routeNamePathToUse](...args);
            };
            if (!(testRouteNameUrl in this.jsRoutes)) {
                throw new Error(`No such URL in JS routes: ${testRouteNameUrl}: ${Object.keys(this.jsRoutes).join(", ")}`);
            }
            this[routeNameUrl] = (...args) => {
                let routeNameUrlToUse;
                if (locale) {
                    routeNameUrlToUse = inflection.camelize(`${digg(routeDefinition, "name")}_${I18n.locale}_url`, true); // eslint-disable-line no-undef
                }
                else {
                    routeNameUrlToUse = routeNameUrl;
                }
                return this.jsRoutes[routeNameUrlToUse](...args);
            };
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGVzLmpzIiwic291cmNlUm9vdCI6Ii9zcmMvIiwic291cmNlcyI6WyJyb3V0ZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLFVBQVUsTUFBTSxZQUFZLENBQUE7QUFDeEMsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLFdBQVcsQ0FBQTtBQUU5QixNQUFNLENBQUMsT0FBTyxPQUFPLGNBQWM7SUFDakMsWUFBYSxFQUFDLFFBQVEsRUFBRSxNQUFNLEVBQUUsZ0JBQWdCLEVBQUM7UUFDL0MsSUFBSSxDQUFDLFFBQVE7WUFBRSxNQUFNLElBQUksS0FBSyxDQUFDLHlCQUF5QixDQUFDLENBQUE7UUFFekQsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUE7UUFDeEIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLGdCQUFnQixDQUFBO1FBRXhDLEtBQUssTUFBTSxlQUFlLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxrQkFBa0IsRUFBRSxRQUFRLENBQUMsRUFBRSxDQUFDO1lBQ3ZFLElBQUksaUJBQWlCLEVBQUUsZ0JBQWdCLENBQUE7WUFFdkMsTUFBTSxhQUFhLEdBQUcsVUFBVSxDQUFDLFFBQVEsQ0FBQyxHQUFHLElBQUksQ0FBQyxlQUFlLEVBQUUsTUFBTSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQTtZQUN4RixNQUFNLFlBQVksR0FBRyxVQUFVLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxDQUFDLGVBQWUsRUFBRSxNQUFNLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFBO1lBRXRGLElBQUksTUFBTSxFQUFFLENBQUM7Z0JBQ1gsaUJBQWlCLEdBQUcsVUFBVSxDQUFDLFFBQVEsQ0FBQyxHQUFHLElBQUksQ0FBQyxlQUFlLEVBQUUsTUFBTSxDQUFDLElBQUksTUFBTSxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUE7Z0JBQ2hHLGdCQUFnQixHQUFHLFVBQVUsQ0FBQyxRQUFRLENBQUMsR0FBRyxJQUFJLENBQUMsZUFBZSxFQUFFLE1BQU0sQ0FBQyxJQUFJLE1BQU0sTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFBO1lBQ2hHLENBQUM7aUJBQU0sQ0FBQztnQkFDTixpQkFBaUIsR0FBRyxVQUFVLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxDQUFDLGVBQWUsRUFBRSxNQUFNLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFBO2dCQUN0RixnQkFBZ0IsR0FBRyxVQUFVLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxDQUFDLGVBQWUsRUFBRSxNQUFNLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFBO1lBQ3RGLENBQUM7WUFFRCxJQUFJLENBQUMsQ0FBQyxpQkFBaUIsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztnQkFDMUMsTUFBTSxJQUFJLEtBQUssQ0FBQyw4QkFBOEIsaUJBQWlCLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQTtZQUM5RyxDQUFDO1lBRUQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLEVBQUUsRUFBRTtnQkFDaEMsSUFBSSxrQkFBa0IsQ0FBQTtnQkFFdEIsSUFBSSxNQUFNLEVBQUUsQ0FBQztvQkFDWCxrQkFBa0IsR0FBRyxVQUFVLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxDQUFDLGVBQWUsRUFBRSxNQUFNLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUEsQ0FBQywrQkFBK0I7Z0JBQ3hJLENBQUM7cUJBQU0sQ0FBQztvQkFDTixrQkFBa0IsR0FBRyxhQUFhLENBQUE7Z0JBQ3BDLENBQUM7Z0JBRUQsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQTtZQUNuRCxDQUFDLENBQUE7WUFFRCxJQUFJLENBQUMsQ0FBQyxnQkFBZ0IsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztnQkFDekMsTUFBTSxJQUFJLEtBQUssQ0FBQyw2QkFBNkIsZ0JBQWdCLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQTtZQUM1RyxDQUFDO1lBRUQsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLEVBQUUsRUFBRTtnQkFDL0IsSUFBSSxpQkFBaUIsQ0FBQTtnQkFFckIsSUFBSSxNQUFNLEVBQUUsQ0FBQztvQkFDWCxpQkFBaUIsR0FBRyxVQUFVLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxDQUFDLGVBQWUsRUFBRSxNQUFNLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUEsQ0FBQywrQkFBK0I7Z0JBQ3RJLENBQUM7cUJBQU0sQ0FBQztvQkFDTixpQkFBaUIsR0FBRyxZQUFZLENBQUE7Z0JBQ2xDLENBQUM7Z0JBRUQsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQTtZQUNsRCxDQUFDLENBQUE7UUFDSCxDQUFDO0lBQ0gsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgaW5mbGVjdGlvbiBmcm9tIFwiaW5mbGVjdGlvblwiXG5pbXBvcnQge2RpZ2d9IGZyb20gXCJkaWdnZXJpemVcIlxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcGlNYWtlclJvdXRlcyB7XG4gIGNvbnN0cnVjdG9yICh7anNSb3V0ZXMsIGxvY2FsZSwgcm91dGVEZWZpbml0aW9uc30pIHtcbiAgICBpZiAoIWpzUm91dGVzKSB0aHJvdyBuZXcgRXJyb3IoXCInanNSb3V0ZXMnIHdhc24ndCBnaXZlblwiKVxuXG4gICAgdGhpcy5qc1JvdXRlcyA9IGpzUm91dGVzXG4gICAgdGhpcy5yb3V0ZURlZmluaXRpb25zID0gcm91dGVEZWZpbml0aW9uc1xuXG4gICAgZm9yIChjb25zdCByb3V0ZURlZmluaXRpb24gb2YgZGlnZyh0aGlzLCBcInJvdXRlRGVmaW5pdGlvbnNcIiwgXCJyb3V0ZXNcIikpIHtcbiAgICAgIGxldCB0ZXN0Um91dGVOYW1lUGF0aCwgdGVzdFJvdXRlTmFtZVVybFxuXG4gICAgICBjb25zdCByb3V0ZU5hbWVQYXRoID0gaW5mbGVjdGlvbi5jYW1lbGl6ZShgJHtkaWdnKHJvdXRlRGVmaW5pdGlvbiwgXCJuYW1lXCIpfV9wYXRoYCwgdHJ1ZSlcbiAgICAgIGNvbnN0IHJvdXRlTmFtZVVybCA9IGluZmxlY3Rpb24uY2FtZWxpemUoYCR7ZGlnZyhyb3V0ZURlZmluaXRpb24sIFwibmFtZVwiKX1fdXJsYCwgdHJ1ZSlcblxuICAgICAgaWYgKGxvY2FsZSkge1xuICAgICAgICB0ZXN0Um91dGVOYW1lUGF0aCA9IGluZmxlY3Rpb24uY2FtZWxpemUoYCR7ZGlnZyhyb3V0ZURlZmluaXRpb24sIFwibmFtZVwiKX1fJHtsb2NhbGV9X3BhdGhgLCB0cnVlKVxuICAgICAgICB0ZXN0Um91dGVOYW1lVXJsID0gaW5mbGVjdGlvbi5jYW1lbGl6ZShgJHtkaWdnKHJvdXRlRGVmaW5pdGlvbiwgXCJuYW1lXCIpfV8ke2xvY2FsZX1fdXJsYCwgdHJ1ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRlc3RSb3V0ZU5hbWVQYXRoID0gaW5mbGVjdGlvbi5jYW1lbGl6ZShgJHtkaWdnKHJvdXRlRGVmaW5pdGlvbiwgXCJuYW1lXCIpfV9wYXRoYCwgdHJ1ZSlcbiAgICAgICAgdGVzdFJvdXRlTmFtZVVybCA9IGluZmxlY3Rpb24uY2FtZWxpemUoYCR7ZGlnZyhyb3V0ZURlZmluaXRpb24sIFwibmFtZVwiKX1fdXJsYCwgdHJ1ZSlcbiAgICAgIH1cblxuICAgICAgaWYgKCEodGVzdFJvdXRlTmFtZVBhdGggaW4gdGhpcy5qc1JvdXRlcykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBzdWNoIHBhdGggaW4gSlMgcm91dGVzOiAke3Rlc3RSb3V0ZU5hbWVQYXRofTogJHtPYmplY3Qua2V5cyh0aGlzLmpzUm91dGVzKS5qb2luKFwiLCBcIil9YClcbiAgICAgIH1cblxuICAgICAgdGhpc1tyb3V0ZU5hbWVQYXRoXSA9ICguLi5hcmdzKSA9PiB7XG4gICAgICAgIGxldCByb3V0ZU5hbWVQYXRoVG9Vc2VcblxuICAgICAgICBpZiAobG9jYWxlKSB7XG4gICAgICAgICAgcm91dGVOYW1lUGF0aFRvVXNlID0gaW5mbGVjdGlvbi5jYW1lbGl6ZShgJHtkaWdnKHJvdXRlRGVmaW5pdGlvbiwgXCJuYW1lXCIpfV8ke0kxOG4ubG9jYWxlfV9wYXRoYCwgdHJ1ZSkgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZlxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJvdXRlTmFtZVBhdGhUb1VzZSA9IHJvdXRlTmFtZVBhdGhcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmpzUm91dGVzW3JvdXRlTmFtZVBhdGhUb1VzZV0oLi4uYXJncylcbiAgICAgIH1cblxuICAgICAgaWYgKCEodGVzdFJvdXRlTmFtZVVybCBpbiB0aGlzLmpzUm91dGVzKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIHN1Y2ggVVJMIGluIEpTIHJvdXRlczogJHt0ZXN0Um91dGVOYW1lVXJsfTogJHtPYmplY3Qua2V5cyh0aGlzLmpzUm91dGVzKS5qb2luKFwiLCBcIil9YClcbiAgICAgIH1cblxuICAgICAgdGhpc1tyb3V0ZU5hbWVVcmxdID0gKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgbGV0IHJvdXRlTmFtZVVybFRvVXNlXG5cbiAgICAgICAgaWYgKGxvY2FsZSkge1xuICAgICAgICAgIHJvdXRlTmFtZVVybFRvVXNlID0gaW5mbGVjdGlvbi5jYW1lbGl6ZShgJHtkaWdnKHJvdXRlRGVmaW5pdGlvbiwgXCJuYW1lXCIpfV8ke0kxOG4ubG9jYWxlfV91cmxgLCB0cnVlKSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcm91dGVOYW1lVXJsVG9Vc2UgPSByb3V0ZU5hbWVVcmxcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmpzUm91dGVzW3JvdXRlTmFtZVVybFRvVXNlXSguLi5hcmdzKVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19