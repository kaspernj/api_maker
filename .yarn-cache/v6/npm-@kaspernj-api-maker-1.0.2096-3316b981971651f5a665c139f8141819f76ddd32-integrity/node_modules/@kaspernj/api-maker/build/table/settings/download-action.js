import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
/* eslint-disable implicit-arrow-linebreak, no-extra-parens, react/jsx-no-literals, sort-imports */
import BaseComponent from "../../base-component";
import ColumnContent from "../column-content";
import columnIdentifier from "../column-identifier.js";
import columnVisible from "../column-visible.js";
import { saveAs } from "file-saver";
import Icon from "../../utils/icon";
import memo from "set-state-compare/build/memo.js";
import PropTypes from "prop-types";
import propTypesExact from "prop-types-exact";
import React from "react";
import { renderToString } from "react-dom/server"; // eslint-disable-line import/no-unresolved
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import { Pressable } from "react-native";
import Text from "../../utils/text";
export default memo(shapeComponent(class ApiMakerTableSettingsDownloadAction extends BaseComponent {
    static propTypes = propTypesExact({
        l: PropTypes.func.isRequired,
        table: PropTypes.object.isRequired
    });
    render() {
        return (_jsxs(Pressable, { dataSet: this.cache("pressableDataSet", { component: "api-maker/table/settings/download-action" }), onPress: this.tt.onDownloadPress, style: this.cache("pressableStyle", { flexDirection: "row", alignItems: "center" }), children: [_jsx(Icon, { name: "download", size: 20 }), _jsx(Text, { style: this.cache("textStyle", { marginLeft: 5 }), children: "Download" })] }));
    }
    onDownloadPress = () => {
        const { l, table } = this.p;
        const { modelClass } = table.p;
        const { collection } = table.tt;
        const { models } = collection;
        const { preparedColumns } = table.s;
        const tableElement = (_jsxs("table", { children: [_jsx("thead", { children: _jsx("tr", { children: preparedColumns?.map(({ column, tableSettingColumn }) => columnVisible(column, tableSettingColumn) &&
                            _jsx("th", { children: table.headerLabelForColumn(column) }, columnIdentifier(column))) }) }), _jsx("tbody", { children: models.map((model) => _jsx("tr", { children: preparedColumns?.map(({ column, tableSettingColumn }) => columnVisible(column, tableSettingColumn) &&
                            _jsx("td", { children: new ColumnContent({ column, l, mode: "html", model, table }).content() }, columnIdentifier(column))) }, model.id())) })] }));
        const tableHTML = renderToString(tableElement);
        const blob = new Blob([tableHTML], { type: "text/html;charset=utf-8" });
        const fileName = `${modelClass.modelName().human({ count: 2 })}.html`;
        saveAs(blob, fileName);
    };
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG93bmxvYWQtYWN0aW9uLmpzIiwic291cmNlUm9vdCI6Ii9zcmMvIiwic291cmNlcyI6WyJ0YWJsZS9zZXR0aW5ncy9kb3dubG9hZC1hY3Rpb24uanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxtR0FBbUc7QUFDbkcsT0FBTyxhQUFhLE1BQU0sc0JBQXNCLENBQUE7QUFDaEQsT0FBTyxhQUFhLE1BQU0sbUJBQW1CLENBQUE7QUFDN0MsT0FBTyxnQkFBZ0IsTUFBTSx5QkFBeUIsQ0FBQTtBQUN0RCxPQUFPLGFBQWEsTUFBTSxzQkFBc0IsQ0FBQTtBQUNoRCxPQUFPLEVBQUMsTUFBTSxFQUFDLE1BQU0sWUFBWSxDQUFBO0FBQ2pDLE9BQU8sSUFBSSxNQUFNLGtCQUFrQixDQUFBO0FBQ25DLE9BQU8sSUFBSSxNQUFNLGlDQUFpQyxDQUFBO0FBQ2xELE9BQU8sU0FBUyxNQUFNLFlBQVksQ0FBQTtBQUNsQyxPQUFPLGNBQWMsTUFBTSxrQkFBa0IsQ0FBQTtBQUM3QyxPQUFPLEtBQUssTUFBTSxPQUFPLENBQUE7QUFDekIsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLGtCQUFrQixDQUFBLENBQUMsMkNBQTJDO0FBQzNGLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSw0Q0FBNEMsQ0FBQTtBQUN6RSxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sY0FBYyxDQUFBO0FBQ3RDLE9BQU8sSUFBSSxNQUFNLGtCQUFrQixDQUFBO0FBRW5DLGVBQWUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLG1DQUFvQyxTQUFRLGFBQWE7SUFDaEcsTUFBTSxDQUFDLFNBQVMsR0FBRyxjQUFjLENBQUM7UUFDaEMsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVTtRQUM1QixLQUFLLEVBQUUsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVO0tBQ25DLENBQUMsQ0FBQTtJQUVGLE1BQU07UUFDSixPQUFPLENBQ0wsTUFBQyxTQUFTLElBQ1IsT0FBTyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsa0JBQWtCLEVBQUUsRUFBQyxTQUFTLEVBQUUsMENBQTBDLEVBQUMsQ0FBQyxFQUNoRyxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxlQUFlLEVBQ2hDLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFnQixFQUFFLEVBQUMsYUFBYSxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFDLENBQUMsYUFFakYsS0FBQyxJQUFJLElBQUMsSUFBSSxFQUFDLFVBQVUsRUFBQyxJQUFJLEVBQUUsRUFBRSxHQUFJLEVBQ2xDLEtBQUMsSUFBSSxJQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBRSxFQUFDLFVBQVUsRUFBRSxDQUFDLEVBQUMsQ0FBQyx5QkFFOUMsSUFDRyxDQUNiLENBQUE7SUFDSCxDQUFDO0lBRUQsZUFBZSxHQUFHLEdBQUcsRUFBRTtRQUNyQixNQUFNLEVBQUMsQ0FBQyxFQUFFLEtBQUssRUFBQyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUE7UUFDekIsTUFBTSxFQUFDLFVBQVUsRUFBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUE7UUFDNUIsTUFBTSxFQUFDLFVBQVUsRUFBQyxHQUFHLEtBQUssQ0FBQyxFQUFFLENBQUE7UUFDN0IsTUFBTSxFQUFDLE1BQU0sRUFBQyxHQUFHLFVBQVUsQ0FBQTtRQUMzQixNQUFNLEVBQUMsZUFBZSxFQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQTtRQUNqQyxNQUFNLFlBQVksR0FBRyxDQUNuQiw0QkFDRSwwQkFDRSx1QkFDRyxlQUFlLEVBQUUsR0FBRyxDQUFDLENBQUMsRUFBQyxNQUFNLEVBQUUsa0JBQWtCLEVBQUMsRUFBRSxFQUFFLENBQUMsYUFBYSxDQUFDLE1BQU0sRUFBRSxrQkFBa0IsQ0FBQzs0QkFDL0YsdUJBQ0csS0FBSyxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxJQUQ1QixnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FFNUIsQ0FDTixHQUNFLEdBQ0MsRUFDUiwwQkFDRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FDcEIsdUJBQ0csZUFBZSxFQUFFLEdBQUcsQ0FBQyxDQUFDLEVBQUMsTUFBTSxFQUFFLGtCQUFrQixFQUFDLEVBQUUsRUFBRSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsa0JBQWtCLENBQUM7NEJBQy9GLHVCQUNHLElBQUksYUFBYSxDQUFDLEVBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxJQUQ5RCxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FFNUIsQ0FDTixJQUxNLEtBQUssQ0FBQyxFQUFFLEVBQUUsQ0FNZCxDQUNOLEdBQ0ssSUFDRixDQUNULENBQUE7UUFDRCxNQUFNLFNBQVMsR0FBRyxjQUFjLENBQUMsWUFBWSxDQUFDLENBQUE7UUFDOUMsTUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsRUFBRSxFQUFDLElBQUksRUFBRSx5QkFBeUIsRUFBQyxDQUFDLENBQUE7UUFDckUsTUFBTSxRQUFRLEdBQUcsR0FBRyxVQUFVLENBQUMsU0FBUyxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUMsS0FBSyxFQUFFLENBQUMsRUFBQyxDQUFDLE9BQU8sQ0FBQTtRQUVuRSxNQUFNLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFBO0lBQ3hCLENBQUMsQ0FBQTtDQUNGLENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgaW1wbGljaXQtYXJyb3ctbGluZWJyZWFrLCBuby1leHRyYS1wYXJlbnMsIHJlYWN0L2pzeC1uby1saXRlcmFscywgc29ydC1pbXBvcnRzICovXG5pbXBvcnQgQmFzZUNvbXBvbmVudCBmcm9tIFwiLi4vLi4vYmFzZS1jb21wb25lbnRcIlxuaW1wb3J0IENvbHVtbkNvbnRlbnQgZnJvbSBcIi4uL2NvbHVtbi1jb250ZW50XCJcbmltcG9ydCBjb2x1bW5JZGVudGlmaWVyIGZyb20gXCIuLi9jb2x1bW4taWRlbnRpZmllci5qc1wiXG5pbXBvcnQgY29sdW1uVmlzaWJsZSBmcm9tIFwiLi4vY29sdW1uLXZpc2libGUuanNcIlxuaW1wb3J0IHtzYXZlQXN9IGZyb20gXCJmaWxlLXNhdmVyXCJcbmltcG9ydCBJY29uIGZyb20gXCIuLi8uLi91dGlscy9pY29uXCJcbmltcG9ydCBtZW1vIGZyb20gXCJzZXQtc3RhdGUtY29tcGFyZS9idWlsZC9tZW1vLmpzXCJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSBcInByb3AtdHlwZXNcIlxuaW1wb3J0IHByb3BUeXBlc0V4YWN0IGZyb20gXCJwcm9wLXR5cGVzLWV4YWN0XCJcbmltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IHtyZW5kZXJUb1N0cmluZ30gZnJvbSBcInJlYWN0LWRvbS9zZXJ2ZXJcIiAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGltcG9ydC9uby11bnJlc29sdmVkXG5pbXBvcnQge3NoYXBlQ29tcG9uZW50fSBmcm9tIFwic2V0LXN0YXRlLWNvbXBhcmUvYnVpbGQvc2hhcGUtY29tcG9uZW50LmpzXCJcbmltcG9ydCB7UHJlc3NhYmxlfSBmcm9tIFwicmVhY3QtbmF0aXZlXCJcbmltcG9ydCBUZXh0IGZyb20gXCIuLi8uLi91dGlscy90ZXh0XCJcblxuZXhwb3J0IGRlZmF1bHQgbWVtbyhzaGFwZUNvbXBvbmVudChjbGFzcyBBcGlNYWtlclRhYmxlU2V0dGluZ3NEb3dubG9hZEFjdGlvbiBleHRlbmRzIEJhc2VDb21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0gcHJvcFR5cGVzRXhhY3Qoe1xuICAgIGw6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgdGFibGU6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZFxuICB9KVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPFByZXNzYWJsZVxuICAgICAgICBkYXRhU2V0PXt0aGlzLmNhY2hlKFwicHJlc3NhYmxlRGF0YVNldFwiLCB7Y29tcG9uZW50OiBcImFwaS1tYWtlci90YWJsZS9zZXR0aW5ncy9kb3dubG9hZC1hY3Rpb25cIn0pfVxuICAgICAgICBvblByZXNzPXt0aGlzLnR0Lm9uRG93bmxvYWRQcmVzc31cbiAgICAgICAgc3R5bGU9e3RoaXMuY2FjaGUoXCJwcmVzc2FibGVTdHlsZVwiLCB7ZmxleERpcmVjdGlvbjogXCJyb3dcIiwgYWxpZ25JdGVtczogXCJjZW50ZXJcIn0pfVxuICAgICAgPlxuICAgICAgICA8SWNvbiBuYW1lPVwiZG93bmxvYWRcIiBzaXplPXsyMH0gLz5cbiAgICAgICAgPFRleHQgc3R5bGU9e3RoaXMuY2FjaGUoXCJ0ZXh0U3R5bGVcIiwge21hcmdpbkxlZnQ6IDV9KX0+XG4gICAgICAgICAgRG93bmxvYWRcbiAgICAgICAgPC9UZXh0PlxuICAgICAgPC9QcmVzc2FibGU+XG4gICAgKVxuICB9XG5cbiAgb25Eb3dubG9hZFByZXNzID0gKCkgPT4ge1xuICAgIGNvbnN0IHtsLCB0YWJsZX0gPSB0aGlzLnBcbiAgICBjb25zdCB7bW9kZWxDbGFzc30gPSB0YWJsZS5wXG4gICAgY29uc3Qge2NvbGxlY3Rpb259ID0gdGFibGUudHRcbiAgICBjb25zdCB7bW9kZWxzfSA9IGNvbGxlY3Rpb25cbiAgICBjb25zdCB7cHJlcGFyZWRDb2x1bW5zfSA9IHRhYmxlLnNcbiAgICBjb25zdCB0YWJsZUVsZW1lbnQgPSAoXG4gICAgICA8dGFibGU+XG4gICAgICAgIDx0aGVhZD5cbiAgICAgICAgICA8dHI+XG4gICAgICAgICAgICB7cHJlcGFyZWRDb2x1bW5zPy5tYXAoKHtjb2x1bW4sIHRhYmxlU2V0dGluZ0NvbHVtbn0pID0+IGNvbHVtblZpc2libGUoY29sdW1uLCB0YWJsZVNldHRpbmdDb2x1bW4pICYmXG4gICAgICAgICAgICAgIDx0aCBrZXk9e2NvbHVtbklkZW50aWZpZXIoY29sdW1uKX0+XG4gICAgICAgICAgICAgICAge3RhYmxlLmhlYWRlckxhYmVsRm9yQ29sdW1uKGNvbHVtbil9XG4gICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvdHI+XG4gICAgICAgIDwvdGhlYWQ+XG4gICAgICAgIDx0Ym9keT5cbiAgICAgICAgICB7bW9kZWxzLm1hcCgobW9kZWwpID0+XG4gICAgICAgICAgICA8dHIga2V5PXttb2RlbC5pZCgpfT5cbiAgICAgICAgICAgICAge3ByZXBhcmVkQ29sdW1ucz8ubWFwKCh7Y29sdW1uLCB0YWJsZVNldHRpbmdDb2x1bW59KSA9PiBjb2x1bW5WaXNpYmxlKGNvbHVtbiwgdGFibGVTZXR0aW5nQ29sdW1uKSAmJlxuICAgICAgICAgICAgICAgIDx0ZCBrZXk9e2NvbHVtbklkZW50aWZpZXIoY29sdW1uKX0+XG4gICAgICAgICAgICAgICAgICB7bmV3IENvbHVtbkNvbnRlbnQoe2NvbHVtbiwgbCwgbW9kZTogXCJodG1sXCIsIG1vZGVsLCB0YWJsZX0pLmNvbnRlbnQoKX1cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICApfVxuICAgICAgICA8L3Rib2R5PlxuICAgICAgPC90YWJsZT5cbiAgICApXG4gICAgY29uc3QgdGFibGVIVE1MID0gcmVuZGVyVG9TdHJpbmcodGFibGVFbGVtZW50KVxuICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbdGFibGVIVE1MXSwge3R5cGU6IFwidGV4dC9odG1sO2NoYXJzZXQ9dXRmLThcIn0pXG4gICAgY29uc3QgZmlsZU5hbWUgPSBgJHttb2RlbENsYXNzLm1vZGVsTmFtZSgpLmh1bWFuKHtjb3VudDogMn0pfS5odG1sYFxuXG4gICAgc2F2ZUFzKGJsb2IsIGZpbGVOYW1lKVxuICB9XG59KSlcbiJdfQ==