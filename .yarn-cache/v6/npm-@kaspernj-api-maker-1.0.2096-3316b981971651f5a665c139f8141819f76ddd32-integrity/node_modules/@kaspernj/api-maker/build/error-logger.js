import SourceMapsLoader from "./source-maps-loader.js";
import { digg } from "diggerize";
export default class ErrorLogger {
    constructor() {
        this.debugging = false;
        this.errorOccurred = false;
        this.errors = [];
        this.isHandlingError = false;
        this.sourceMapsLoader = new SourceMapsLoader();
        this.sourceMapsLoader.loadSourceMapsForScriptTags((script) => {
            const src = script.getAttribute("src");
            const type = script.getAttribute("type");
            if (src && (src.includes("/packs/") || src.includes("/packs-test/")) && (type == "text/javascript" || !type)) {
                return src;
            }
        });
    }
    debug(...output) {
        if (this.debugging)
            console.error("ApiMaker ErrorLogger:", ...output);
    }
    enable() {
        this.debug("Enable called");
        this.connectOnError();
        this.connectUnhandledRejection();
    }
    getErrors = () => this.errors;
    hasErrorOccurred = () => digg(this, "errorOccurred");
    isLoadingSourceMaps = () => digg(this, "sourceMapsLoader", "isLoadingSourceMaps");
    isWorkingOnError = () => digg(this, "isHandlingError") || this.isLoadingSourceMaps();
    connectOnError() {
        window.addEventListener("error", (event) => {
            if (this.debugging)
                this.debug("Error:", event.message);
            this.errorOccurred = true;
            if (!this.isHandlingError) {
                this.isHandlingError = true;
                this.onError(event).finally(() => {
                    this.isHandlingError = false;
                });
            }
        });
    }
    connectUnhandledRejection() {
        window.addEventListener("unhandledrejection", (event) => {
            if (this.debugging)
                this.debug("Unhandled rejection:", event.reason.message);
            this.errorOccurred = true;
            if (!this.isHandlingError) {
                this.isHandlingError = true;
                this.onUnhandledRejection(event).finally(() => {
                    this.isHandlingError = false;
                });
            }
        });
    }
    async onError(event) {
        this.errorOccurred = true;
        if (event.error)
            await this.sourceMapsLoader.loadSourceMaps(event.error);
        if (event.error && event.error.stack) {
            const backtrace = this.sourceMapsLoader.parseStackTrace(event.error.stack);
            this.errors.push({
                errorClass: event.error ? event.error.name : "No error class",
                message: event.message || "Unknown error",
                backtrace
            });
        }
        else {
            this.errors.push({
                errorClass: event.error ? event.error.name : "No error class",
                message: event.message || "Unknown error",
                backtrace: null
            });
        }
    }
    async onUnhandledRejection(event) {
        if (event.reason)
            await this.sourceMapsLoader.loadSourceMaps(event.reason);
        if (event.reason.stack) {
            const backtrace = this.sourceMapsLoader.parseStackTrace(event.reason.stack);
            this.errors.push({
                errorClass: "UnhandledRejection",
                message: event.reason.message || "Unhandled promise rejection",
                backtrace
            });
        }
        else {
            this.errors.push({
                errorClass: "UnhandledRejection",
                message: event.reason.message || "Unhandled promise rejection",
                backtrace: null
            });
        }
    }
    testPromiseError() {
        return new Promise((_resolve) => {
            throw new Error("testPromiseError");
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXJyb3ItbG9nZ2VyLmpzIiwic291cmNlUm9vdCI6Ii9zcmMvIiwic291cmNlcyI6WyJlcnJvci1sb2dnZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxnQkFBZ0IsTUFBTSx5QkFBeUIsQ0FBQTtBQUN0RCxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sV0FBVyxDQUFBO0FBRTlCLE1BQU0sQ0FBQyxPQUFPLE9BQU8sV0FBVztJQUM5QjtRQUNFLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFBO1FBQzFCLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFBO1FBQ2hCLElBQUksQ0FBQyxlQUFlLEdBQUcsS0FBSyxDQUFBO1FBQzVCLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLGdCQUFnQixFQUFFLENBQUE7UUFDOUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLDJCQUEyQixDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUU7WUFDM0QsTUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQTtZQUN0QyxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFBO1lBRXhDLElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsSUFBSSxHQUFHLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksaUJBQWlCLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO2dCQUM3RyxPQUFPLEdBQUcsQ0FBQTtZQUNaLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFFRCxLQUFLLENBQUMsR0FBRyxNQUFNO1FBQ2IsSUFBSSxJQUFJLENBQUMsU0FBUztZQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxNQUFNLENBQUMsQ0FBQTtJQUN2RSxDQUFDO0lBRUQsTUFBTTtRQUNKLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUE7UUFDM0IsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFBO1FBQ3JCLElBQUksQ0FBQyx5QkFBeUIsRUFBRSxDQUFBO0lBQ2xDLENBQUM7SUFFRCxTQUFTLEdBQUcsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQTtJQUM3QixnQkFBZ0IsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLGVBQWUsQ0FBQyxDQUFBO0lBQ3BELG1CQUFtQixHQUFHLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsa0JBQWtCLEVBQUUscUJBQXFCLENBQUMsQ0FBQTtJQUNqRixnQkFBZ0IsR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLGlCQUFpQixDQUFDLElBQUksSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUE7SUFFcEYsY0FBYztRQUNaLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtZQUN6QyxJQUFJLElBQUksQ0FBQyxTQUFTO2dCQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQTtZQUN2RCxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQTtZQUV6QixJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO2dCQUMxQixJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQTtnQkFDM0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFO29CQUMvQixJQUFJLENBQUMsZUFBZSxHQUFHLEtBQUssQ0FBQTtnQkFDOUIsQ0FBQyxDQUFDLENBQUE7WUFDSixDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDO0lBRUQseUJBQXlCO1FBQ3ZCLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO1lBQ3RELElBQUksSUFBSSxDQUFDLFNBQVM7Z0JBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxzQkFBc0IsRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFBO1lBQzVFLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFBO1lBRXpCLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7Z0JBQzFCLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFBO2dCQUMzQixJQUFJLENBQUMsb0JBQW9CLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRTtvQkFDNUMsSUFBSSxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUE7Z0JBQzlCLENBQUMsQ0FBQyxDQUFBO1lBQ0osQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUVELEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSztRQUNqQixJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQTtRQUV6QixJQUFJLEtBQUssQ0FBQyxLQUFLO1lBQUUsTUFBTSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUV4RSxJQUFJLEtBQUssQ0FBQyxLQUFLLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNyQyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUE7WUFFMUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQ2YsVUFBVSxFQUFFLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxnQkFBZ0I7Z0JBQzdELE9BQU8sRUFBRSxLQUFLLENBQUMsT0FBTyxJQUFJLGVBQWU7Z0JBQ3pDLFNBQVM7YUFDVixDQUFDLENBQUE7UUFDSixDQUFDO2FBQU0sQ0FBQztZQUNOLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDO2dCQUNmLFVBQVUsRUFBRSxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsZ0JBQWdCO2dCQUM3RCxPQUFPLEVBQUUsS0FBSyxDQUFDLE9BQU8sSUFBSSxlQUFlO2dCQUN6QyxTQUFTLEVBQUUsSUFBSTthQUNoQixDQUFDLENBQUE7UUFDSixDQUFDO0lBQ0gsQ0FBQztJQUVELEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLO1FBQzlCLElBQUksS0FBSyxDQUFDLE1BQU07WUFBRSxNQUFNLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFBO1FBRTFFLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUN2QixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7WUFFM0UsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQ2YsVUFBVSxFQUFFLG9CQUFvQjtnQkFDaEMsT0FBTyxFQUFFLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxJQUFJLDZCQUE2QjtnQkFDOUQsU0FBUzthQUNWLENBQUMsQ0FBQTtRQUNKLENBQUM7YUFBTSxDQUFDO1lBQ04sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQ2YsVUFBVSxFQUFFLG9CQUFvQjtnQkFDaEMsT0FBTyxFQUFFLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxJQUFJLDZCQUE2QjtnQkFDOUQsU0FBUyxFQUFFLElBQUk7YUFDaEIsQ0FBQyxDQUFBO1FBQ0osQ0FBQztJQUNILENBQUM7SUFFRCxnQkFBZ0I7UUFDZCxPQUFPLElBQUksT0FBTyxDQUFDLENBQUMsUUFBUSxFQUFFLEVBQUU7WUFDOUIsTUFBTSxJQUFJLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxDQUFBO1FBQ3JDLENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFNvdXJjZU1hcHNMb2FkZXIgZnJvbSBcIi4vc291cmNlLW1hcHMtbG9hZGVyLmpzXCJcbmltcG9ydCB7ZGlnZ30gZnJvbSBcImRpZ2dlcml6ZVwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVycm9yTG9nZ2VyIHtcbiAgY29uc3RydWN0b3IgKCkge1xuICAgIHRoaXMuZGVidWdnaW5nID0gZmFsc2VcbiAgICB0aGlzLmVycm9yT2NjdXJyZWQgPSBmYWxzZVxuICAgIHRoaXMuZXJyb3JzID0gW11cbiAgICB0aGlzLmlzSGFuZGxpbmdFcnJvciA9IGZhbHNlXG4gICAgdGhpcy5zb3VyY2VNYXBzTG9hZGVyID0gbmV3IFNvdXJjZU1hcHNMb2FkZXIoKVxuICAgIHRoaXMuc291cmNlTWFwc0xvYWRlci5sb2FkU291cmNlTWFwc0ZvclNjcmlwdFRhZ3MoKHNjcmlwdCkgPT4ge1xuICAgICAgY29uc3Qgc3JjID0gc2NyaXB0LmdldEF0dHJpYnV0ZShcInNyY1wiKVxuICAgICAgY29uc3QgdHlwZSA9IHNjcmlwdC5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpXG5cbiAgICAgIGlmIChzcmMgJiYgKHNyYy5pbmNsdWRlcyhcIi9wYWNrcy9cIikgfHwgc3JjLmluY2x1ZGVzKFwiL3BhY2tzLXRlc3QvXCIpKSAmJiAodHlwZSA9PSBcInRleHQvamF2YXNjcmlwdFwiIHx8ICF0eXBlKSkge1xuICAgICAgICByZXR1cm4gc3JjXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIGRlYnVnKC4uLm91dHB1dCkge1xuICAgIGlmICh0aGlzLmRlYnVnZ2luZykgY29uc29sZS5lcnJvcihcIkFwaU1ha2VyIEVycm9yTG9nZ2VyOlwiLCAuLi5vdXRwdXQpXG4gIH1cblxuICBlbmFibGUgKCkge1xuICAgIHRoaXMuZGVidWcoXCJFbmFibGUgY2FsbGVkXCIpXG4gICAgdGhpcy5jb25uZWN0T25FcnJvcigpXG4gICAgdGhpcy5jb25uZWN0VW5oYW5kbGVkUmVqZWN0aW9uKClcbiAgfVxuXG4gIGdldEVycm9ycyA9ICgpID0+IHRoaXMuZXJyb3JzXG4gIGhhc0Vycm9yT2NjdXJyZWQgPSAoKSA9PiBkaWdnKHRoaXMsIFwiZXJyb3JPY2N1cnJlZFwiKVxuICBpc0xvYWRpbmdTb3VyY2VNYXBzID0gKCkgPT4gZGlnZyh0aGlzLCBcInNvdXJjZU1hcHNMb2FkZXJcIiwgXCJpc0xvYWRpbmdTb3VyY2VNYXBzXCIpXG4gIGlzV29ya2luZ09uRXJyb3IgPSAoKSA9PiBkaWdnKHRoaXMsIFwiaXNIYW5kbGluZ0Vycm9yXCIpIHx8IHRoaXMuaXNMb2FkaW5nU291cmNlTWFwcygpXG5cbiAgY29ubmVjdE9uRXJyb3IoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmICh0aGlzLmRlYnVnZ2luZykgdGhpcy5kZWJ1ZyhcIkVycm9yOlwiLCBldmVudC5tZXNzYWdlKVxuICAgICAgdGhpcy5lcnJvck9jY3VycmVkID0gdHJ1ZVxuXG4gICAgICBpZiAoIXRoaXMuaXNIYW5kbGluZ0Vycm9yKSB7XG4gICAgICAgIHRoaXMuaXNIYW5kbGluZ0Vycm9yID0gdHJ1ZVxuICAgICAgICB0aGlzLm9uRXJyb3IoZXZlbnQpLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuaXNIYW5kbGluZ0Vycm9yID0gZmFsc2VcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgY29ubmVjdFVuaGFuZGxlZFJlamVjdGlvbigpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInVuaGFuZGxlZHJlamVjdGlvblwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmICh0aGlzLmRlYnVnZ2luZykgdGhpcy5kZWJ1ZyhcIlVuaGFuZGxlZCByZWplY3Rpb246XCIsIGV2ZW50LnJlYXNvbi5tZXNzYWdlKVxuICAgICAgdGhpcy5lcnJvck9jY3VycmVkID0gdHJ1ZVxuXG4gICAgICBpZiAoIXRoaXMuaXNIYW5kbGluZ0Vycm9yKSB7XG4gICAgICAgIHRoaXMuaXNIYW5kbGluZ0Vycm9yID0gdHJ1ZVxuICAgICAgICB0aGlzLm9uVW5oYW5kbGVkUmVqZWN0aW9uKGV2ZW50KS5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICB0aGlzLmlzSGFuZGxpbmdFcnJvciA9IGZhbHNlXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIGFzeW5jIG9uRXJyb3IoZXZlbnQpIHtcbiAgICB0aGlzLmVycm9yT2NjdXJyZWQgPSB0cnVlXG5cbiAgICBpZiAoZXZlbnQuZXJyb3IpIGF3YWl0IHRoaXMuc291cmNlTWFwc0xvYWRlci5sb2FkU291cmNlTWFwcyhldmVudC5lcnJvcilcblxuICAgIGlmIChldmVudC5lcnJvciAmJiBldmVudC5lcnJvci5zdGFjaykge1xuICAgICAgY29uc3QgYmFja3RyYWNlID0gdGhpcy5zb3VyY2VNYXBzTG9hZGVyLnBhcnNlU3RhY2tUcmFjZShldmVudC5lcnJvci5zdGFjaylcblxuICAgICAgdGhpcy5lcnJvcnMucHVzaCh7XG4gICAgICAgIGVycm9yQ2xhc3M6IGV2ZW50LmVycm9yID8gZXZlbnQuZXJyb3IubmFtZSA6IFwiTm8gZXJyb3IgY2xhc3NcIixcbiAgICAgICAgbWVzc2FnZTogZXZlbnQubWVzc2FnZSB8fCBcIlVua25vd24gZXJyb3JcIixcbiAgICAgICAgYmFja3RyYWNlXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVycm9ycy5wdXNoKHtcbiAgICAgICAgZXJyb3JDbGFzczogZXZlbnQuZXJyb3IgPyBldmVudC5lcnJvci5uYW1lIDogXCJObyBlcnJvciBjbGFzc1wiLFxuICAgICAgICBtZXNzYWdlOiBldmVudC5tZXNzYWdlIHx8IFwiVW5rbm93biBlcnJvclwiLFxuICAgICAgICBiYWNrdHJhY2U6IG51bGxcbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgb25VbmhhbmRsZWRSZWplY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQucmVhc29uKSBhd2FpdCB0aGlzLnNvdXJjZU1hcHNMb2FkZXIubG9hZFNvdXJjZU1hcHMoZXZlbnQucmVhc29uKVxuXG4gICAgaWYgKGV2ZW50LnJlYXNvbi5zdGFjaykge1xuICAgICAgY29uc3QgYmFja3RyYWNlID0gdGhpcy5zb3VyY2VNYXBzTG9hZGVyLnBhcnNlU3RhY2tUcmFjZShldmVudC5yZWFzb24uc3RhY2spXG5cbiAgICAgIHRoaXMuZXJyb3JzLnB1c2goe1xuICAgICAgICBlcnJvckNsYXNzOiBcIlVuaGFuZGxlZFJlamVjdGlvblwiLFxuICAgICAgICBtZXNzYWdlOiBldmVudC5yZWFzb24ubWVzc2FnZSB8fCBcIlVuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvblwiLFxuICAgICAgICBiYWNrdHJhY2VcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZXJyb3JzLnB1c2goe1xuICAgICAgICBlcnJvckNsYXNzOiBcIlVuaGFuZGxlZFJlamVjdGlvblwiLFxuICAgICAgICBtZXNzYWdlOiBldmVudC5yZWFzb24ubWVzc2FnZSB8fCBcIlVuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvblwiLFxuICAgICAgICBiYWNrdHJhY2U6IG51bGxcbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgdGVzdFByb21pc2VFcnJvcigpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKF9yZXNvbHZlKSA9PiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0ZXN0UHJvbWlzZUVycm9yXCIpXG4gICAgfSlcbiAgfVxufVxuIl19