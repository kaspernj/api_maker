import { jsx as _jsx } from "react/jsx-runtime";
/* eslint-disable sort-imports */
import BaseComponent from "../base-component";
import ConfigReader from "./config-reader";
import { digg } from "diggerize";
import hasEditConfig from "./has-edit-config.js";
import * as inflection from "inflection";
import memo from "set-state-compare/build/memo.js";
import Params from "../params.js";
import PropTypes from "prop-types";
import React, { useMemo } from "react";
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import Table from "../table/table";
import useCurrentUser from "../use-current-user.js";
export default memo(shapeComponent(class ApiMakerSuperAdminModelClassTable extends BaseComponent {
    static propTypes = {
        modelClass: PropTypes.func.isRequired
    };
    render() {
        const { modelClass, ...restProps } = this.props;
        const currentUser = useCurrentUser();
        const configReader = useMemo(() => ConfigReader.forModel(modelClass), [modelClass]);
        const { columns, select } = useMemo(() => configReader.tableColumns(), [modelClass]);
        const tableConfig = configReader.modelConfig?.table;
        const tableProps = {};
        if (!columns)
            throw new Error("No columns given");
        if (tableConfig?.query)
            tableProps.collection = tableConfig.query;
        return (_jsx(Table, { columns: columns, currentUser: currentUser, editModelPath: hasEditConfig(modelClass) ? this.tt.editModelPath : undefined, modelClass: modelClass, select: select, viewModelPath: this.tt.viewModelPath, workplace: true, ...tableProps, ...restProps }));
    }
    editModelPath = (args) => {
        const argName = inflection.camelize(digg(this.p.modelClass.modelClassData(), "name"), true);
        const model = digg(args, argName);
        return Params.withParams({
            model: this.p.modelClass.modelClassData().name,
            model_id: model.primaryKey(),
            mode: "edit"
        });
    };
    viewModelPath = (args) => {
        const argName = inflection.camelize(digg(this.p.modelClass.modelClassData(), "name"), true);
        const model = digg(args, argName);
        return Params.withParams({
            model: this.p.modelClass.modelClassData().name,
            model_id: model.primaryKey()
        });
    };
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kZWwtY2xhc3MtdGFibGUuanMiLCJzb3VyY2VSb290IjoiL3NyYy8iLCJzb3VyY2VzIjpbInN1cGVyLWFkbWluL21vZGVsLWNsYXNzLXRhYmxlLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsaUNBQWlDO0FBQ2pDLE9BQU8sYUFBYSxNQUFNLG1CQUFtQixDQUFBO0FBQzdDLE9BQU8sWUFBWSxNQUFNLGlCQUFpQixDQUFBO0FBQzFDLE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxXQUFXLENBQUE7QUFDOUIsT0FBTyxhQUFhLE1BQU0sc0JBQXNCLENBQUE7QUFDaEQsT0FBTyxLQUFLLFVBQVUsTUFBTSxZQUFZLENBQUE7QUFDeEMsT0FBTyxJQUFJLE1BQU0saUNBQWlDLENBQUE7QUFDbEQsT0FBTyxNQUFNLE1BQU0sY0FBYyxDQUFBO0FBQ2pDLE9BQU8sU0FBUyxNQUFNLFlBQVksQ0FBQTtBQUNsQyxPQUFPLEtBQUssRUFBRSxFQUFDLE9BQU8sRUFBQyxNQUFNLE9BQU8sQ0FBQTtBQUNwQyxPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0sNENBQTRDLENBQUE7QUFDekUsT0FBTyxLQUFLLE1BQU0sZ0JBQWdCLENBQUE7QUFDbEMsT0FBTyxjQUFjLE1BQU0sd0JBQXdCLENBQUE7QUFFbkQsZUFBZSxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0saUNBQWtDLFNBQVEsYUFBYTtJQUM5RixNQUFNLENBQUMsU0FBUyxHQUFHO1FBQ2pCLFVBQVUsRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLFVBQVU7S0FDdEMsQ0FBQTtJQUVELE1BQU07UUFDSixNQUFNLEVBQUMsVUFBVSxFQUFFLEdBQUcsU0FBUyxFQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQTtRQUM3QyxNQUFNLFdBQVcsR0FBRyxjQUFjLEVBQUUsQ0FBQTtRQUNwQyxNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUE7UUFDbkYsTUFBTSxFQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUMsR0FBRyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLFlBQVksRUFBRSxFQUFFLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQTtRQUNsRixNQUFNLFdBQVcsR0FBRyxZQUFZLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQTtRQUNuRCxNQUFNLFVBQVUsR0FBRyxFQUFFLENBQUE7UUFFckIsSUFBSSxDQUFDLE9BQU87WUFBRSxNQUFNLElBQUksS0FBSyxDQUFDLGtCQUFrQixDQUFDLENBQUE7UUFFakQsSUFBSSxXQUFXLEVBQUUsS0FBSztZQUFFLFVBQVUsQ0FBQyxVQUFVLEdBQUcsV0FBVyxDQUFDLEtBQUssQ0FBQTtRQUVqRSxPQUFPLENBQ0wsS0FBQyxLQUFLLElBQ0osT0FBTyxFQUFFLE9BQU8sRUFDaEIsV0FBVyxFQUFFLFdBQVcsRUFDeEIsYUFBYSxFQUFFLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFDNUUsVUFBVSxFQUFFLFVBQVUsRUFDdEIsTUFBTSxFQUFFLE1BQU0sRUFDZCxhQUFhLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLEVBQ3BDLFNBQVMsV0FDTCxVQUFVLEtBQ1YsU0FBUyxHQUNiLENBQ0gsQ0FBQTtJQUNILENBQUM7SUFFRCxhQUFhLEdBQUcsQ0FBQyxJQUFJLEVBQUUsRUFBRTtRQUN2QixNQUFNLE9BQU8sR0FBRyxVQUFVLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxjQUFjLEVBQUUsRUFBRSxNQUFNLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQTtRQUMzRixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFBO1FBRWpDLE9BQU8sTUFBTSxDQUFDLFVBQVUsQ0FBQztZQUN2QixLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsY0FBYyxFQUFFLENBQUMsSUFBSTtZQUM5QyxRQUFRLEVBQUUsS0FBSyxDQUFDLFVBQVUsRUFBRTtZQUM1QixJQUFJLEVBQUUsTUFBTTtTQUNiLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQTtJQUVELGFBQWEsR0FBRyxDQUFDLElBQUksRUFBRSxFQUFFO1FBQ3ZCLE1BQU0sT0FBTyxHQUFHLFVBQVUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLGNBQWMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFBO1FBQzNGLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUE7UUFFakMsT0FBTyxNQUFNLENBQUMsVUFBVSxDQUFDO1lBQ3ZCLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxJQUFJO1lBQzlDLFFBQVEsRUFBRSxLQUFLLENBQUMsVUFBVSxFQUFFO1NBQzdCLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQTtDQUNGLENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgc29ydC1pbXBvcnRzICovXG5pbXBvcnQgQmFzZUNvbXBvbmVudCBmcm9tIFwiLi4vYmFzZS1jb21wb25lbnRcIlxuaW1wb3J0IENvbmZpZ1JlYWRlciBmcm9tIFwiLi9jb25maWctcmVhZGVyXCJcbmltcG9ydCB7ZGlnZ30gZnJvbSBcImRpZ2dlcml6ZVwiXG5pbXBvcnQgaGFzRWRpdENvbmZpZyBmcm9tIFwiLi9oYXMtZWRpdC1jb25maWcuanNcIlxuaW1wb3J0ICogYXMgaW5mbGVjdGlvbiBmcm9tIFwiaW5mbGVjdGlvblwiXG5pbXBvcnQgbWVtbyBmcm9tIFwic2V0LXN0YXRlLWNvbXBhcmUvYnVpbGQvbWVtby5qc1wiXG5pbXBvcnQgUGFyYW1zIGZyb20gXCIuLi9wYXJhbXMuanNcIlxuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiXG5pbXBvcnQgUmVhY3QsIHt1c2VNZW1vfSBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IHtzaGFwZUNvbXBvbmVudH0gZnJvbSBcInNldC1zdGF0ZS1jb21wYXJlL2J1aWxkL3NoYXBlLWNvbXBvbmVudC5qc1wiXG5pbXBvcnQgVGFibGUgZnJvbSBcIi4uL3RhYmxlL3RhYmxlXCJcbmltcG9ydCB1c2VDdXJyZW50VXNlciBmcm9tIFwiLi4vdXNlLWN1cnJlbnQtdXNlci5qc1wiXG5cbmV4cG9ydCBkZWZhdWx0IG1lbW8oc2hhcGVDb21wb25lbnQoY2xhc3MgQXBpTWFrZXJTdXBlckFkbWluTW9kZWxDbGFzc1RhYmxlIGV4dGVuZHMgQmFzZUNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgbW9kZWxDbGFzczogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZFxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHttb2RlbENsYXNzLCAuLi5yZXN0UHJvcHN9ID0gdGhpcy5wcm9wc1xuICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gdXNlQ3VycmVudFVzZXIoKVxuICAgIGNvbnN0IGNvbmZpZ1JlYWRlciA9IHVzZU1lbW8oKCkgPT4gQ29uZmlnUmVhZGVyLmZvck1vZGVsKG1vZGVsQ2xhc3MpLCBbbW9kZWxDbGFzc10pXG4gICAgY29uc3Qge2NvbHVtbnMsIHNlbGVjdH0gPSB1c2VNZW1vKCgpID0+IGNvbmZpZ1JlYWRlci50YWJsZUNvbHVtbnMoKSwgW21vZGVsQ2xhc3NdKVxuICAgIGNvbnN0IHRhYmxlQ29uZmlnID0gY29uZmlnUmVhZGVyLm1vZGVsQ29uZmlnPy50YWJsZVxuICAgIGNvbnN0IHRhYmxlUHJvcHMgPSB7fVxuXG4gICAgaWYgKCFjb2x1bW5zKSB0aHJvdyBuZXcgRXJyb3IoXCJObyBjb2x1bW5zIGdpdmVuXCIpXG5cbiAgICBpZiAodGFibGVDb25maWc/LnF1ZXJ5KSB0YWJsZVByb3BzLmNvbGxlY3Rpb24gPSB0YWJsZUNvbmZpZy5xdWVyeVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxUYWJsZVxuICAgICAgICBjb2x1bW5zPXtjb2x1bW5zfVxuICAgICAgICBjdXJyZW50VXNlcj17Y3VycmVudFVzZXJ9XG4gICAgICAgIGVkaXRNb2RlbFBhdGg9e2hhc0VkaXRDb25maWcobW9kZWxDbGFzcykgPyB0aGlzLnR0LmVkaXRNb2RlbFBhdGggOiB1bmRlZmluZWR9XG4gICAgICAgIG1vZGVsQ2xhc3M9e21vZGVsQ2xhc3N9XG4gICAgICAgIHNlbGVjdD17c2VsZWN0fVxuICAgICAgICB2aWV3TW9kZWxQYXRoPXt0aGlzLnR0LnZpZXdNb2RlbFBhdGh9XG4gICAgICAgIHdvcmtwbGFjZVxuICAgICAgICB7Li4udGFibGVQcm9wc31cbiAgICAgICAgey4uLnJlc3RQcm9wc31cbiAgICAgIC8+XG4gICAgKVxuICB9XG5cbiAgZWRpdE1vZGVsUGF0aCA9IChhcmdzKSA9PiB7XG4gICAgY29uc3QgYXJnTmFtZSA9IGluZmxlY3Rpb24uY2FtZWxpemUoZGlnZyh0aGlzLnAubW9kZWxDbGFzcy5tb2RlbENsYXNzRGF0YSgpLCBcIm5hbWVcIiksIHRydWUpXG4gICAgY29uc3QgbW9kZWwgPSBkaWdnKGFyZ3MsIGFyZ05hbWUpXG5cbiAgICByZXR1cm4gUGFyYW1zLndpdGhQYXJhbXMoe1xuICAgICAgbW9kZWw6IHRoaXMucC5tb2RlbENsYXNzLm1vZGVsQ2xhc3NEYXRhKCkubmFtZSxcbiAgICAgIG1vZGVsX2lkOiBtb2RlbC5wcmltYXJ5S2V5KCksXG4gICAgICBtb2RlOiBcImVkaXRcIlxuICAgIH0pXG4gIH1cblxuICB2aWV3TW9kZWxQYXRoID0gKGFyZ3MpID0+IHtcbiAgICBjb25zdCBhcmdOYW1lID0gaW5mbGVjdGlvbi5jYW1lbGl6ZShkaWdnKHRoaXMucC5tb2RlbENsYXNzLm1vZGVsQ2xhc3NEYXRhKCksIFwibmFtZVwiKSwgdHJ1ZSlcbiAgICBjb25zdCBtb2RlbCA9IGRpZ2coYXJncywgYXJnTmFtZSlcblxuICAgIHJldHVybiBQYXJhbXMud2l0aFBhcmFtcyh7XG4gICAgICBtb2RlbDogdGhpcy5wLm1vZGVsQ2xhc3MubW9kZWxDbGFzc0RhdGEoKS5uYW1lLFxuICAgICAgbW9kZWxfaWQ6IG1vZGVsLnByaW1hcnlLZXkoKVxuICAgIH0pXG4gIH1cbn0pKVxuIl19