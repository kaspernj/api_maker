import { jsx as _jsx, Fragment as _Fragment } from "react/jsx-runtime";
/* eslint-disable react/jsx-no-literals, react/jsx-no-useless-fragment, sort-imports */
import BaseComponent from "../base-component";
import { digg } from "diggerize";
import * as inflection from "inflection";
import Link from "../link";
import memo from "set-state-compare/build/memo.js";
import React, { useMemo } from "react";
import Params from "../params.js";
import PropTypes from "prop-types";
import propTypesExact from "prop-types-exact";
import { shapeComponent } from "set-state-compare/build/shape-component.js";
import useCanCan from "../use-can-can.js";
export default memo(shapeComponent(class SuperAdminShowReflectionActions extends BaseComponent {
    static propTypes = propTypesExact({
        model: PropTypes.object,
        modelClass: PropTypes.func,
        reflectionName: PropTypes.string
    });
    setup() {
        const { modelClass, reflectionName } = this.p;
        this.reflection = useMemo(() => modelClass.reflections().find((reflection) => reflection.name() == reflectionName), [modelClass, reflectionName]);
        this.canCan = useCanCan(() => [[this.reflection.modelClass(), ["new"]]]);
    }
    render() {
        const { canCan, reflection } = this.tt;
        const { model } = this.p;
        const modelClassName = digg(reflection, "reflectionData", "className");
        const modelData = {};
        const dataParamName = inflection.singularize(reflection.reflectionData.collectionName);
        modelData[reflection.foreignKey()] = model?.id();
        const linkParams = {
            model: modelClassName,
            mode: "new"
        };
        linkParams[dataParamName] = modelData;
        const dataSet = useMemo(() => ({ class: "create-new-model-link" }), []);
        return (_jsx(_Fragment, { children: canCan?.can("new", reflection.modelClass()) &&
                _jsx(Link, { dataSet: dataSet, to: Params.withParams(linkParams), children: "Create new" }) }));
    }
}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hvdy1yZWZsZWN0aW9uLWFjdGlvbnMuanMiLCJzb3VyY2VSb290IjoiL3NyYy8iLCJzb3VyY2VzIjpbInN1cGVyLWFkbWluL3Nob3ctcmVmbGVjdGlvbi1hY3Rpb25zLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsdUZBQXVGO0FBQ3ZGLE9BQU8sYUFBYSxNQUFNLG1CQUFtQixDQUFBO0FBQzdDLE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxXQUFXLENBQUE7QUFDOUIsT0FBTyxLQUFLLFVBQVUsTUFBTSxZQUFZLENBQUE7QUFDeEMsT0FBTyxJQUFJLE1BQU0sU0FBUyxDQUFBO0FBQzFCLE9BQU8sSUFBSSxNQUFNLGlDQUFpQyxDQUFBO0FBQ2xELE9BQU8sS0FBSyxFQUFFLEVBQUMsT0FBTyxFQUFDLE1BQU0sT0FBTyxDQUFBO0FBQ3BDLE9BQU8sTUFBTSxNQUFNLGNBQWMsQ0FBQTtBQUNqQyxPQUFPLFNBQVMsTUFBTSxZQUFZLENBQUE7QUFDbEMsT0FBTyxjQUFjLE1BQU0sa0JBQWtCLENBQUE7QUFDN0MsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLDRDQUE0QyxDQUFBO0FBQ3pFLE9BQU8sU0FBUyxNQUFNLG1CQUFtQixDQUFBO0FBRXpDLGVBQWUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxNQUFNLCtCQUFnQyxTQUFRLGFBQWE7SUFDNUYsTUFBTSxDQUFDLFNBQVMsR0FBRyxjQUFjLENBQUM7UUFDaEMsS0FBSyxFQUFFLFNBQVMsQ0FBQyxNQUFNO1FBQ3ZCLFVBQVUsRUFBRSxTQUFTLENBQUMsSUFBSTtRQUMxQixjQUFjLEVBQUUsU0FBUyxDQUFDLE1BQU07S0FDakMsQ0FBQyxDQUFBO0lBRUYsS0FBSztRQUNILE1BQU0sRUFBQyxVQUFVLEVBQUUsY0FBYyxFQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQTtRQUUzQyxJQUFJLENBQUMsVUFBVSxHQUFHLE9BQU8sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxVQUFVLENBQUMsV0FBVyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLElBQUksY0FBYyxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQTtRQUNqSixJQUFJLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQzFFLENBQUM7SUFFRCxNQUFNO1FBQ0osTUFBTSxFQUFDLE1BQU0sRUFBRSxVQUFVLEVBQUMsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFBO1FBQ3BDLE1BQU0sRUFBQyxLQUFLLEVBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFBO1FBQ3RCLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxVQUFVLEVBQUUsZ0JBQWdCLEVBQUUsV0FBVyxDQUFDLENBQUE7UUFDdEUsTUFBTSxTQUFTLEdBQUcsRUFBRSxDQUFBO1FBQ3BCLE1BQU0sYUFBYSxHQUFHLFVBQVUsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLGNBQWMsQ0FBQyxjQUFjLENBQUMsQ0FBQTtRQUV0RixTQUFTLENBQUMsVUFBVSxDQUFDLFVBQVUsRUFBRSxDQUFDLEdBQUcsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFBO1FBRWhELE1BQU0sVUFBVSxHQUFHO1lBQ2pCLEtBQUssRUFBRSxjQUFjO1lBQ3JCLElBQUksRUFBRSxLQUFLO1NBQ1osQ0FBQTtRQUVELFVBQVUsQ0FBQyxhQUFhLENBQUMsR0FBRyxTQUFTLENBQUE7UUFFckMsTUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBQyxLQUFLLEVBQUUsdUJBQXVCLEVBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFBO1FBRXJFLE9BQU8sQ0FDTCw0QkFDRyxNQUFNLEVBQUUsR0FBRyxDQUFDLEtBQUssRUFBRSxVQUFVLENBQUMsVUFBVSxFQUFFLENBQUM7Z0JBQzFDLEtBQUMsSUFBSSxJQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLDJCQUVsRCxHQUVSLENBQ0osQ0FBQTtJQUNILENBQUM7Q0FDRixDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIHJlYWN0L2pzeC1uby1saXRlcmFscywgcmVhY3QvanN4LW5vLXVzZWxlc3MtZnJhZ21lbnQsIHNvcnQtaW1wb3J0cyAqL1xuaW1wb3J0IEJhc2VDb21wb25lbnQgZnJvbSBcIi4uL2Jhc2UtY29tcG9uZW50XCJcbmltcG9ydCB7ZGlnZ30gZnJvbSBcImRpZ2dlcml6ZVwiXG5pbXBvcnQgKiBhcyBpbmZsZWN0aW9uIGZyb20gXCJpbmZsZWN0aW9uXCJcbmltcG9ydCBMaW5rIGZyb20gXCIuLi9saW5rXCJcbmltcG9ydCBtZW1vIGZyb20gXCJzZXQtc3RhdGUtY29tcGFyZS9idWlsZC9tZW1vLmpzXCJcbmltcG9ydCBSZWFjdCwge3VzZU1lbW99IGZyb20gXCJyZWFjdFwiXG5pbXBvcnQgUGFyYW1zIGZyb20gXCIuLi9wYXJhbXMuanNcIlxuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiXG5pbXBvcnQgcHJvcFR5cGVzRXhhY3QgZnJvbSBcInByb3AtdHlwZXMtZXhhY3RcIlxuaW1wb3J0IHtzaGFwZUNvbXBvbmVudH0gZnJvbSBcInNldC1zdGF0ZS1jb21wYXJlL2J1aWxkL3NoYXBlLWNvbXBvbmVudC5qc1wiXG5pbXBvcnQgdXNlQ2FuQ2FuIGZyb20gXCIuLi91c2UtY2FuLWNhbi5qc1wiXG5cbmV4cG9ydCBkZWZhdWx0IG1lbW8oc2hhcGVDb21wb25lbnQoY2xhc3MgU3VwZXJBZG1pblNob3dSZWZsZWN0aW9uQWN0aW9ucyBleHRlbmRzIEJhc2VDb21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0gcHJvcFR5cGVzRXhhY3Qoe1xuICAgIG1vZGVsOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIG1vZGVsQ2xhc3M6IFByb3BUeXBlcy5mdW5jLFxuICAgIHJlZmxlY3Rpb25OYW1lOiBQcm9wVHlwZXMuc3RyaW5nXG4gIH0pXG5cbiAgc2V0dXAoKSB7XG4gICAgY29uc3Qge21vZGVsQ2xhc3MsIHJlZmxlY3Rpb25OYW1lfSA9IHRoaXMucFxuXG4gICAgdGhpcy5yZWZsZWN0aW9uID0gdXNlTWVtbygoKSA9PiBtb2RlbENsYXNzLnJlZmxlY3Rpb25zKCkuZmluZCgocmVmbGVjdGlvbikgPT4gcmVmbGVjdGlvbi5uYW1lKCkgPT0gcmVmbGVjdGlvbk5hbWUpLCBbbW9kZWxDbGFzcywgcmVmbGVjdGlvbk5hbWVdKVxuICAgIHRoaXMuY2FuQ2FuID0gdXNlQ2FuQ2FuKCgpID0+IFtbdGhpcy5yZWZsZWN0aW9uLm1vZGVsQ2xhc3MoKSwgW1wibmV3XCJdXV0pXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2NhbkNhbiwgcmVmbGVjdGlvbn0gPSB0aGlzLnR0XG4gICAgY29uc3Qge21vZGVsfSA9IHRoaXMucFxuICAgIGNvbnN0IG1vZGVsQ2xhc3NOYW1lID0gZGlnZyhyZWZsZWN0aW9uLCBcInJlZmxlY3Rpb25EYXRhXCIsIFwiY2xhc3NOYW1lXCIpXG4gICAgY29uc3QgbW9kZWxEYXRhID0ge31cbiAgICBjb25zdCBkYXRhUGFyYW1OYW1lID0gaW5mbGVjdGlvbi5zaW5ndWxhcml6ZShyZWZsZWN0aW9uLnJlZmxlY3Rpb25EYXRhLmNvbGxlY3Rpb25OYW1lKVxuXG4gICAgbW9kZWxEYXRhW3JlZmxlY3Rpb24uZm9yZWlnbktleSgpXSA9IG1vZGVsPy5pZCgpXG5cbiAgICBjb25zdCBsaW5rUGFyYW1zID0ge1xuICAgICAgbW9kZWw6IG1vZGVsQ2xhc3NOYW1lLFxuICAgICAgbW9kZTogXCJuZXdcIlxuICAgIH1cblxuICAgIGxpbmtQYXJhbXNbZGF0YVBhcmFtTmFtZV0gPSBtb2RlbERhdGFcblxuICAgIGNvbnN0IGRhdGFTZXQgPSB1c2VNZW1vKCgpID0+ICh7Y2xhc3M6IFwiY3JlYXRlLW5ldy1tb2RlbC1saW5rXCJ9KSwgW10pXG5cbiAgICByZXR1cm4gKFxuICAgICAgPD5cbiAgICAgICAge2NhbkNhbj8uY2FuKFwibmV3XCIsIHJlZmxlY3Rpb24ubW9kZWxDbGFzcygpKSAmJlxuICAgICAgICAgIDxMaW5rIGRhdGFTZXQ9e2RhdGFTZXR9IHRvPXtQYXJhbXMud2l0aFBhcmFtcyhsaW5rUGFyYW1zKX0+XG4gICAgICAgICAgICBDcmVhdGUgbmV3XG4gICAgICAgICAgPC9MaW5rPlxuICAgICAgICB9XG4gICAgICA8Lz5cbiAgICApXG4gIH1cbn0pKVxuIl19