/* eslint-disable jest/require-hook, sort-imports */
import { useContext } from "react";
import Devise from "./devise.js";
import { EventEmitter } from "eventemitter3";
import Logger from "./logger.js";
const events = new EventEmitter();
const logger = new Logger({ name: "ApiMaker / useCurrentUser" });
logger.setDebug(false);
/**
 * @param {object} props
 * @param {string} [props.scope]
 * @param {boolean} [props.withData]
 * @returns {import("./base-model.js").default}
 */
const useCurrentUser = (props = {}) => {
    const { scope = "user", withData, ...restProps } = props;
    if (Object.keys(restProps).length > 0) {
        throw new Error(`Unknown props given to useCurrentUser: ${Object.keys(restProps).join(", ")}`);
    }
    const scopeInstance = Devise.getScope(scope);
    if (!scopeInstance || !scopeInstance.getContext) {
        throw new Error(`useCurrentUser: Devise scope "${scope}" is not available. Did you initialize the Devise scope provider?`);
    }
    const currentUserContext = useContext(scopeInstance.getContext());
    if (!currentUserContext) {
        throw new Error(`useCurrentUser: no context for Devise scope "${scope}". Ensure the provider is mounted before calling useCurrentUser.`);
    }
    if (withData) {
        return currentUserContext;
    }
    else {
        return currentUserContext.model;
    }
};
export { events };
export default useCurrentUser;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlLWN1cnJlbnQtdXNlci5qcyIsInNvdXJjZVJvb3QiOiIvc3JjLyIsInNvdXJjZXMiOlsidXNlLWN1cnJlbnQtdXNlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvREFBb0Q7QUFDcEQsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLE9BQU8sQ0FBQTtBQUNoQyxPQUFPLE1BQU0sTUFBTSxhQUFhLENBQUE7QUFDaEMsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLGVBQWUsQ0FBQTtBQUMxQyxPQUFPLE1BQU0sTUFBTSxhQUFhLENBQUE7QUFFaEMsTUFBTSxNQUFNLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQTtBQUNqQyxNQUFNLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FBQyxFQUFDLElBQUksRUFBRSwyQkFBMkIsRUFBQyxDQUFDLENBQUE7QUFFOUQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUV0Qjs7Ozs7R0FLRztBQUNILE1BQU0sY0FBYyxHQUFHLENBQUMsS0FBSyxHQUFHLEVBQUUsRUFBRSxFQUFFO0lBQ3BDLE1BQU0sRUFBQyxLQUFLLEdBQUcsTUFBTSxFQUFFLFFBQVEsRUFBRSxHQUFHLFNBQVMsRUFBQyxHQUFHLEtBQUssQ0FBQTtJQUV0RCxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1FBQ3RDLE1BQU0sSUFBSSxLQUFLLENBQUMsMENBQTBDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQTtJQUNoRyxDQUFDO0lBRUQsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUM1QyxJQUFJLENBQUMsYUFBYSxJQUFJLENBQUMsYUFBYSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ2hELE1BQU0sSUFBSSxLQUFLLENBQUMsaUNBQWlDLEtBQUssbUVBQW1FLENBQUMsQ0FBQTtJQUM1SCxDQUFDO0lBQ0QsTUFBTSxrQkFBa0IsR0FBRyxVQUFVLENBQUMsYUFBYSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUE7SUFDakUsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFDeEIsTUFBTSxJQUFJLEtBQUssQ0FBQyxnREFBZ0QsS0FBSyxrRUFBa0UsQ0FBQyxDQUFBO0lBQzFJLENBQUM7SUFFRCxJQUFJLFFBQVEsRUFBRSxDQUFDO1FBQ2IsT0FBTyxrQkFBa0IsQ0FBQTtJQUMzQixDQUFDO1NBQU0sQ0FBQztRQUNOLE9BQU8sa0JBQWtCLENBQUMsS0FBSyxDQUFBO0lBQ2pDLENBQUM7QUFDSCxDQUFDLENBQUE7QUFFRCxPQUFPLEVBQUMsTUFBTSxFQUFDLENBQUE7QUFDZixlQUFlLGNBQWMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIGplc3QvcmVxdWlyZS1ob29rLCBzb3J0LWltcG9ydHMgKi9cbmltcG9ydCB7dXNlQ29udGV4dH0gZnJvbSBcInJlYWN0XCJcbmltcG9ydCBEZXZpc2UgZnJvbSBcIi4vZGV2aXNlLmpzXCJcbmltcG9ydCB7RXZlbnRFbWl0dGVyfSBmcm9tIFwiZXZlbnRlbWl0dGVyM1wiXG5pbXBvcnQgTG9nZ2VyIGZyb20gXCIuL2xvZ2dlci5qc1wiXG5cbmNvbnN0IGV2ZW50cyA9IG5ldyBFdmVudEVtaXR0ZXIoKVxuY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcih7bmFtZTogXCJBcGlNYWtlciAvIHVzZUN1cnJlbnRVc2VyXCJ9KVxuXG5sb2dnZXIuc2V0RGVidWcoZmFsc2UpXG5cbi8qKlxuICogQHBhcmFtIHtvYmplY3R9IHByb3BzXG4gKiBAcGFyYW0ge3N0cmluZ30gW3Byb3BzLnNjb3BlXVxuICogQHBhcmFtIHtib29sZWFufSBbcHJvcHMud2l0aERhdGFdXG4gKiBAcmV0dXJucyB7aW1wb3J0KFwiLi9iYXNlLW1vZGVsLmpzXCIpLmRlZmF1bHR9XG4gKi9cbmNvbnN0IHVzZUN1cnJlbnRVc2VyID0gKHByb3BzID0ge30pID0+IHtcbiAgY29uc3Qge3Njb3BlID0gXCJ1c2VyXCIsIHdpdGhEYXRhLCAuLi5yZXN0UHJvcHN9ID0gcHJvcHNcblxuICBpZiAoT2JqZWN0LmtleXMocmVzdFByb3BzKS5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHByb3BzIGdpdmVuIHRvIHVzZUN1cnJlbnRVc2VyOiAke09iamVjdC5rZXlzKHJlc3RQcm9wcykuam9pbihcIiwgXCIpfWApXG4gIH1cblxuICBjb25zdCBzY29wZUluc3RhbmNlID0gRGV2aXNlLmdldFNjb3BlKHNjb3BlKVxuICBpZiAoIXNjb3BlSW5zdGFuY2UgfHwgIXNjb3BlSW5zdGFuY2UuZ2V0Q29udGV4dCkge1xuICAgIHRocm93IG5ldyBFcnJvcihgdXNlQ3VycmVudFVzZXI6IERldmlzZSBzY29wZSBcIiR7c2NvcGV9XCIgaXMgbm90IGF2YWlsYWJsZS4gRGlkIHlvdSBpbml0aWFsaXplIHRoZSBEZXZpc2Ugc2NvcGUgcHJvdmlkZXI/YClcbiAgfVxuICBjb25zdCBjdXJyZW50VXNlckNvbnRleHQgPSB1c2VDb250ZXh0KHNjb3BlSW5zdGFuY2UuZ2V0Q29udGV4dCgpKVxuICBpZiAoIWN1cnJlbnRVc2VyQ29udGV4dCkge1xuICAgIHRocm93IG5ldyBFcnJvcihgdXNlQ3VycmVudFVzZXI6IG5vIGNvbnRleHQgZm9yIERldmlzZSBzY29wZSBcIiR7c2NvcGV9XCIuIEVuc3VyZSB0aGUgcHJvdmlkZXIgaXMgbW91bnRlZCBiZWZvcmUgY2FsbGluZyB1c2VDdXJyZW50VXNlci5gKVxuICB9XG5cbiAgaWYgKHdpdGhEYXRhKSB7XG4gICAgcmV0dXJuIGN1cnJlbnRVc2VyQ29udGV4dFxuICB9IGVsc2Uge1xuICAgIHJldHVybiBjdXJyZW50VXNlckNvbnRleHQubW9kZWxcbiAgfVxufVxuXG5leHBvcnQge2V2ZW50c31cbmV4cG9ydCBkZWZhdWx0IHVzZUN1cnJlbnRVc2VyXG4iXX0=